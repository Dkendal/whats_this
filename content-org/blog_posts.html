<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2019-12-20 Fri 11:22 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>&lrm;</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Alasdair McAndrew" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org373b5bf">1. Pages</a>
<ul>
<li><a href="#org6e65478">1.1. About this blog</a></li>
<li><a href="#org8adf333">1.2. Pictures</a></li>
</ul>
</li>
<li><a href="#org64d2ee2">2. Posts</a>
<ul>
<li><a href="#org2f4c1d3">2.1. Speeds of Julia and Python</a>
<ul>
<li><a href="#org749eddd">2.1.1. Introduction</a></li>
<li><a href="#org8f00eee">2.1.2. Matrix permanents</a></li>
<li><a href="#org12f63db">2.1.3. A few words at the end</a></li>
</ul>
</li>
<li><a href="#org10917a7">2.2. Poles of inaccessibility</a></li>
<li><a href="#org1a82bd2">2.3. An interesting sum</a></li>
<li><a href="#org1cfa55e">2.4. Runge's phenomenon in Geogebra</a>
<ul>
<li><a href="#org3c6c581">2.4.1. Equally spaced vertices</a></li>
<li><a href="#org9c8fe5a">2.4.2. Chebyshev vertices</a></li>
<li><a href="#org44898f8">2.4.3. Integration</a></li>
</ul>
</li>
<li><a href="#org7ace71b">2.5. Fitting the SIR model of disease to data in Python</a>
<ul>
<li><a href="#orge8c99d2">2.5.1. Introduction and the problem</a></li>
<li><a href="#orgd232468">2.5.2. Using Python</a></li>
</ul>
</li>
<li><a href="#org9bae489">2.6. Mapping voting gains between elections</a></li>
<li><a href="#org22f51ff">2.7. Educational disciplines: size against market growth</a></li>
<li><a href="#org0ac2186">2.8. Tschirnhausen transformations and the quartic</a>
<ul>
<li><a href="#orgde07900">2.8.1. An example</a></li>
<li><a href="#org9e590c0">2.8.2. Further comments</a></li>
</ul>
</li>
<li><a href="#orgeef08dc">2.9. Tschirnhausen's solution of the cubic</a>
<ul>
<li><a href="#org60c2e37">2.9.1. Cardan's method</a></li>
<li><a href="#orgdb03a86">2.9.2. And so to Tschirnhausen</a></li>
</ul>
</li>
<li><a href="#org6073aae">2.10. Colonial massacres, 1794 to 1928</a></li>
<li><a href="#org202d32d">2.11. Vote counting in the Australian Senate</a>
<ul>
<li><a href="#orgc8c1760">2.11.1. An aside on micro parties and voting</a></li>
<li><a href="#orga5c3355">2.11.2. A simple example</a></li>
</ul>
</li>
<li><a href="#orgac6b283">2.12. Concert review: Lixsania and the Labyrinth</a></li>
<li><a href="#org7a89996">2.13. Linear programming in Python (2)</a></li>
<li><a href="#orga2c52e6">2.14. Linear programming in Python</a>
<ul>
<li><a href="#orgb80b0c1">2.14.1. A simple example</a></li>
</ul>
</li>
<li><a href="#org93c26e2">2.15. A test of OpenJSCAD</a></li>
<li><a href="#org9ea8bab">2.16. The power of two irrational numbers being rational</a></li>
<li><a href="#orgbe6a74d">2.17. Wrestling with Docker</a></li>
<li><a href="#orgdd16fab">2.18. Householder's methods&#xa0;&#xa0;&#xa0;<span class="tag"><span class="mathematics">mathematics</span>&#xa0;<span class="algebra">algebra</span></span></a>
<ul>
<li><a href="#orgcd789b3">2.18.1. A test</a></li>
</ul>
</li>
<li><a href="#orgf76c232">2.19. The Joukowsky Transform&#xa0;&#xa0;&#xa0;<span class="tag"><span class="mathematics">mathematics</span>&#xa0;<span class="geometry">geometry</span>&#xa0;<span class="jsxgraph">jsxgraph</span></span></a></li>
<li><a href="#org427650f">2.20. Double Damask</a></li>
<li><a href="#org7185465">2.21. Graphs of Eggs&#xa0;&#xa0;&#xa0;<span class="tag"><span class="geometry">geometry</span>&#xa0;<span class="jsxgraph">jsxgraph</span></span></a></li>
<li><a href="#orgd584a28">2.22. Exploring JSXGraph&#xa0;&#xa0;&#xa0;<span class="tag"><span class="jsxgraph">jsxgraph</span></span></a></li>
<li><a href="#org8f735cc">2.23. The trinomial theorem&#xa0;&#xa0;&#xa0;<span class="tag"><span class="mathematics">mathematics</span>&#xa0;<span class="algebra">algebra</span></span></a></li>
<li><a href="#org4ad5c45">2.24. Playing with Hugo&#xa0;&#xa0;&#xa0;<span class="tag"><span class="hugo">hugo</span>&#xa0;<span class="org">org</span></span></a></li>
<li><a href="#org95f8563">2.25. Python GIS, and election results&#xa0;&#xa0;&#xa0;<span class="tag"><span class="python">python</span>&#xa0;<span class="voting">voting</span></span></a>
<ul>
<li><a href="#org3430839">2.25.1. Election mapping</a></li>
<li><a href="#org9fcd42a">2.25.2. Getting the information</a></li>
<li><a href="#org253f77d">2.25.3. Putting it all together</a></li>
</ul>
</li>
<li><a href="#org1260827">2.26. Presentations and the delight of js-reveal</a></li>
<li><a href="#org0180b89">2.27. The Vigenere cipher in haskell</a></li>
<li><a href="#org747ea34">2.28. Analysis of a recent election</a>
<ul>
<li><a href="#checking-irv">2.28.1. Checking IRV</a></li>
<li><a href="#borda-counts">2.28.2. Borda counts</a></li>
<li><a href="#condorcet-criteria">2.28.3. Condorcet criteria</a></li>
<li><a href="#range-and-approval-voting">2.28.4. Range and approval voting</a></li>
<li><a href="#other-election-methods">2.28.5. Other election methods</a></li>
</ul>
</li>
<li><a href="#org73fcbe6">2.29. Programmable CAD</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org373b5bf" class="outline-2">
<h2 id="org373b5bf"><span class="section-number-2">1</span> Pages</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org6e65478" class="outline-3">
<h3 id="org6e65478"><span class="section-number-3">1.1</span> About this blog</h3>
<div class="outline-text-3" id="text-1-1">
<p>
This is the newest version of my "Numbers and Shapes" blog, containing material
on elementary mathematics, mathematics education, software, and anything else
that takes my fancy.
</p>

<p>
It is created in [Hugo](<a href="https://gohugo.io/">https://gohugo.io/</a>), a static blog engine which is
blindingly fast, and works by simply serving up static html files (along with
any necessary javascript).  There is no database, and far less to fiddle with
than with wordpress.  Because it is static there is less opportunity for user
input (such as comments) but that's not an issue for me, as about 99.99% of
comments to my previous blog were spam.  User comments <i>can</i> be configured,
using for example [Disqus](<a href="https://disqus.com/">https://disqus.com/</a>), but I won't bother.  If people
want to contact me, they can email.
</p>


<p>
And this is me, on the observation deck of the Oriental Pearl Tower, Shanghai:
</p>

<p>
![amca](/amca01.jpg)
</p>

<p>
All files relating to this blog are available on my github repo
[whats<sub>this</sub>](<a href="https://github.com/amca01/whats_this">https://github.com/amca01/whats_this</a>).  You can check the
configuration, the emacs org-file which contains what I actually write, and
files generated by [ox-hugo](<a href="https://github.com/kaushalmodi/ox-hugo">https://github.com/kaushalmodi/ox-hugo</a>) and by Hugo
itself. The combinations of emacs, emacs org-mode, and ox-hugo, make creating
content for this blog a great pleasure, and far far easier than working with
wordpress.  The only issue I've found so far is that
[Mathjax](<a href="https://www.mathjax.org/">https://www.mathjax.org/</a>) is not quite as powerful as the wordpress
[QuickLaTeX](<a href="http://www.holoborodko.com/pavel/quicklatex/">http://www.holoborodko.com/pavel/quicklatex/</a>) plugin.  But that's
currently a price I'm very happy to pay.
</p>

<p>
[Email](<a href="mailto:amca@numbersandshapes.net">mailto:amca@numbersandshapes.net</a>)
</p>
</div>
</div>

<div id="outline-container-org8adf333" class="outline-3">
<h3 id="org8adf333"><span class="section-number-3">1.2</span> Pictures</h3>
<div class="outline-text-3" id="text-1-2">
<p>
This page will contain various photos and snapshots.
</p>

<p>
<b>New Zealand, 2018:</b> First, from a holiday taken by my wife and me through the South Island of New
Zealand early in 2018:\ 
[New Zealand 2018](/nz-gallery)
</p>

<p>
<b>Taiwan, 2017:</b> From a conference in Taiwan (Taoyuan City mainly, but also in Taipei and
including a visit to Keelung City) in December 2017:\
[Taiwan 2017](/taiwan-gallery)
</p>

<p>
<b>Shanghai, December 2015:</b> I spent several wonderful days here en route to a
conference.  The Chinese gent in many of the pictures is my friend, colleague,
and on this trip tour-guide and translator Dr Xiangzhao Li:\ 
[Shanghai 2015](/shanghai<sub>gallery</sub>)
</p>

<p>
<b>Crossing Australia in 2007:</b>  My brother and I drove from Melbourne, in the
South-East of the continent, to Broome in the North-West, through the central
deserts and some of the remotest tracks in the world.  This is the route we took
(in red); the dark rectangles show roughly where we stopped and camped - at some
places for more than one night:
</p>

<p>
![Crossing Australia](/australia-map-mid.jpg)
</p>

<p>
It took two weeks, some 4000+ kilometres, and we'd do it again in a heartbeat:\
[Crossing Australia, 2007](/AliDug<sub>gallery</sub>)
</p>
</div>
</div>
</div>

<div id="outline-container-org64d2ee2" class="outline-2">
<h2 id="org64d2ee2"><span class="section-number-2">2</span> Posts</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org2f4c1d3" class="outline-3">
<h3 id="org2f4c1d3"><span class="section-number-3">2.1</span> Speeds of Julia and Python</h3>
<div class="outline-text-3" id="text-2-1">
</div>
<div id="outline-container-org749eddd" class="outline-4">
<h4 id="org749eddd"><span class="section-number-4">2.1.1</span> Introduction</h4>
<div class="outline-text-4" id="text-2-1-1">
<p>
[Python](<a href="https://en.wikipedia.org/wiki/Python_(programming_language)">https://en.wikipedia.org/wiki/Python_(programming_language)</a>) is of
course one of the world's currently most popular languages, and there are plenty
of
[statistics](<a href="https://www.infoworld.com/article/3401536/python-popularity-reaches-an-all-time-high.html">https://www.infoworld.com/article/3401536/python-popularity-reaches-an-all-time-high.html</a>)
to show it.  Of all languages in current use, Python is one of the oldest
(in the very quick time-scale of programming languages) dating from 1990 - only
C and its variants are older.  However, it seems to keep its eternal youth by
being re-invented, and by its constantly increasing libraries.  Indeed, one of
Python's greatest strength is its libraries, and pretty much every Python user
will have worked with [numpy](<a href="https://numpy.org">https://numpy.org</a>),
[scipy](<a href="https://www.scipy.org/scipylib/index.html">https://www.scipy.org/scipylib/index.html</a>),
[matplotlib](<a href="https://matplotlib.org">https://matplotlib.org</a>), [pandas](<a href="https://pandas.pydata.org">https://pandas.pydata.org</a>), to
name but four.  In fact, aside from some specialized applications (mainly
involving security, speed, or memory) Python can be happily used for almost everything.
</p>

<p>
[Julia](<a href="https://en.wikipedia.org/wiki/Julia_(programming_language)">https://en.wikipedia.org/wiki/Julia_(programming_language)</a>) on the other
hand is newer, dating from 2012. (Only Swift is newer.) It was designed to have
the speed of C, the power of Matlab, and the ease of use of Python.  Note the
comparison with Matlab - Julia was designed as a language for technical
computing, although it is very much a general purpose language.  It can even be
used for [low-level systems programming](<a href="https://web.archive.org/web/20181105083419/http://juliacon.org/2018/talks_workshops/42/">https://web.archive.org/web/20181105083419/http://juliacon.org/2018/talks_workshops/42/</a>).
</p>

<p>
Like Python, Julia can be extended through packages, of which there are many:
according to Julia's [package repository](<a href="https://pkg.julialang.org/docs/">https://pkg.julialang.org/docs/</a>) there
are 2554 a the time of writing.  Some of the packages are big, mature, and
robust, others are smaller or represent a niche interest.  You can go to [Julia
Observer](<a href="https://juliaobserver.com">https://juliaobserver.com</a>) to get a sense of which packages are the
most popular, largest, have the most commits on github, and so on.  Because
Julia is still relatively new, packages are still being actively developed.
However, some such as [Plots](<a href="https://github.com/JuliaPlots/Plots.jl">https://github.com/JuliaPlots/Plots.jl</a>),
[JuMP](<a href="https://github.com/JuliaOpt/JuMP.jl">https://github.com/JuliaOpt/JuMP.jl</a>) for optimization, [Differential
Equations](<a href="https://github.com/JuliaDiffEq/DifferentialEquations.jl">https://github.com/JuliaDiffEq/DifferentialEquations.jl</a>), to name but
three, are very much ready for the Big Time. 
</p>

<p>
The purpose of this post is to do a single comparison of Julia and Python for
speed.
</p>
</div>
</div>

<div id="outline-container-org8f00eee" class="outline-4">
<h4 id="org8f00eee"><span class="section-number-4">2.1.2</span> Matrix permanents</h4>
<div class="outline-text-4" id="text-2-1-2">
<p>
Given a square matrix, its
[determinant](<a href="https://en.wikipedia.org/wiki/Determinant">https://en.wikipedia.org/wiki/Determinant</a>) is a well-known and
useful construct (in spite of [Sheldon Axler](<a href="http://www.axler.net/DwD.html">http://www.axler.net/DwD.html</a>)).
</p>

<p>
The determinant of an \(n\times n\) matrix \(M=m_{ij}\) can be formally defined as
</p>

<p>
\[ 
\det(M)=\sum_{\sigma\in S_n}\left(\text{sgn}(\sigma)\prod_{i=1}^nm_{i,\sigma(i)}\right) 
\] 
</p>

<p>
where the sum is taken over all permutations \(\sigma\) of \(1,2,\ldots,n\), and
where \(\text{sgn}(\sigma)\) is the <i>sign</i> of the permutation; which is defined in terms
of the number of digit swaps to get to it: an even number of swaps has a sign of
1, and an odd number a sign of \(-1\).  The determinant can be effectively
computed by Gaussian elimination of a matrix into triangular form, which takes
in the order of \(n^3\) operations; the determinant is then the product of the
diagonal elements.
</p>

<p>
The [permanent](<a href="https://en.wikipedia.org/wiki/Permanent_(mathematics)">https://en.wikipedia.org/wiki/Permanent_(mathematics)</a>) is
defined similarly, except for the sign:
</p>

<p>
\[
\text{perm}(M)=\sum_{\sigma\in S_n}\prod_{i=1}^nm_{i,\sigma(i)}.
\]
</p>

<p>
Remarkably enough, this simple change renders the permanent impossible to be
computed effectively; all known algorithms have exponential orders.  Computing
by expanding each permutation takes \(O(n!n)\) operations, some better algorithms (such
as [Ryser's algorithm](<a href="https://en.wikipedia.org/wiki/Permanent_(mathematics)">https://en.wikipedia.org/wiki/Permanent_(mathematics)</a>)
have order \(O(2^{n-1}n)\).  
</p>

<p>
The permanent has some applications, although not as many as the determinant.
An easy and immediate result is that if \(M\) is a matrix consisting entirely of
ones, except for the main diagonal of zeros (so that it is the "ones complement"
of the identity matrix), its permanent is the number of <i>derangements</i> of \(n\)
objects; that is, the number of permutations in which there are no fixed points.
</p>

<p>
First Python.  Here is a simple program, saved as <code>permanent.py</code> to compute the permanent from its
definition:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">import</span> itertools <span style="color: #0000FF;">as</span> it
<span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np

<span style="color: #0000FF;">def</span> <span style="color: #006699;">permanent</span>(m):
    <span style="color: #BA36A5;">nr</span>,<span style="color: #BA36A5;">nc</span> = np.shape(m)
    <span style="color: #0000FF;">if</span> nr != nc:
        <span style="color: #0000FF;">raise</span> <span style="color: #6434A3;">ValueError</span>(<span style="color: #008000;">"Matrix must be square"</span>)
    <span style="color: #BA36A5;">pm</span> = 0
    <span style="color: #0000FF;">for</span> p <span style="color: #0000FF;">in</span> it.permutations(<span style="color: #006FE0;">range</span>(nr)):
        <span style="color: #BA36A5;">pm</span> += np.product([m[i,p[i]] <span style="color: #0000FF;">for</span> i <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">range</span>(nr)])
    <span style="color: #0000FF;">return</span> pm
</pre>
</div>

<p>
I am not interested in optimizing speed; simply to implement the same algorithm
in Python and Julia to see what happens.  Now lets run this in a Python REPL
(I'm using IPython here):
</p>

<div class="org-src-container">
<pre class="src src-python">In [1]: <span style="color: #0000FF;">import</span> permanent <span style="color: #0000FF;">as</span> pt

In [2]: <span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np

In [3]: <span style="color: #BA36A5;">M</span> = (1 - np.identity(4)).astype(np.intc)                      

In [4]: pt.permanent(M)   
Out[4]: 9
</pre>
</div>

<p>
and this is correct.  This result was practically instantaneous, but it slows
down appreciably, as you'd expect, for larger matrices:
</p>

<div class="org-src-container">
<pre class="src src-python">In [5]: <span style="color: #0000FF;">from</span> timeit <span style="color: #0000FF;">import</span> default_timer <span style="color: #0000FF;">as</span> timer 

In [6]: <span style="color: #BA36A5;">M</span> = (1 - np.identity(8)).astype(np.intc)

In [7]: <span style="color: #BA36A5;">t</span> = timer();<span style="color: #0000FF;">print</span>(pt.permanent(M));timer()-t
14833
Out[7]: 0.7398275199811906

In [8]: <span style="color: #BA36A5;">M</span> = (1 - np.identity(9)).astype(np.intc)

In [9]: <span style="color: #BA36A5;">t</span> = timer();<span style="color: #0000FF;">print</span>(pt.permanent(M));timer()-t
133496
Out[9]: 10.244881154998438

In [10]: <span style="color: #BA36A5;">M</span> = (1 - np.identity(10)).astype(np.intc)

In [11]: <span style="color: #BA36A5;">t</span> = timer();<span style="color: #0000FF;">print</span>(pt.permanent(M));timer()-t
1334961
Out[11]: 86.57762016600464
</pre>
</div>

<p>
Now no doubt this could be speeded up in numerous ways, but that is not my
point: I am simply implementing the same algorithm in each language.  At any
rate, my elementary program becomes effectively unusable for matrices bigger
than about \(8\times 8\).
</p>

<p>
Now for Julia.  Again, we start with a simple program:
</p>

<div class="org-src-container">
<pre class="src src-julia"><span style="color: #0000FF;">using</span> Combinatorics

<span style="color: #0000FF;">function</span> <span style="color: #006699;">permanent</span>(m)
    nr,nc = size(m)
    <span style="color: #0000FF;">if</span> nr != nc
        error(<span style="color: #008000;">"Matrix must be square"</span>)
    <span style="color: #0000FF;">end</span>
    pm = 0
    <span style="color: #0000FF;">for</span> p <span style="color: #0000FF;">in</span> permutations(1:nr)
        pm += prod(m[i,p[i]] <span style="color: #0000FF;">for</span> i <span style="color: #0000FF;">in</span> 1:nr)
    <span style="color: #0000FF;">end</span>
    <span style="color: #0000FF;">return</span>(pm)
<span style="color: #0000FF;">end</span>
</pre>
</div>

<p>
You can see this program and the Python one above are, to all intents and
purposes, identical.  There are no clever optimizing tricks, it is a raw
implementation of the basic definition.
</p>

<p>
First, a quick test:
</p>

<div class="org-src-container">
<pre class="src src-julia">julia&gt; <span style="color: #0000FF;">using</span> LinearAlgebra

julia&gt; M = 1 .- <span style="color: #6434A3;">Matrix</span>(1I,4,4);

julia&gt; include(<span style="color: #008000;">"permanent.jl"</span>)

julia&gt; permanent(M)
9
</pre>
</div>

<p>
So far, so good.  Now for some time trials:
</p>

<div class="org-src-container">
<pre class="src src-julia">julia&gt; <span style="color: #0000FF;">using</span> BenchmarkTools

julia&gt; M = 1 .- <span style="color: #6434A3;">Matrix</span>(1I,8,8);

julia&gt; <span style="color: #808080;">@time</span> permanent(M)
0.020514 seconds (201.61 k allocations: 14.766 MiB)
14833

julia&gt; M = 1 .- <span style="color: #6434A3;">Matrix</span>(1I,9,9);

julia&gt; <span style="color: #808080;">@time</span> permanent(M)
  0.245049 seconds (1.81 M allocations: 143.965 MiB, 33.73% gc time)
133496

julia&gt; M = 1 .- <span style="color: #6434A3;">Matrix</span>(1I,10,10);

julia&gt; <span style="color: #808080;">@time</span> permanent(M)
  1.336724 seconds (18.14 M allocations: 1.406 GiB, 3.20% gc time)
1334961
</pre>
</div>

<p>
You'll see that Julia, thanks to its JIT compiler, is much much faster than
Python.  The point is that I didn't have to do anything here to access that
speed, it's just a splendid part of the language.
</p>

<p>
Winner: Julia, by a country mile.
</p>
</div>
</div>

<div id="outline-container-org12f63db" class="outline-4">
<h4 id="org12f63db"><span class="section-number-4">2.1.3</span> A few words at the end</h4>
<div class="outline-text-4" id="text-2-1-3">
<p>
The timings given above are not absolute - running on a different system or with
different versions of Python, Julia, and their libraries, will give
different results.  But the point is not the exact times taken, but the <i>comparison</i> of
time between Julia and Python.  
</p>

<p>
For what it's worth, I'm running a fairly recently upgraded version of Arch Linux
on a Lenovo Thinkpad X1 Carbon, generation 3.  I'm running Julia 1.3.0 and
Python 3.7.4.  The machine has 8Gb of memory, of which about 2Gb were free.
</p>
</div>
</div>
</div>

<div id="outline-container-org10917a7" class="outline-3">
<h3 id="org10917a7"><span class="section-number-3">2.2</span> Poles of inaccessibility</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Just recently there was a news item about a solo explorer being the first
Australian to reach the Antarctic "Pole of Inaccessibility".  Such a Pole is
usually defined as that place on a continent that is furthest from the sea.  The
[South Pole](<a href="https://en.wikivoyage.org/wiki/South_Pole">https://en.wikivoyage.org/wiki/South_Pole</a>) is about 1300km from the
nearest open sea, and can be reached by specially fitted aircraft, or by
tractors and sleds along the 1600km "South Pole Highway" from McMurdo Base.
However, it is only about 500km from the nearest coast line on the Ross Ice
Shelf.  McMurdo Base is situated on the outside of the Ross Ice Shelf, so that
it is accessible from the sea.
</p>

<p>
The Southern Pole of Inaccessibility is about 870km further inland from the
South Pole, and is very hard to reach&#x2014;indeed the first people there were a
Russian party in 1958, whose enduring legacy is a bust of Lenin at that Pole.
Unlike at the South Pole, there is no base or habitation there; just a frigid
wilderness.   The Southern Pole of Inaccessibility is 1300km from the nearest
coast.
</p>

<p>
A pole of inaccessibility on any landmass can be defined as the centre of the
largest circle that can be drawn entirely within it.  You can see all of these
for the world's continents at an [ArcGIS
site](<a href="https://apl.maps.arcgis.com/apps/MapJournal/index.html?appid=ce19bec7a3c541d0b95c449df9bb8eb5">https://apl.maps.arcgis.com/apps/MapJournal/index.html?appid=ce19bec7a3c541d0b95c449df9bb8eb5</a>).
If you don't want to wait for the images to load, here is Antarctica:
</p>


<div class="figure">
<p><img src="file:///antarctica_poi.png" alt="antarctica_poi.png" width="600" />
</p>
</div>

<p>
You'll notice that this map of Antarctica is missing the ice shelves, which fill
up most of the bays.  If the ice shelves are included, then we can draw a larger
circle.
</p>

<p>
As an image processing exercise, I decided to experiment, using the [distance
transform](<a href="https://en.wikipedia.org/wiki/Distance_transform">https://en.wikipedia.org/wiki/Distance_transform</a>) to measure
distances from the coasts, and [Julia](<a href="https://julialang.org">https://julialang.org</a>) as the language.
Although Julia has now been in development for a decade, it's still a "new kid
on the block".  But some of its libraries (known as "packages") are remarkably
mature and robust.  One such is its imaging package
[Images](<a href="https://juliaimages.org/latest/">https://juliaimages.org/latest/</a>).
</p>

<p>
In fact, we need to install and use several packages as well as Images: Colors,
FileIO, ImageView, Plots.  These can all be added with  <code>Pkg.add("packagename")</code> and brought
into the namespace with <code>using packagename</code>.  We also need an image to use, and
for Antarctica I chose this very nice map of the ice surface:
</p>


<div class="figure">
<p><img src="file:///antarctica.jpg" alt="antarctica.jpg" width="600" />
</p>
</div>

<p>
taken from a [BBC
report](<a href="https://www.bbc.com/news/science-environment-21692423">https://www.bbc.com/news/science-environment-21692423</a>).  The nice thing
about this map is that it shows the ice shelves, so that we can experiment with
and without them.  We start by reading the image, making it gray-scale, and
thresholding it so as to remove the ice-shelves:
</p>

<div class="org-src-container">
<pre class="src src-julia">julia&gt; ant = load(<span style="color: #008000;">"antarctica.jpg"</span>);
julia&gt; G = Gray.(ant);
julia&gt; B = G .&gt; 0.8;
julia&gt; imshow(B)
</pre>
</div>

<p>
which produces this:
</p>


<div class="figure">
<p><img src="file:///B.jpg" alt="B.jpg" width="600" />
</p>
</div>

<p>
which as you see has removed the ice shelves.  Now we apply the distance
transform and find its maximum:
</p>

<div class="org-src-container">
<pre class="src src-julia">julia&gt; D = distance_transform(feature_transform(B));
julia&gt; findmax(D)
(116.48175822848829, CartesianIndex(214, 350))
</pre>
</div>

<p>
This indicates that the largest distance from all edges is about 116, at pixel
location (214,350).  To show this circle on the image it's easiest to simply
plot the image, and then plot the circle on top of it.  We'll also plot the
centre, as a smaller circle:
</p>

<div class="org-src-container">
<pre class="src src-julia">julia&gt; plot(ant,aspect_ratio = 1)
julia&gt; x(t) = 214 + 116*cos(t)
julia&gt; x(t) = 350 + 116*sin(t)
julia&gt; xc(t) = 214 + 5*cos(t)
julia&gt; xc(t) = 350 + 5*sin(t)
julia&gt; plot!(y,x,0,2*pi,lw=3,lc=<span style="color: #008000;">"red"</span>,leg=<span style="color: #D0372D;">false</span>)
julia&gt; plot!(yc,xc,0,2*pi,lw=2,lc=<span style="color: #008000;">"white"</span>,leg=<span style="color: #D0372D;">false</span>)
</pre>
</div>


<div class="figure">
<p><img src="file:///ant_poi.png" alt="ant_poi.png" width="600" />
</p>
</div>

<p>
This shows the Pole of Inaccessibility in terms of the actual Antarctic
continent.  However, in practical terms the ice shelves, even though not
actually part of the landmass, need to be traversed just the same.  To include
the ice shelves, we just threshold at a higher value:
</p>

<div class="org-src-container">
<pre class="src src-julia">julia&gt; B1 = opening(G .&gt; 0.95);
julia&gt; D1 = distance_transform(feature_transform(B1));
julia&gt; findmax(D1)
(160.22796260328596, CartesianIndex(225, 351))
</pre>
</div>

<p>
The use of <code>opening</code> in the first line is to fill in any holes in the image: the
distance transform is very sensitive to holes.  Then we plot the continent again
with the two circles as above, but using this new centre and radius.  This
produces:
</p>


<div class="figure">
<p><img src="file:///ant2_poi.png" alt="ant2_poi.png" width="600" />
</p>
</div>

<p>
The position of the Pole of Inaccessibility has not in fact changed all that
much from the first one.
</p>
</div>
</div>

<div id="outline-container-org1a82bd2" class="outline-3">
<h3 id="org1a82bd2"><span class="section-number-3">2.3</span> An interesting sum</h3>
<div class="outline-text-3" id="text-2-3">
<p>
I am not an analyst, so I find the sums of infinite series quite mysterious.
For example, here are three.  The first one is the value of \(\zeta(2)\), very
well known, sometimes called the "Basel Problem" and first determined by (of
course) Euler:
\[
\sum_{n=1}^\infty\frac{1}{n^2}=\frac{\pi^2}{6}.
\]
Second, subtracting one from the denominator:
\[
\sum_{n=2}^\infty\frac{1}{n^2-1}=\frac{3}{4}
\]
This sum is easily demonstrated by partial fractions:
\[
\frac{1}{n^2-1}=\frac{1}{2}\left(\frac{1}{n-1}-\frac{1}{n+1}\right)
\]
and so the series can be expanded as:
\[
\frac{1}{2}\left(\frac{1}{1}-\frac{1}{3}+\frac{1}{2}-\frac{1}{4}+\frac{1}{3}-\frac{1}{5}\cdots\right)
\]
This is a <i>telescoping series</i> in which every term in the brackets is cancelled
except for \(1+1/ 2\), which produces the sum immediately.
</p>

<p>
Finally, add one to the denominator:
\[
\sum_{n=2}^\infty\frac{1}{n^2+1}=\frac{1}{2}(\pi\coth(\pi)-1).
\]
And <i>this</i> sum is obtained from one of the [series
representations](<a href="http://functions.wolfram.com/ElementaryFunctions/Coth/06/05/">http://functions.wolfram.com/ElementaryFunctions/Coth/06/05/</a>)
for \(\coth(z)\): 
</p>

<p>
\[
\coth(z)=\frac{1}{z}+2z\sum_{n=1}^\infty\frac{1}{\pi^2n^2+z^2}
\]
</p>

<p>
(for all \(z\) except for when \(\pi^2n^2+z^2=0\)).
</p>

<p>
I was looking around for infinite series to give my numerical methods students to test
their powers of approximation, and I came across [this beauty](<a href="https://www.wolframalpha.com/input/?i=sum+1/">https://www.wolframalpha.com/input/?i=sum+1/</a>(n<sup>2</sup>%2Bn-1)%2C+n%3D1+to+infinity):
\[
\sum_{n=2}^\infty\frac{1}{n^2+n-1}=1+\frac{\pi}{\sqrt{5}}\tan\left(\frac{\sqrt{5}\pi}{2}\right).
\]
This led me on a mathematical treasure hunt through books and all over the
internet, until I had worked it out.  
</p>

<p>
My starting place, after googling "sum quadratic reciprocal" was a [very nice and
detailed post on
stackexchange](<a href="https://math.stackexchange.com/questions/1322086/series-of-reciprocals-of-a-quadratic-polynomial">https://math.stackexchange.com/questions/1322086/series-of-reciprocals-of-a-quadratic-polynomial</a>). This
post then referred to a [previous
one](<a href="https://math.stackexchange.com/questions/1294790/the-value-of-sum-n-inftyn-infty-frac1n2-z2-on-mathbbc-setmi/1294829#1294829">https://math.stackexchange.com/questions/1294790/the-value-of-sum-n-inftyn-infty-frac1n2-z2-on-mathbbc-setmi/1294829#1294829</a>)
started with the infinite product expression for \(\sin(x)\) and turned it (by
taking logarithms and differentiating) into a series for \(\cot(x)\).
</p>

<p>
However, I want an expression for \(\tan(x)\), which means starting with the
infinite product form for \(\sec(x)\), which is:
</p>

<p>
\[
\sec(x)=\prod_{n=1}^\infty\frac{\pi^2(2n-1)^2}{\pi^2(2n-1)^2-4x^2}.
\]
Making a substitution simplifies the expression in the product:
\[
\sec\left(\frac{\pi
x}{2}\right)=\prod_{n=1}^\infty\frac{(2n-1)^2}{(2n-1)^2-x^2}.
\]
Now take logs of both sides:
</p>

<p>
\[
\log\left(\sec\left(\frac{\pi x}{2}\right)\right)=
\sum_{n=1}^\infty\log\left(\frac{(2n-1)^2}{(2n-1)^2-x^2}\right)
\]
</p>

<p>
and differentiate:
\[
\frac{\pi}{2}\tan\left(\frac{\pi x}{2}\right)=
\sum_{n=1}^\infty\frac{2x}{(2n-1)^2-x^2}.
\]
Now we have to somehow equate this new sum on the right with our original sum.
So let's go back to it.
</p>

<p>
First of all, a bit of completing the square produces
\[
\frac{1}{n^2+n-1}=\frac{1}{\left(n+\frac{1}{2}\right)^2-\frac{5}{4}}=\frac{4}{(2n+1)^2-5}.
\]
This means that
\[
\sum_{n=1}^\infty\frac{1}{n^2+n-1}=\sum_{n=2}^\infty\frac{4}{(2n-1)^2-5}=
\frac{2}{\sqrt{5}}\sum_{n=2}^\infty\frac{2\sqrt{5}}{(2n-1)^2-5}.
\]
We have changed the index from \(n=1\) to \(n=2\) which allows the rewriting of
\(2n+1\) as \(2n-1\).  This means we are missing a first term.  Comparing the final sum with that for \(\tan(x)\) above, we have
\[
\sum_{n=1}^\infty\frac{1}{n^2+n-1}=\frac{2}{\sqrt{5}}\left(\frac{\pi}{2}\tan\left(\frac{\pi
\sqrt{5}}{2}\right)-\frac{-\sqrt{5}}{2}\right)
\]
where the last term is the missing first term: the summand for \(n=1\).  Simplifying the right hand side
produces
\[
\sum_{n=1}^\infty\frac{1}{n^2+n-1}=1+\frac{\pi}{\sqrt{5}}\tan\left(\frac{\sqrt{5}\pi}{2}\right).
\]
Note that the above series for \(\tan(x)\) can be obtained directly, using a
general technique discussed (for example) in that [fine old text](<a href="https://en.wikipedia.org/wiki/A_Course_of_Modern_Analysis">https://en.wikipedia.org/wiki/A_Course_of_Modern_Analysis</a>): "A Course in
Modern Analysis", by E. T. Whittaker and G. N. Watson.  If \(f(x)\) has only
simple poles \(a_n\) with residues \(b_n\), then
\[
f(x) = f(0)+\sum_{n=1}^\infty\left(\frac{1}{x-a_n}+\frac{1}{a_n}\right).
\]
Expressing a function as a series of such reciprocals is known as
[Mittag-Leffler's
theorem](<a href="https://en.wikipedia.org/wiki/Mittag-Leffler's_theorem">https://en.wikipedia.org/wiki/Mittag-Leffler's_theorem</a>) and in fact
the series for \(\tan(x)\) is given there as one of the examples.
</p>
</div>
</div>

<div id="outline-container-org1cfa55e" class="outline-3">
<h3 id="org1cfa55e"><span class="section-number-3">2.4</span> Runge's phenomenon in Geogebra</h3>
<div class="outline-text-3" id="text-2-4">
<p>
<i>Runge's phenomenon</i> says roughly that a polynomial through equally spaced points
over an interval will wobble a lot near the ends.  Runge demonstrated this by
fitting polynomials through equally spaced point in the interval \([-1,1]\) on the
function
\[
\frac{1}{1+25x^2}
\]
and this function is now known as "Runge's function".
</p>

<p>
It turns out that Geogebra can illustrate this extremely well.
</p>
</div>

<div id="outline-container-org3c6c581" class="outline-4">
<h4 id="org3c6c581"><span class="section-number-4">2.4.1</span> Equally spaced vertices</h4>
<div class="outline-text-4" id="text-2-4-1">
<p>
Either open up your local version of Geogebra, or go to
<a href="http://geogebra.org/graphing">http://geogebra.org/graphing</a>.  In the boxes on the left, enter the following
expressions in turn:
</p>

<ol class="org-ol">
<li>Start by entering Runge's function
\[
   f(x)=\frac{1}{1+25x^2}
   \]
You should now either zoom in, or use the graph settings tool to display \(x\)
between \(-1.5\) and \(1.5\).</li>
<li>Create a list of \(x\) values:
\[
   x1 = \frac{\\{-5..5\\}}{5}
   \]</li>
<li>Use those values to create a set of points on the curve:
\[
   p1 = (x1,f(x1))
   \]</li>
<li>Now create an interpolating polynomial through them:
\[
   \mathsf{Polynomial}[p1(1)]
   \]</li>
</ol>

<p>
The resulting graph looks like this:
</p>


<div class="figure">
<p><img src="file:///runge1.png" alt="runge1.png" width="600" />
</p>
</div>
</div>
</div>

<div id="outline-container-org9c8fe5a" class="outline-4">
<h4 id="org9c8fe5a"><span class="section-number-4">2.4.2</span> Chebyshev vertices</h4>
<div class="outline-text-4" id="text-2-4-2">
<p>
For the purpose of this post, we'll take the Chebyshev vertices to be those
points in the graph whose \(x\) coordinates are given by
</p>

<p>
\[
x_k = \cos\left(\frac{k\pi}{10}\right)
\] 
for \(k = 0,1,2,\ldots 10\).  These values are more clustered at the ends of the
interval.
</p>

<p>
In Geogebra:
</p>

<ol class="org-ol">
<li>As before, enter the \(x\) values first:
\[
   x2 = \cos(\frac{\\{0..10\\}\cdot\pi}{10})
   \]</li>
<li>Then turn them into a sequence of points on the curve 
\[
   p2 = (x2,f(x2))
   \]</li>
<li>Finally create the polynomial through them: \(\mathsf{Polynomial}(p2(1))\).</li>
</ol>

<p>
And <i>this</i> graph looks like this:
</p>


<div class="figure">
<p><img src="file:///runge2.png" alt="runge2.png" width="600" />
</p>
</div>

<p>
You'll notice how better the second polynomial hugs the curve.  The issue is
even more pronounced with 21 points, either separated by \(0.1\), or with
\(x\) values given by the cosine function again.  All we need do is to change the
definitions of the \(x\) value sequences \(x1\) and \(x2\) to:
</p>

<p>
\[
\eqalign{
x1 &= \frac{\\{-10..10\\}}{10}\\
x2 &= \cos(\frac{\\{0..20\\}\pi}{20})
}
\]
</p>

<p>
In fact, you can create a slider \(1\le N \le 20\), say, and then define
</p>

<p>
\[
\eqalign{
x1 &= \frac{\\{-N..N\\}}{N}\\
x2 &= \cos(\frac{\\{0..2N\\}\pi}{2N})
}
\]
</p>

<p>
and then see how as \(N\) increases, the "Chebyshev" interpolant fits the curve
better than the equally spaced interpolant.  For \(N=20\), the turning points of
the equally spaced polynomial have \(y\) values as high as \(59.78\).
</p>
</div>
</div>

<div id="outline-container-org44898f8" class="outline-4">
<h4 id="org44898f8"><span class="section-number-4">2.4.3</span> Integration</h4>
<div class="outline-text-4" id="text-2-4-3">
<p>
Using equally spaced values to create an interpolating polynomial and then
integrating that polynomial is [Newton-Cotes
integration](<a href="https://en.wikipedia.org/wiki/Newton-Cotes_formulas">https://en.wikipedia.org/wiki/Newton-Cotes_formulas</a>).
Runge's phenomenon shows why it is better to partition the interval into small
sub-intervals and apply a low-order rule to each one.  For example, with 20
points on the curve, we would be better applying Simpson's rule to each pair of
two sub-intervals, and adding the result.  Using a 21-point polynomial is
equivalent to a Newton-Cotes rule of order 20, which is far too inaccurate to
use.
</p>

<p>
With our curve \(f(x)\), and our equal-spaced polynomial \(g(x)\), the integrals are
</p>

<p>
\[
\eqalign{
\int^1_{-1}\frac{1}{1+25x^2}\,dx&=\frac{2}{5}\arctan(5)\approx
0.5493603067780064\\
\int^1_{-1}g(x)\,dx&\approx -5.369910417304622
}
\]
</p>

<p>
However, using the polynomial through the Chebyshev nodes:
</p>

<p>
\[
\int^1_{-1}h(x)\approx 0.5498082303389538.
\]
</p>

<p>
The absolute errors between the integral values and the exact values are thus
(approximately) \(5.92\) and \(0.00045\) respectively.
</p>

<p>
Integrating an interpolating polynomial through Chebyshev nodes is one way of
implementing [Clenshaw-Curtis quadrature](<a href="https://en.wikipedia.org/wiki/Clenshaw-Curtis_quadrature">https://en.wikipedia.org/wiki/Clenshaw-Curtis_quadrature</a>).
</p>

<p>
Note that using Simpson's rule on our 21 points produces a value of
0.5485816035037206, which has absolute error of about \(0.0012\).
</p>
</div>
</div>
</div>

<div id="outline-container-org7ace71b" class="outline-3">
<h3 id="org7ace71b"><span class="section-number-3">2.5</span> Fitting the SIR model of disease to data in Python</h3>
<div class="outline-text-3" id="text-2-5">
</div>

<div id="outline-container-orge8c99d2" class="outline-4">
<h4 id="orge8c99d2"><span class="section-number-4">2.5.1</span> Introduction and the problem</h4>
<div class="outline-text-4" id="text-2-5-1">
<p>
The SIR model for spread of disease was first proposed in 1927 in a collection
of three articles in the Proceedings of the Royal Society by [Anderson Gray
McKendrick](<a href="https://en.wikipedia.org/wiki/Anderson_Gray_McKendrick">https://en.wikipedia.org/wiki/Anderson_Gray_McKendrick</a>) and [William
Ogilvy Kermack](<a href="https://en.wikipedia.org/wiki/William_Ogilvy_Kermack">https://en.wikipedia.org/wiki/William_Ogilvy_Kermack</a>); the
resulting theory is known as [Kermack–McKendrick
theory](<a href="https://en.wikipedia.org/wiki/Kermack%E2%80%93McKendrick_theory">https://en.wikipedia.org/wiki/Kermack–McKendrick_theory</a>); now
considered a subclass of a more general theory known as [compartmental
models](<a href="https://en.wikipedia.org/wiki/Compartmental_models_in_epidemiology">https://en.wikipedia.org/wiki/Compartmental_models_in_epidemiology</a>) in
epidemiology.  The three original articles were republished in 1991, in a special issue
of the [Bulletin of Mathematical 
Biology](<a href="https://link.springer.com/journal/11538/53/1/page/1">https://link.springer.com/journal/11538/53/1/page/1</a>).
</p>

<p>
The SIR model is so named because it assumes a static population, so no births
or deaths, divided into three mutually exclusive classes: those <i>susceptible</i> to
the disease; those <i>infected</i> with the disease, and those <i>recovered with
immunity</i> from the disease.  This model is clearly not applicable to all
possible epidemics: there may be births and deaths, people may be re-infected, and so
on.  More complex models take these and other factors into account.
</p>

<p>
The SIR model consists of three non-linear ordinary differential equations,
parameterized by two growth factors \(\beta\) and \(\gamma\):
</p>

\begin{eqnarray*}
\frac{dS}{dt}&=&-\frac{\beta IS}{N}\\
\frac{dI}{dt}&=&\frac{\beta IS}{N}-\gamma I\\
\frac{dR}{dt}&=&\gamma I
\end{eqnarray*}

<p>
Here \(N\) is the population, and since each of \(S\), \(I\) and \(R\) represent the
number of people in mutually exclusive sets,  we
should have \(S+I+R=N\).  Note that the right hand sides of the equations sum to
zero, hence
\[
\frac{dS}{dt}+\frac{dI}{dt}+\frac{dR}{dt}=\frac{dN}{dt}=0
\]
which indicates that the population is constant.
</p>

<p>
The problem here is to see if values of \(\beta\) and \(\gamma\) can be found which
will provide a close fit to a well-known epidemiological case study: that of
influenza in a British boarding school.  This was described in a 1978 issue of
the [British Medical
Journal](<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1603269/pdf/brmedj00115-0064.pdf">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1603269/pdf/brmedj00115-0064.pdf</a>).
</p>

<p>
This should provide a good test of the SIR model, as it satisfies all of the
criteria.  In this case there was a total population of 763, and an outbreak of
14 days, with infected numbers as:
</p>

<style>
.tab table {
  width: 100%;
}
.tab th,
}
.tab td {
    padding: 5px;
    text-align: right;
}
</style>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides" class="tab">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">&#xa0;</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Day:</td>
<td class="org-right">1</td>
<td class="org-right">2</td>
<td class="org-right">3</td>
<td class="org-right">4</td>
<td class="org-right">5</td>
<td class="org-right">6</td>
<td class="org-right">7</td>
<td class="org-right">8</td>
<td class="org-right">9</td>
<td class="org-right">10</td>
<td class="org-right">11</td>
<td class="org-right">12</td>
<td class="org-right">13</td>
<td class="org-right">14</td>
<td class="org-right">15</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">Infections:</td>
<td class="org-right">1</td>
<td class="org-right">3</td>
<td class="org-right">6</td>
<td class="org-right">25</td>
<td class="org-right">73</td>
<td class="org-right">222</td>
<td class="org-right">294</td>
<td class="org-right">258</td>
<td class="org-right">237</td>
<td class="org-right">191</td>
<td class="org-right">125</td>
<td class="org-right">69</td>
<td class="org-right">27</td>
<td class="org-right">11</td>
<td class="org-right">4</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
Some years ago, on my old (and now taken off line) blog, I explored using
[Julia](<a href="https://julialang.org/">https://julialang.org/</a>) for this task, which was managed easily (once I
got the hang of Julia syntax).  However, that was five years ago, and when I
tried to recreate it I found that Julia has changed over the last five years,
and my original comments and code no longer worked.  So I decided to experiment
with Python instead, in which I have more expertise, or at least, experience.
</p>
</div>
</div>

<div id="outline-container-orgd232468" class="outline-4">
<h4 id="orgd232468"><span class="section-number-4">2.5.2</span> Using Python</h4>
<div class="outline-text-4" id="text-2-5-2">
</div>
<ol class="org-ol">
<li><a id="org97e24fc"></a>Setup and some initial computation<br />
<div class="outline-text-5" id="text-2-5-2-1">
<p>
We start by importing some of the modules and functions we need, and define the data
from the table above:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">import</span> matplotlib.pyplot <span style="color: #0000FF;">as</span> plt
<span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np
<span style="color: #0000FF;">from</span> scipy.integrate <span style="color: #0000FF;">import</span> solve_ivp

<span style="color: #BA36A5;">data</span> = [1, 3, 6, 25, 73, 222, 294, 258, 237, 191, 125, 69, 27, 11, 4]
</pre>
</div>

<p>
Now we enter the SIR system with some (randomly chosen) values of \(\beta\) and
\(\gamma\), using syntax conformable with the solver <code>solve_ivp</code>:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #BA36A5;">beta</span>,<span style="color: #BA36A5;">gamma</span> = [0.01,0.1]

<span style="color: #0000FF;">def</span> <span style="color: #006699;">SIR</span>(t,y):
    <span style="color: #BA36A5;">S</span> = y[0]
    <span style="color: #BA36A5;">I</span> = y[1]
    <span style="color: #BA36A5;">R</span> = y[2]
    <span style="color: #0000FF;">return</span>([-beta*S*I, beta*S*I-gamma*I, gamma*I])
</pre>
</div>

<p>
We can now solve this system using <code>solve\_ivp</code> and plot the results:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #BA36A5;">sol</span> = solve_ivp(SIR,[0,14],[762,1,0],t_eval=np.arange(0,14.2,0.2))

<span style="color: #BA36A5;">fig</span> = plt.figure(figsize=(12,4))
plt.plot(sol.t,sol.y[0])
plt.plot(sol.t,sol.y[1])
plt.plot(sol.t,sol.y[2])
plt.plot(np.arange(0,15),data,<span style="color: #008000;">"k*:"</span>)
plt.grid(<span style="color: #008000;">"True"</span>)
plt.legend([<span style="color: #008000;">"Susceptible"</span>,<span style="color: #008000;">"Infected"</span>,<span style="color: #008000;">"Removed"</span>,<span style="color: #008000;">"Original Data"</span>])
</pre>
</div>

<p>
Note that we have used the <code>t_eval</code> argument in our call to <code>solve_ivp</code> which
allows us to exactly specify the points at which the solution will be given.
This will allow us to align points in the computed values of \(I\) with the
original data.
</p>

<p>
The output is this plot:
</p>

<p>
![First SIR plot](/first<sub>sir</sub><sub>plot.png</sub>)
</p>

<p>
There is a nicer plot, with more attention paid to setup and colours,
[here](<a href="https://scipython.com/book/chapter-8-scipy/additional-examples/the-sir-epidemic-model/">https://scipython.com/book/chapter-8-scipy/additional-examples/the-sir-epidemic-model/</a>). 
This use of scipy to solve the SIR equations uses the <code>odeint</code> tool.  This
works perfectly well, but I believe it is being deprecated in favour of
<code>solve_ivp</code>.
</p>
</div>
</li>

<li><a id="org2ac9768"></a>Fitting the data<br />
<div class="outline-text-5" id="text-2-5-2-2">
<p>
To find values \(\beta\) and \(\gamma\) with a better fit to the data, we start by
defining a function which gives the sum of squared differences between the data
points, and the corresponding values of \(I\).  The problem will then be minimize
that function.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">def</span> <span style="color: #006699;">sumsq</span>(p):
    <span style="color: #BA36A5;">beta</span>, <span style="color: #BA36A5;">gamma</span> = p
    <span style="color: #0000FF;">def</span> <span style="color: #006699;">SIR</span>(t,y):
        <span style="color: #BA36A5;">S</span> = y[0]
        <span style="color: #BA36A5;">I</span> = y[1]
        <span style="color: #BA36A5;">R</span> = y[2]
        <span style="color: #0000FF;">return</span>([-beta*S*I, beta*S*I-gamma*I, gamma*I])
    <span style="color: #BA36A5;">sol</span> = solve_ivp(SIR,[0,14],[762,1,0],t_eval=np.arange(0,14.2,0.2))
    <span style="color: #0000FF;">return</span>(<span style="color: #006FE0;">sum</span>((sol.y[1][::5]-data)**2))
</pre>
</div>

<p>
As you see, we have just wrapped the SIR definition and its solution inside a
calling function whose variables are the parameters of the SIR equations.
</p>

<p>
To minimize this function we need to import another python function first:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">from</span> scipy.optimize <span style="color: #0000FF;">import</span> minimize

<span style="color: #BA36A5;">msol</span> = minimize(sumsq,[0.001,1],method=<span style="color: #008000;">'Nelder-Mead'</span>)
msol.x
</pre>
</div>

<p>
with output:
</p>

<div class="org-src-container">
<pre class="src src-python">array([0.00218035, 0.44553886])
</pre>
</div>

<p>
To see if this does provide a better fit, we can simply run the solver with
these values, and plot them, as we did at the beginning:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #BA36A5;">beta</span>,<span style="color: #BA36A5;">gamma</span> = msol.x
<span style="color: #0000FF;">def</span> <span style="color: #006699;">SIR</span>(t,y):
    <span style="color: #BA36A5;">S</span> = y[0]
    <span style="color: #BA36A5;">I</span> = y[1]
    <span style="color: #BA36A5;">R</span> = y[2]
    <span style="color: #0000FF;">return</span>([-beta*S*I, beta*S*I-gamma*I, gamma*I])
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #BA36A5;">sol</span> = solve_ivp(SIR,[0,14],[762,1,0],t_eval=np.arange(0,14.2,0.2))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #BA36A5;">fig</span> = plt.figure(figsize=(10,4))
plt.plot(sol.t,sol.y[0],<span style="color: #008000;">"b-"</span>)
plt.plot(sol.t,sol.y[1],<span style="color: #008000;">"r-"</span>)
plt.plot(sol.t,sol.y[2],<span style="color: #008000;">"g-"</span>)
plt.plot(np.arange(0,15),data,<span style="color: #008000;">"k*:"</span>)
plt.legend([<span style="color: #008000;">"Susceptible"</span>,<span style="color: #008000;">"Infected"</span>,<span style="color: #008000;">"Removed"</span>,<span style="color: #008000;">"Original Data"</span>])
</pre>
</div>

<p>
with output:
</p>

<p>
![Second SIR plot](/second<sub>sir</sub><sub>plot.png</sub>)
</p>

<p>
and as you see, a remarkably close fit!
</p>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-org9bae489" class="outline-3">
<h3 id="org9bae489"><span class="section-number-3">2.6</span> Mapping voting gains between elections</h3>
<div class="outline-text-3" id="text-2-6">
<p>
So this goes back quite some time to the recent Australian Federal election on
May 18.  In my own electorate (known formally as a "Division") of Cooper, the
Greens, who until recently had been showing signs of winning the seat, were
pretty well trounced by Labor.
</p>
</div>

<ol class="org-ol">
<li><a id="org22b3ca6"></a>Some background asides<br />
<div class="outline-text-5" id="text-2-6-0-1">
<p>
First, "Labor" as in "Australian Labor Party" is spelled the
American way; that is, without a "u", even though "labour" meaning work, is so
spelled in Australian English.  This is because much of Australia's pre-federal
political history has a large American influence; indeed one of the loudest
political voices in the 19th century was [King
O'Malley](<a href="https://en.wikipedia.org/wiki/King_O'Malley">https://en.wikipedia.org/wiki/King_O'Malley</a>) who was born in 1858 in
Kansas, and didn't come to Australia until he was about 30. He was responsible,
amongst other things, for selecting the site for Canberra (the nation's capital)
and in selecting Walter Burley Griffin as its architect.  As well, the
Australian Constitution shows a large American influence; the constitutions of
both countries bear a remarkably close resemblance, and Australia's parliament
is modelled on that of the United States Congress.
</p>

<p>
Second, my electorate was formerly known as "Batman" after [John
Batman](<a href="https://en.wikipedia.org/wiki/John_Batman">https://en.wikipedia.org/wiki/John_Batman</a>), the supposed founder of
Melbourne.  However, Batman was known in his lifetime as a contemptible figure,
and the historical record well bears out the description of him as "the vilest
man I have ever known".  He was responsible for the slaughter of indigenous
peoples, and his so called "treaty" with the people of the Kulin Nation in
exchange for land on what would would become Melbourne is considered invalid.
In respect for the local peoples ("who have never ceded sovereignty"), the
electorate was renamed last year in honour of 
[William Cooper](<a href="https://en.wikipedia.org/wiki/William_Cooper_(Aboriginal_Australian)">https://en.wikipedia.org/wiki/William_Cooper_(Aboriginal_Australian)</a>), a
Yorta Yorta elder, a tireless activist for Aboriginal rights, and the only
individual in the world to lodge a formal protest to a German embassy on the
occasion of Kristallnacht.
</p>
</div>
</li>

<li><a id="org3de8463"></a>Back to mapping<br />
<div class="outline-text-5" id="text-2-6-0-2">
<p>
All I wanted to do was to map the size of Labor's gains (over the Greens)
between the last election in 2016 and this one, at
each polling booth in the electorate.  For this I used the following Python
packages: [matplotlib](<a href="https://matplotlib.org/">https://matplotlib.org/</a>),
[pandas](<a href="https://pandas.pydata.org/">https://pandas.pydata.org/</a>), [geopandas](<a href="http://geopandas.org/">http://geopandas.org/</a>),
[numpy](<a href="https://numpy.org/">https://numpy.org/</a>),
[cartopy](<a href="https://scitools.org.uk/cartopy/docs/latest/">https://scitools.org.uk/cartopy/docs/latest/</a>). The nice thing about
Python, for me at least, is the ease of prototyping, and the availability of
packages for just about everything.  Indeed, for an amateur programmer like
myself, one of the biggest difficulties is finding the right package for the
job.  There's a score or more for GIS alone.
</p>

<p>
All information about the election can be downloaded from the [Australian
Electorial Commission
tallyroom](<a href="https://tallyroom.aec.gov.au/HouseDefault-24310.htm">https://tallyroom.aec.gov.au/HouseDefault-24310.htm</a>).  And the GIS
information can be obtained also from the
[AES](<a href="https://www.aec.gov.au/Electorates/gis/gis_datadownload.htm">https://www.aec.gov.au/Electorates/gis/gis_datadownload.htm</a>).  The
Victorian [shapefile](<a href="https://en.wikipedia.org/wiki/Shapefile">https://en.wikipedia.org/wiki/Shapefile</a>) needs to be
unzipped before using.
</p>

<p>
Then the map set-up looks like this:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #BA36A5;">shp</span> = gpd.read_file(<span style="color: #008000;">'VicMaps/E_AUGFN3_region.shp'</span>)
<span style="color: #BA36A5;">cooper</span> = shp.loc[shp[<span style="color: #008000;">'Elect_div'</span>]==<span style="color: #008000;">'Cooper'</span>]
<span style="color: #BA36A5;">bounds</span> = cooper.geometry.bounds
<span style="color: #BA36A5;">bg</span> = bounds.values[0]  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">latitude, longitude of extent of region</span>
<span style="color: #BA36A5;">pad</span> = 0.01             <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">padding for display</span>
<span style="color: #BA36A5;">extent</span> = [bg[0]-pad,bg[2]+pad,bg[1]-pad,bg[3]+pad]
</pre>
</div>

<p>
The idea of the padding is simply to ensure that the map, once displayed,
extends beyond the area of the electorate.  The units are degrees of latitude
and longitude.  In Melbourne, at about 37.8 degrees south, 0.01 degrees latitude
corresponds to about 1.11km, and 0.01 degrees longitude corresponds to about 0.88km.
</p>

<p>
Now we need to determine the percentage of votes to Labor (on a two-party
preferred computation) which again involves reading material from the AEC site.
I downloaded it first, but it could also be read directly from the site into
pandas.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Get all votes by polling booths in Cooper for 2019</span>
<span style="color: #BA36A5;">b19</span> = pd.read_csv(<span style="color: #008000;">'Elections/TCPByCandidateByPollingPlaceVIC-2019.csv'</span>)  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">b19 = booths, 2019</span>
<span style="color: #BA36A5;">v19</span> = b19.loc[b19.DivisionNm==<span style="color: #008000;">'Cooper'</span>] <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">v19 = Cooper Booths, 2019</span>
<span style="color: #BA36A5;">v19</span> = v19[[<span style="color: #008000;">'PollingPlace'</span>,<span style="color: #008000;">'PartyAb'</span>,<span style="color: #008000;">'OrdinaryVotes'</span>]]
<span style="color: #BA36A5;">v19r</span> = v19.loc[v19.PartyAb==<span style="color: #008000;">'GRN'</span>]
<span style="color: #BA36A5;">v19k</span> = v19.loc[v19.PartyAb==<span style="color: #008000;">'ALP'</span>]
<span style="color: #BA36A5;">v19c</span> = v19r.merge(v19k,left_on=<span style="color: #008000;">'PollingPlace'</span>,right_on=<span style="color: #008000;">'PollingPlace'</span>)  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Complete votes</span>
<span style="color: #BA36A5;">v19c</span>[<span style="color: #008000;">'Percent_x'</span>] = (v19c[<span style="color: #008000;">'OrdinaryVotes_x'</span>]*100/(v19c[<span style="color: #008000;">'OrdinaryVotes_x'</span>]+v19c[<span style="color: #008000;">'OrdinaryVotes_y'</span>])).<span style="color: #006FE0;">round</span>(2)
<span style="color: #BA36A5;">v19c</span>[<span style="color: #008000;">'Percent_y'</span>] = (v19c[<span style="color: #008000;">'OrdinaryVotes_y'</span>]*100/(v19c[<span style="color: #008000;">'OrdinaryVotes_x'</span>]+v19c[<span style="color: #008000;">'OrdinaryVotes_y'</span>])).<span style="color: #006FE0;">round</span>(2)
<span style="color: #BA36A5;">v19c</span> = v19c.dropna()
<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">note: suffix -x is GRN; suffix _y is ALP</span>
</pre>
</div>

<p>
The next step is to determine the positions of all polling places.  For
simplification, I'm only interested in places used in both this most recent
election, and the previous federal election in 2016:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #BA36A5;">v16</span> = pd.read_csv(<span style="color: #008000;">'Elections/Batman2016_TCP.csv'</span>)
<span style="color: #BA36A5;">v_both</span> = v16.merge(v19c,right_on=<span style="color: #008000;">'PollingPlace'</span>,left_on=<span style="color: #008000;">'Booth'</span>)
<span style="color: #BA36A5;">c19</span> = pd.read_csv(<span style="color: #008000;">'Elections/Cooper_PollingPlaces.csv'</span>)
<span style="color: #BA36A5;">c19</span> = c19.drop(44).reset_index()  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Drop Special Hospital, which has index 44</span>
<span style="color: #BA36A5;">v_all</span>=v_both.merge(c19,left_on=<span style="color: #008000;">'PollingPlace'</span>,right_on=<span style="color: #008000;">'PollingPlaceNm'</span>)
<span style="color: #BA36A5;">lats</span> = np.array(v_all[<span style="color: #008000;">'Latitude'</span>])
<span style="color: #BA36A5;">longs</span> = np.array(v_all[<span style="color: #008000;">'Longitude'</span>])
<span style="color: #BA36A5;">booths</span> = np.array(v_all[<span style="color: #008000;">'PollingPlaceNm'</span>])
<span style="color: #BA36A5;">diffs</span> = np.array(v_all[<span style="color: #008000;">'Percent_y'</span>]-v_all[<span style="color: #008000;">'ALP percent'</span>]) <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">change in ALP percentage</span>
</pre>
</div>

<p>
Having now got the boundary of the electorate, the positions of each polling
booth, the percentage change in votes for Labor, the map can now be created and
displayed:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #BA36A5;">fig</span> = plt.figure(figsize = (16,16))
<span style="color: #BA36A5;">tiler</span> = GoogleTiles()
<span style="color: #BA36A5;">ax</span> = plt.axes(projection=tiler.crs)
ax.set_extent(extent)
ax.add_image(tiler, 13, interpolation=<span style="color: #008000;">'hanning'</span>)
ax.add_geometries(cooper.geometry,crs=ccrs.PlateCarree(),facecolor=<span style="color: #008000;">'none'</span>,edgecolor=<span style="color: #008000;">'k'</span>,linewidth=2)
<span style="color: #0000FF;">for</span> i <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">range</span>(34):
    <span style="color: #0000FF;">if</span> diffs[i]&gt;0:
        ax.plot(longs[i],lats[i],marker=<span style="color: #008000;">'o'</span>,markersize=diffs[i],markerfacecolor=<span style="color: #008000;">'r'</span>,transform=ccrs.Geodetic())
    <span style="color: #0000FF;">else</span>:
        ax.plot(longs[i],lats[i],marker=<span style="color: #008000;">'o'</span>,markersize=-diffs[i],markerfacecolor=<span style="color: #008000;">'g'</span>,transform=ccrs.Geodetic())
plt.show()
</pre>
</div>

<p>
I found by trial and error that Hanning interpolation seemed to give the best
results.
</p>

<p>
![Swings 2019](/swings.jpg)
</p>

<p>
So this image shows not the size of Labor's <i>vote</i>, but the size of Labor's
<i>gain</i> since the previous election.  The larger gains are in the southern part of
the electorate: the northern part has always been more Labor friendly, and so the
gains were smaller there.
</p>
</div>
</li>
</ol>
</div>

<div id="outline-container-org22f51ff" class="outline-3">
<h3 id="org22f51ff"><span class="section-number-3">2.7</span> Educational disciplines: size against market growth</h3>
<div class="outline-text-3" id="text-2-7">
<p>
Here is an [interactive version](/educ.html) of this diagram:
</p>

<p>
[![APF Figure 4](/APF<sub>figure</sub><sub>4</sub><sub>small.png</sub>)](/APF<sub>figure</sub><sub>4.png</sub>)
</p>

<p>
(click on the image to show a larger version.)
</p>
</div>
</div>

<div id="outline-container-org0ac2186" class="outline-3">
<h3 id="org0ac2186"><span class="section-number-3">2.8</span> Tschirnhausen transformations and the quartic</h3>
<div class="outline-text-3" id="text-2-8">
<p>
Here we show how a Tschirnhausen transformation can be used to solve a quartic
equation.  The steps are:
</p>
<ol class="org-ol">
<li><p>
Ensure the quartic is missing the cubic term, and its initial coefficient
is 1.  We can do this by first dividing by the initial coefficient to obtain
an equation
\[
   x^4+b_3x^3+b_2x^2+b_1x+b_0=0
   \]
and then replace the variable \(x\) with \(y=x-b_3/ 4\).  This will produce a monic
quartic equation missing the cubic term.
</p>

<p>
We can thus take
\[
   x^4+bx^2+cx+d=0
   \]
as a completely general formulation of the quartic equation. 
</p></li>
<li>Now apply the Tschirnhausen transformation
\[
   y = x^2+rx+s
   \]
using the resultant, which will produce a quartic equation in \(y\).</li>
<li>Chose \(r\) and \(s\) so that the coefficients of the linear and cubic terms are
zero.  This will require solving a cubic equation.</li>
<li>Substitute those \(r,s\) values into the resultant, which will produce a
biquadratic equation in \(y\):
\[
   y^4+Ay^2+B=0.
   \]
This can be readily solved as it's a quadratic in \(y^2\).  Finally, for each value of
\(y\), and using the \(r,s\) values, solve
\[
   x^2+rx+s-y=0.
   \]
This will in fact produce eight values, of which four are the solution to the
original quartic.</li>
</ol>
</div>

<div id="outline-container-orgde07900" class="outline-4">
<h4 id="orgde07900"><span class="section-number-4">2.8.1</span> An example</h4>
<div class="outline-text-4" id="text-2-8-1">
<p>
Consider the equation
\[
x^4-94x^2-480x-671=0
\]
which has solutions
</p>
\begin{align*}
x &= -2 \, \sqrt{5} \pm \sqrt{3} \sqrt{9 -4\, \sqrt{5}},\\
x &=  2 \, \sqrt{5} \pm \sqrt{3} \sqrt{9 + 4 \, \sqrt{5}}
\end{align*}
<p>
Note that these relatively nice solutions arise from the polynomial being
factorizable in the number field \(\mathbb{Q}[\sqrt{5}]\).  We can show this using
[Sagemath](<a href="http://www.sagemath.org">http://www.sagemath.org</a>): 
</p>

<div class="org-src-container">
<pre class="src src-python">N.&lt;a&gt; = NumberField(x^2-5)
K.&lt;x&gt; = N[]
factor(x^4 - 94*x^2 - 480*x - 671)
</pre>
</div>
<p>
\[ 
(x^{2} - 4 a x - 12 a - 7) \cdot (x^{2} + 4 a x + 12 a - 7) 
\] 
</p>

<p>
We shall continue to use Sagemath to perform all the dirty work; here's how this
solution works:
</p>

<div class="org-src-container">
<pre class="src src-python">var(<span style="color: #008000;">'x,y,r,s'</span>)
<span style="color: #BA36A5;">qx</span> = x^4 - 94*x^2 - 480*x - 671
<span style="color: #BA36A5;">res</span> = qx.resultant(y-x^2-r*x-s,x).poly(y)
</pre>
</div>

<p>
We now want to find the values of \(r\) and \(s\) to eliminate the linear and cubic
terms.  The cubic term is easy:
</p>

<div class="org-src-container">
<pre class="src src-python">res.coefficient(y,3)
</pre>
</div>
<p>
\[
-4s-188
\]
and so
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #BA36A5;">s_sol</span> = solve(res.coefficient(y,3),s,solution_dict=<span style="color: #D0372D;">True</span>)
</pre>
</div>
<p>
and we can substitute this into the linear coefficient:
</p>
<div class="org-src-container">
<pre class="src src-python">res.coefficient(y,1).subs(s_sol[0]).factor()
</pre>
</div>
<p>
\[
-480(r+10)(r+8)(r+6).
\]
In general the coefficient would not be as neatly factorizable as this, but we
can still find the values of \(r\):
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #BA36A5;">r_sol</span> = solve(res.coefficient(y,1).subs(s_sol[0]),r,solution_dict=<span style="color: #D0372D;">True</span>)
</pre>
</div>
<p>
We can choose any value we like; here let's choose the first value and
substitute it into the resultant from above, first creating a dictionary to
hold the \(r\) and \(s\) values:
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #BA36A5;">rs</span> = s_sol[0].copy()
rs.update(r_sol[0])
rs
</pre>
</div>
<p>
\[
\lbrace s:-47,r:-8\rbrace
\]
</p>
<div class="org-src-container">
<pre class="src src-python">res.subs(rs)
</pre>
</div>
<p>
\[
y^4-256y^2+1024
\]
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #BA36A5;">y_sol</span> = solve(res.subs(rs),y,solution_dict=<span style="color: #D0372D;">True</span>)
</pre>
</div>
<p>
This will produce four values of \(y\), and for each one we solve the equation
\[
x^2+rx+s-y=0
\]
for \(x\):
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">for</span> ys <span style="color: #0000FF;">in</span> ysol:
    display(solve((x^2+r*x+s-y).subs(rs).subs(ys),x))
</pre>
</div>
\begin{align*}
x &= -\sqrt{-4 \, \sqrt{2 \, \sqrt{15} + 8} + 63} + 4,& 
x &= \sqrt{-4 \, \sqrt{2 \, \sqrt{15} + 8} + 63} + 4\\
x &= -\sqrt{4 \, \sqrt{2 \, \sqrt{15} + 8} + 63} + 4,&
x& = \sqrt{4 \,\sqrt{2 \, \sqrt{15} + 8} + 63} + 4\\
x& = -\sqrt{-4 \, \sqrt{-2 \, \sqrt{15} + 8} + 63} + 4,&
x& = \sqrt{-4 \,\sqrt{-2 \, \sqrt{15} + 8} + 63} + 4\\
x& = -\sqrt{4 \, \sqrt{-2 \, \sqrt{15} + 8} + 63} + 4,&
x& = \sqrt{4 \, \sqrt{-2 \, \sqrt{15} + 8} + 63} + 4
\end{align*}
<p>
We can check these values to see which ones are actually correct.  But to
experiment, we can determine the minimal polynomial of each value given:
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">for</span> ys <span style="color: #0000FF;">in</span> ysol:
    <span style="color: #BA36A5;">s1</span> = solve((x^2+r*x+s-y).subs(rs).subs(ys),x,solution_dict=<span style="color: #D0372D;">True</span>)
    <span style="color: #BA36A5;">ql</span> = [QQbar(z[x]).minpoly() <span style="color: #0000FF;">for</span> z <span style="color: #0000FF;">in</span> s1]
    display(ql) 
</pre>
</div>
\begin{align*}
&x^{4} - 94 x^{2} - 480 x - 671,&& x^{4} - 32 x^{3} + 290 x^{2} - 64 x - 6431&\\
&x^{4} - 94 x^{2} - 480 x - 671,&& x^{4} - 32 x^{3} + 290 x^{2} - 64 x - 6431&\\
&x^{4} - 32 x^{3} + 290 x^{2} - 64 x - 6431,&& x^{4} - 94 x^{2} - 480 x - 671&\\
&x^{4} - 94 x^{2} - 480 x - 671,&& x^{4} - 32 x^{3} + 290 x^{2} - 64 x - 6431&
\end{align*}
<p>
Half of these are the original equation we tried to solve.  And the others?
</p>
<div class="org-src-container">
<pre class="src src-python">qx.subs(x=8-x).expand()
</pre>
</div>
<p>
\[
x^{4} - 32 x^{3} + 290 x^{2} - 64 x - 6431
\]
This is in fact what we should expect, from solving the equation
\[
x^2+rx+s-y=0
\]
If the roots are \(x_1\) and \(x_2\), then by Vieta's formulas \(x_1+x_2=-(-r)=r\).
</p>
</div>
</div>

<div id="outline-container-org9e590c0" class="outline-4">
<h4 id="org9e590c0"><span class="section-number-4">2.8.2</span> Further comments</h4>
<div class="outline-text-4" id="text-2-8-2">
<p>
The trouble with this method is that it only works nicely on some equations.  In
general, the snarls of square, cube, and fourth roots become unwieldy
very quickly.  For example, consider the equation
\[
x^4+6x^2-60x+36=0
\]
which according to Cardan in [Ars Magna](<a href="https://en.wikipedia.org/wiki/Ars_Magna_(Gerolamo_Cardano)">https://en.wikipedia.org/wiki/Ars_Magna_(Gerolamo_Cardano)</a>) (Chapter XXXIX, Problem V) was first
solved by Ferrari.
</p>

<p>
Taking the resultant with \(y-x^2-rx-s\) as a polynomial on \(y\), we find that the
coefficient of \(y^3\) is \(-4s+12\), and so \(s=3\).  Substituting this in the
linear coefficient, we obtain this cubic in \(r\):
\[
5r^3-9r^2-60r+300=0.
\]
The simplest (real) solution is:
\[
r = \frac{1}{5} \, {\left(50 \, \sqrt{3767} - 3273\right)}^{\frac{1}{3}} + \frac{109}{5 \, {\left(50 \, \sqrt{3767} - 3273\right)}^{\frac{1}{3}}} + \frac{3}{5}
\]
Substituting these values of \(r\) and \(s\) into the resultant, we obtain the
equation
\[
y^4+c_2y^2+c_0=0
\]
with
\[
c_2=\frac{6 \, {\left({\left(50 \, \sqrt{3767} - 3273\right)}^{\frac{2}{3}}
{\left(50 \, \sqrt{3767} - 18969\right)} - {\left(7200 \, \sqrt{3767} -
483193\right)} {\left(50 \, \sqrt{3767} - 3273\right)}^{\frac{1}{3}} + 100 \,
\sqrt{3767} - 6546\right)}}{25 \, {\left(50 \, \sqrt{3767} - 3273\right)}}
\]
and
\[
  c_0=\frac{27\left(% 
    \begin{array}{l}
      2\,(14353657451700 \, \sqrt{3767} - 880869586608887)\,
      (50 \, \sqrt{3767} - 3273)^{\frac{2}{3}}\\
      \quad+109541 \, (2077754350 \, \sqrt{3767} - 127532539917) (50 \,
      \sqrt{3767} - 3273)^{\frac{1}{3}}\quad{}\\
      \hspace{18ex} - 5262543802068000 \, \sqrt{3767} + 322980491997672634
    \end{array}%
   \right)}
  {625 \, {\left(2077754350 \, \sqrt{3767} -
 127532539917\right)} {\left(50 \, \sqrt{3767} - 3273\right)}^{\frac{1}{3}}}
\]
Impressed?
</p>

<p>
Right, so we solve the equation for \(y\), to obtain
\[
y=\pm\sqrt{-\frac{1}{2}c_2\pm\frac{1}{2}\sqrt{c_2^2-4c_0}}.
\]
For each of those values of \(y\), we solve the equation
\[
x^2+rx+s-y=0
\]
to obtain (for example)
\[
x= = -\frac{1}{2} \, r \pm \frac{1}{2} \, \sqrt{r^{2} - 4 \, s + 4 \,
\sqrt{-\frac{1}{2} \, c_{2} + \frac{1}{2} \, \sqrt{c_{2}^{2} - 4 \, c_{0}}}}
\]
With \(r\) being the solution of a cubic equation, and \(c_0\), \(c_2\) being the
appalling expressions above, you can see that this solution, while "true" in a
logical sense, is hardly useful or enlightening.
</p>

<p>
Cardan again: "So progresses arithmetic subtlety, the end of which, it is said,
is as refined as it is useless."
</p>
</div>
</div>
</div>

<div id="outline-container-orgeef08dc" class="outline-3">
<h3 id="orgeef08dc"><span class="section-number-3">2.9</span> Tschirnhausen's solution of the cubic</h3>
<div class="outline-text-3" id="text-2-9">
<p>
A general cubic <i>polynomial</i> has the form
\[
ax^3+bx^2+cx+d
\]
but a general cubic <i>equation</i> can have the form
\[
x^3+ax^2+bx+c=0.
\]
We can always divide through by the coefficient of \(x^3\) (assuming it to be
non-zero) to obtain a monic equation; that is, with leading coefficient of 1.
We can now remove the \(x^2\) term by replacing \(x\) with \(y-a/3\):
\[
\left(y-\frac{a}{3}\right)^{\negmedspace 3}+a\left(y-\frac{a}{3}\right)^{\negmedspace 2}
+b\left(y-\frac{a}{3}\right)+c=0.
\]
Expanding and simplifying produces
\[
y^3+\left(b-\frac{a^2}{3}\right)y+\frac{2}{27}a^3-\frac{1}{3}ab+c=0.
\]
In fact this can be simplified by writing the initial equation as
\[
x^3+3ax^2+bx+c=0
\]
and then substituting \(x=y-a\) to obtain
\[
y^3+(b-3a^2)y+(2a^3-ab+c)=0.
\]
This means that in fact an equation of the form
\[
y^3+Ay+B=0
\]
is a completely general form of the cubic equation.  Such a form of a cubic
equation, missing the quadratic term, is known as a <i>depressed cubic</i>.
</p>

<p>
We could go even further by substituting 
\[
y=z\sqrt{A}
\]
to obtain
</p>

<p>
\[
A^{3/ 2}z^3+A\sqrt{A}z+B=0
\]
</p>

<p>
and dividing through by \(A^{3/ 2}\) to produce
</p>

<p>
\[
z^3+z+BA^{-3/ 2}=0.
\]
</p>

<p>
This means that 
</p>

<p>
\[
z^3+z+W=0
\]
</p>

<p>
is also a perfectly general form for the cubic equation.
</p>
</div>

<div id="outline-container-org60c2e37" class="outline-4">
<h4 id="org60c2e37"><span class="section-number-4">2.9.1</span> Cardan's method</h4>
<div class="outline-text-4" id="text-2-9-1">
<p>
Although this is named for [Gerolamo
Cardano](<a href="https://en.wikipedia.org/wiki/Gerolamo_Cardano">https://en.wikipedia.org/wiki/Gerolamo_Cardano</a>) (1501-1576), the method
was in fact discovered by [Niccolò
Fontana](<a href="https://en.wikipedia.org/wiki/Niccol%C3%B2_Fontana_Tartaglia">https://en.wikipedia.org/wiki/Niccolò_Fontana_Tartaglia</a>) (1500-1557),
known as Tartaglia ("the stammerer") on account of a injury obtained when a
soldier slashed his face when he was a boy.  In the days before peer review and
formal dissemination of ideas, any new mathematics was closely guarded:
mathematicians would have public tests of skill, and a new solution method was
invaluable.  After assuring Tartaglia that his new method was safe with him,
Cardan then proceeded to publish it as his own in his magisterial <i>Ars Magna</i>
in 1545.  A fascinating account of the mix of Cardan, Tartaglia, and several
other egotistic mathematicians of the time, can be [read
here](<a href="http://brain.caltech.edu/ist4/lectures/Cardano-Tartaglia_Dispute.pdf">http://brain.caltech.edu/ist4/lectures/Cardano-Tartaglia_Dispute.pdf</a>).
</p>

<p>
Cardan's method solves the equation
\[
x^3-3ax-2b=0
\]
noting from above that this is a perfectly general form for the cubic, and where
we have introduced factors of \(-3\) and \(-2\) to eliminate fractions later on.  We start by
assuming that the solution will have the form
\[
x=p^{1/ 3}+q^{1/ 3}
\]
and so
\[
x^3=(p^{1/ 3}+q^{1/ 3})^3=p+3p^{2/ 3}q^{1/ 3}+3p^{1/ 3}q^{2/ 3}+q.
\]
This last can be written as
\[
p+q+3p^{1/ 3}q^{1/ 3}(p^{1/ 3}+q^{1/ 3}).
\]
We can thus write
\[
x^3=3p^{1/ 3}q^{1/ 3}x+p+q
\]
and comparing with the initial cubic equation we have
\[
3p^{1/ 3}q^{1/ 3}=3a,\quad p+q=2b.
\]
These can be written as
\[
pq=a^3,\quad p+q=2b
\]
for which the solutions are 
\[
p,q=b\pm\sqrt{b^2-a^3}
\]
and so
\[
x = (b+\sqrt{b^2-a^3})^{1/ 3}+(b-\sqrt{b^2-a^3})^{1/ 3}.
\]
This can be written in various different ways.
</p>

<p>
For example,
\[
x^3-6x-6=0
\]
for which \(a=2\) and \(b=3\).  Here \(b^2-a^3=1\) and so one solution is
\[
x=4^{1/ 3}+2^{1/ 3}.
\]
Given that a cubic must have three solutions, the other two are
\[
\omega p^{1/ 3}+\omega^2 q^{1/ 3},\quad \omega^2 p^{1/ 3}+\omega q^{1/ 3}
\]
where \(\omega\) is a cube root of 1, for example
\[
\omega=\frac{1}{2}+i\frac{\sqrt{3}}{2}.
\]
</p>
</div>
</div>

<div id="outline-container-orgdb03a86" class="outline-4">
<h4 id="orgdb03a86"><span class="section-number-4">2.9.2</span> And so to Tschirnhausen</h4>
<div class="outline-text-4" id="text-2-9-2">
<p>
At the beginning we eliminated the \(x^2\) terms from a cubic equation by a linear
substitution \(x=y-a/3\) or \(y=x+a/3\).  Writing in the year 1680, the German
mathematician [Ehrenfried Walther von
Tschirnhausen](<a href="https://en.wikipedia.org/wiki/Ehrenfried_Walther_von_Tschirnhaus">https://en.wikipedia.org/wiki/Ehrenfried_Walther_von_Tschirnhaus</a>)
(1651-1708) began experimenting with more general polynomial substitutions,
believing that it would be possible to eliminate other terms at the same time.
Such substitutions are now known as [Tschirnhausen
transformations](<a href="https://en.wikipedia.org/wiki/Tschirnhaus_transformation">https://en.wikipedia.org/wiki/Tschirnhaus_transformation</a>) and
of course the modern general approach places them squarely within field theory.  
</p>

<p>
Tschirnhausen was only partially correct: it is indeed possible to remove <i>some</i>
terms from a polynomial equation, and in 1858 the English mathematician [George
Jerrard](<a href="https://en.wikipedia.org/wiki/George_Jerrard">https://en.wikipedia.org/wiki/George_Jerrard</a>) (1804-1863) showed that it
was possible to remove the terms of degree \(n-1\), \(n-2\) and \(n-3\) from a
polynomial of degree \(n\).  In particular, the general quintic equation can be
reduced to
\[
x^5+px+q=0
\]
which is known as the <i>Bring-Jerrard form</i>; also honouring Jerrard's predecessor,
the Swedish mathematician [Erland
Bring](<a href="https://en.wikipedia.org/wiki/Erland_Samuel_Bring">https://en.wikipedia.org/wiki/Erland_Samuel_Bring</a>) (1736-1798).  Note
that Jerrard was quite well aware of the work of Ruffini, Abel and Galois in
proving the general unsolvability by radicals of the quintic equation.
</p>

<p>
Neither Bring nor Tschirnhausen had the advantage of this knowledge, and both
were working towards a general solution of the quintic.
</p>

<p>
Happily, Tschirnhausen's work is available in an English translation, published
in the [ACM SIGSAM Bulletin by R. F. Green in
2003](<a href="https://dl.acm.org/citation.cfm?id=844078">https://dl.acm.org/citation.cfm?id=844078</a>). For further delight, Jerrard's
text, with the splendidly formal English title "An Essay on the Resolution of
Equations", is also [available
online](<a href="https://archive.org/details/essayonresolutio00jerrrich">https://archive.org/details/essayonresolutio00jerrrich</a>). 
</p>

<p>
After that history lesson, let's explore how to remove both the quadratic and
linear terms from a cubic equation using Tschirnhausen's method, and also using
[SageMath](<a href="http://www.sagemath.org">http://www.sagemath.org</a>) to do the heavy algebraic work.  There is in
fact nothing particularly conceptually difficult, but the algebra is quite messy
and fiddly.
</p>

<p>
We start with a depressed cubic equation
\[
x^3+3ax+2b=0
\]
and we will use the Tschirnhausen transformation
\[
y=x^2+rx+s.
\]
</p>

<p>
This can be done by hand of course, using a somewhat fiddly argument, but for us
the best approach is to compute the
[resultant](<a href="https://en.wikipedia.org/wiki/Resultant">https://en.wikipedia.org/wiki/Resultant</a>) of the two polynomials,
which is a polynomial expression equal to zero if the two polynomials have a
common root.  The resultant can be computed as the determinant of the
[Sylvester matrix](<a href="https://en.wikipedia.org/wiki/Sylvester_matrix">https://en.wikipedia.org/wiki/Sylvester_matrix</a>) (named for
its discoverer); but we can simply use SageMath:
</p>

<div class="org-src-container">
<pre class="src src-python">var(<span style="color: #008000;">'a,b,c,x,y,r,s'</span>)
<span style="color: #BA36A5;">cb</span> = x^3 + 3*a*x + 2*b
<span style="color: #BA36A5;">res</span> = cb.resultant(y-x^2-r*x-s,x).poly(y)
res
</pre>
</div>

<p>
\[
\displaylines{
y^3+3(2a-s)y^{2}+3(ar^{2}+3a^{2}+2r-4as+s^{2})y\\
{\ }\mspace4em -4b^{2}+2br^{3}-3ar^{2}s+6abr-9a^{2}s-6brs+6as^{2}-s^{3}
}
\]
</p>

<p>
Now we find values of \(r\) and \(s\) for which the coefficients of \(y^2\) and \(y\)
will be zero:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #BA36A5;">sol</span> = solve([res.coefficient(y,1),res.coefficient(y,2)],[r,s],solution_dict=<span style="color: #D0372D;">True</span>)
sol
</pre>
</div>

<p>
\[
\left[\left\lbrace s : 2 \, a, r : -\frac{b + \sqrt{a^{3} + b^{2}}}{a}\right\rbrace,
\left\lbrace s : 2 \, a, r : -\frac{b - \sqrt{a^{3} + b^{2}}}{a}\right\rbrace\right]
\]
</p>

<p>
We can now substitute say the second solution into the resultant from above,
which should produce an expression of the form \(y^3+A\):
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #BA36A5;">cby</span> = res.subs(sol[1]).canonicalize_radical().poly(y)
cby
</pre>
</div>

<p>
\[
y^3-8 \, a^{3} - 16 \, b^{2} + 8 \, \sqrt{a^{3} + b^{2}} b - \frac{8 \, b^{4}}{a^{3}} + \frac{8 \, \sqrt{a^{3} + b^{2}} b^{3}}{a^{3}}
\]
We can simply take the cube root of the constant term as our solution:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #BA36A5;">sol_y</span> = solve(cby,y,solution_dict=<span style="color: #D0372D;">True</span>)
sol_y[2]
</pre>
</div>

<p>
\[
\left\lbrace y : \frac{2 \, {\left(a^{6} + 2 \, a^{3} b^{2} - \sqrt{a^{3} + b^{2}}
a^{3} b + b^{4} - \sqrt{a^{3} + b^{2}} b^{3}\right)}^{\frac{1}{3}}}{a}\right\rbrace
\]
</p>

<p>
Now we solve the equation \(y=x^2+rx+s\) using the values \(r\) and \(s\) from above,
and the value of \(y\) just obtained:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #BA36A5;">eq</span> = x^2+r*x+s-y
<span style="color: #BA36A5;">eqrs</span> = eq.subs(sol[1])
<span style="color: #BA36A5;">eqx</span> = eqrs.subs(sol_y[2])
<span style="color: #BA36A5;">solx</span> =  solve(eqx,x,solution_dict=<span style="color: #D0372D;">True</span>)
solx[0]
</pre>
</div>

<p>
\[
\left\lbrace x : \frac{b - \sqrt{a^{3} + b^{2}} - \sqrt{-7 \, a^{3} + 2 \, b^{2} - 2 \, \sqrt{a^{3} + b^{2}} b + 8 \, {\left(a^{6} + 2 \, a^{3} b^{2} + b^{4} - {\left(a^{3} b + b^{3}\right)} \sqrt{a^{3} + b^{2}}\right)}^{\frac{1}{3}} a}}{2 \, a}\right\rbrace
\]
</p>

<p>
A equation, of err&#x2026; rare beauty, or if not beauty, then something else.  It
certainly lacks the elegant simplicity of Cardan's solution.  On the other hand,
the method can be applied to quartic (and quintic) equations, which Cardan's
solution can't.
</p>

<p>
Finally, let's test this formula, again on the equation \(x^3-6x-6=0\), for which \(a=-2\)
and \(b=-3\):
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #BA36A5;">xs</span> = solx[0][x].subs({a:-2, b:-3})
xs
</pre>
</div>

<p>
\[
\frac{1}{4} \, \sqrt{-16 \cdot 4^{\frac{1}{3}} + 80} + 1
\]
</p>

<p>
This can clearly be simplified to
</p>

<p>
\[
1+\sqrt{5-4^{1/ 3}}
\]
It certainly <i>looks</i> different from Cardan's result, but watch this:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #BA36A5;">xt</span> = QQbar(xs)
xt.radical_expression()
</pre>
</div>

<p>
\[
\frac{1}{2}4^{2/ 3}+4^{1/ 3}
\]
</p>

<p>
which is Cardan's result, only very slightly rewritten.  And finally:
</p>

<div class="org-src-container">
<pre class="src src-python">xt.minpoly()
</pre>
</div>

<p>
\[
x^3-6x-6
\]
</p>
</div>
</div>
</div>

<div id="outline-container-org6073aae" class="outline-3">
<h3 id="org6073aae"><span class="section-number-3">2.10</span> Colonial massacres, 1794 to 1928</h3>
<div class="outline-text-3" id="text-2-10">
<p>
The date January 26 is one of immense current debate in Australia.  Officially
it's the date of [Australia Day](<a href="https://en.wikipedia.org/wiki/Australia_Day">https://en.wikipedia.org/wiki/Australia_Day</a>),
which supposedly celebrates the founding of Australia.  To Aboriginal peoples it
is a day of deep mourning and sadness, as the date commemorates over two
centuries of oppression, bloodshed, and dispossession.  To them and their many
supporters, January 26 is [Invasion
Day](<a href="https://www.creativespirits.info/aboriginalculture/history/australia-day-invasion-day">https://www.creativespirits.info/aboriginalculture/history/australia-day-invasion-day</a>).
</p>

<p>
The date commemorates the landing in 1788 of [Arthur
Phillip](<a href="https://en.wikipedia.org/wiki/Arthur_Phillip">https://en.wikipedia.org/wiki/Arthur_Phillip</a>), in charge of the First
Fleet and the first Governor of the colony of New South Wales.
</p>

<p>
The trouble is that "Australia" means two things: the island continent, and the
country.  The country didn't exist until Federation on January 1, 1901; before
which time the land since 1788 was subdivided into independent colonies.  Many
people believe that Australia Day would be better moved to January 1; the
trouble with <i>that</i> is that it's already a public holiday, and apparently you
can't have a national day that doesn't have its own public holiday.  And [many other
dates](<a href="https://en.wikipedia.org/wiki/Australia_Day#Suggested_alternative_dates">https://en.wikipedia.org/wiki/Australia_Day#Suggested_alternative_dates</a>)
have been proposed.
</p>

<p>
My own preferred date is June 3; this is the date of the High Court "Mabo"
decision in 1992 which formally recognized native title and rejected the
doctrine of <i>terra nullius</i> under which the British invaded.
</p>

<p>
That the continent was invaded rather than settled is well established: all
serious historians take this view, and it can be backed up with legal arguments.
The Aboriginal peoples, numbering maybe close to a million in 1788, had mastered
the difficult continent and all of its many ecosystems, and had done so for
around 80,000 years.  Aboriginal culture is the oldest continually maintained
culture on the planet, and by an enormous margin.
</p>

<p>
Arthur Phillip did in fact arrive with [formal
instructions](<a href="https://www.foundingdocs.gov.au/resources/transcripts/nsw2_doc_1787.pdf">https://www.foundingdocs.gov.au/resources/transcripts/nsw2_doc_1787.pdf</a>)
to create "amity" with the "natives" and indeed to live in "kindness" with them,
but this soon went downhill.  Although Phillip himself seems to have been a man of
rare understanding for his time (when speared in the shoulder, for example, he
refused to let his soldiers retaliate), he was no match for the many convicts
and soldiers under his rule.  When he retired back to England in 1792 the colony
was ruled by a series of weak and ineffective governors, and in particular by
the military, culminating in the governorship of [Lachlan
Macquarie](<a href="https://en.wikipedia.org/wiki/Lachlan_Macquarie">https://en.wikipedia.org/wiki/Lachlan_Macquarie</a>) who is seen as a
mass murderer of Aboriginal peoples, although the [evidence is not
clear-cut](<a href="https://www.abc.net.au/news/2017-09-27/fact-check-did-lachlan-macquarie-commit-mass-murder-and-genocide/8981092">https://www.abc.net.au/news/2017-09-27/fact-check-did-lachlan-macquarie-commit-mass-murder-and-genocide/8981092</a>).
What <i>is</i> clear is that mass murders of Aboriginal peoples were common and
indiscriminate, and often with appalling cruelty.  On many occasions large
groups were poisoned with strychnine: this works by affecting the nerves which
control muscle movement, so that the body goes into agonizing spasms resulting
in death by asphyxiation.  Strychnine is considered by toxicologists to be one
of the most painful acting of all poisons.  Even though Macquarie himself
ordered retribution only after "resistance"; groups considered harmless, or
consisting only of old men, women and children, were brutally murdered.
</p>

<p>
People were routinely killed by gunfire, or by being hacked to death; there is
at least one report of a crying baby - the only survivor of a massacre - being
thrown onto the fire made to burn the victims.
</p>

<p>
Many more died of disease: smallpox and tuberculosis were responsible for deaths
of over 50% of Aboriginal peoples.  Their numbers today are thus tiny, and as in
the past they are still marginalized.  
</p>

<p>
Only recently has this harrowing part of Australia's past been formally researched;
the casual nature of the massacres meant that many were not recorded, and it has
taken a great deal of time and work to uncover their details.  This work has
been headed by [Professor Lyndall
Ryan](<a href="https://www.newcastle.edu.au/profile/lyndall-ryan">https://www.newcastle.edu.au/profile/lyndall-ryan</a>) at the University of
Newcastle.  The painstaking and careful work by her team has unearthed much
detail, and their results are available at their site [Colonial Frontier Massacres
in Central and Eastern Australia 1788-1930](<a href="https://c21ch.newcastle.edu.au/colonialmassacres/">https://c21ch.newcastle.edu.au/colonialmassacres/</a>)
</p>

<p>
As a January 26 exercise I decided to rework one of their maps, producing a
single map which would show the sites of massacres by markers whose size is
proportional to the number of people killed.  This turned out to be quite easy
using Python and its folium library, but naturally it took me a long time to get
it right.
</p>

<p>
I started by downloading the
[timeline](<a href="https://c21ch.newcastle.edu.au/colonialmassacres/timeline.php">https://c21ch.newcastle.edu.au/colonialmassacres/timeline.php</a>) from
the Newcastle site as a csv file, and going through each massacre adding its
location.  The project historians point out that the locations are deliberately
vague.  Sometimes this is because the vagueness of the historical record; but
also (from the [Introduction](<a href="https://c21ch.newcastle.edu.au/colonialmassacres/introduction.php">https://c21ch.newcastle.edu.au/colonialmassacres/introduction.php</a>)):
</p>

<blockquote>
<p>
In order to protect the sites from desecration, and respect for
the wishes of Aboriginal communities to observe the site as a place of mourning,
the points have been made purposefully imprecise by rounding coordinates to 3
digits, meaning the point is precise only to around 250m.
</p>
</blockquote>

<p>
Given the database, the Python commands were:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">import</span> folium
<span style="color: #0000FF;">import</span> pandas <span style="color: #0000FF;">as</span> pd

<span style="color: #BA36A5;">mass</span> = pd.read_csv(<span style="color: #008000;">'massacres.csv'</span>)

<span style="color: #BA36A5;">a</span> = folium.Map(location=[-27,134],width=1000, height=1000,tiles=<span style="color: #008000;">'OpenStreetMap'</span>,zoom_start=4.5)

<span style="color: #0000FF;">for</span> i <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">range</span>(0,<span style="color: #006FE0;">len</span>(mass)):
   <span style="color: #BA36A5;">number_killed</span> = mass.iloc[i][<span style="color: #008000;">'Estimated Aboriginal People Killed'</span>]
   folium.Circle(
      location=[<span style="color: #006FE0;">float</span>(mass.iloc[i][<span style="color: #008000;">'Lat'</span>]), <span style="color: #006FE0;">float</span>(mass.iloc[i][<span style="color: #008000;">'Long'</span>])],
      tooltip=mass.iloc[i][<span style="color: #008000;">'Location'</span>]+<span style="color: #008000;">': '</span>+<span style="color: #006FE0;">str</span>(number_killed),
      radius=<span style="color: #006FE0;">int</span>(number_killed)*150,
      color=<span style="color: #008000;">'goldenrod'</span>,
      fill=<span style="color: #D0372D;">True</span>,
      fill_color=<span style="color: #008000;">'gold'</span>
   ).add_to(a)

a.save(<span style="color: #008000;">"massacres.html"</span>)
</pre>
</div>

<p>
The result is shown below.  You can zoom in and out, and hovering over a massacre site
will produce the location and number of people murdered.
</p>

<p>
<b>The research is ongoing and this data is incomplete</b> 
</p>

<p>
&lt;iframe seamless src="/massacres.html" width="1000" height="1000"&gt;&lt;/iframe&gt; 
</p>

<p>
<b>The data was extracted from:</b> Ryan, Lyndall; Richards, Jonathan; Pascoe, William;
Debenham, Jennifer; Anders, Robert J; Brown, Mark; Smith, Robyn; Price, Daniel;
Newley, Jack Colonial Frontier Massacres in Eastern Australia 1788 – 1872, v2.0
Newcastle: University of Newcastle, 2017, <a href="http://hdl.handle.net/1959.13/1340762">http://hdl.handle.net/1959.13/1340762</a>
(accessed 08/02/2019). This project has been funded by the Australian Research
Council (ARC).
</p>


<p>
Note finally that Professor Ryan and team have defined a massacre to be a killing
of at least six people.  Thus we can assume there are many other killings of
five or less people which are not yet properly documented, or more likely shall
never been known.  A shameful history indeed.
</p>
</div>
</div>

<div id="outline-container-org202d32d" class="outline-3">
<h3 id="org202d32d"><span class="section-number-3">2.11</span> Vote counting in the Australian Senate</h3>
<div class="outline-text-3" id="text-2-11">
<p>
Recently we have seen senators behaving in ways that seem stupid, or contrary to
accepted public opinion.  And then people will start jumping up and down and
complaining that such a senator only got a tiny number of first preference votes.
[One commentator](<a href="https://www.news.com.au/national/politics/19-people-got-this-bloke-a-200k-job/news-story/f8d8aaa83f0c2bcab53626455a3698d6">https://www.news.com.au/national/politics/19-people-got-this-bloke-a-200k-job/news-story/f8d8aaa83f0c2bcab53626455a3698d6</a>) said that one senator, with 19 first preference votes, "couldn’t
muster more than 19 members of his extended family to vote for him".  This
displays an ignorance of how senate counting works.  In fact first preference
votes are almost completely irrelevant; or at least, far less relevant than they
are in the lower house.
</p>

<p>
Senate counting works on a proportional system, where multiple candidates are elected
from the same group of ballots.  This is different from the lower house (the
House of Representatives federally) where only one person is elected.  For the
lower house, first preference votes are indeed much more important.  As for the
lower house, senate voting is preferential: voters number their preferred
candidates starting with 1 for their most preferred, and so on (but see below).
</p>

<p>
A full explanation is given by the Australian Electoral Commission on their
[Senate Counting page](<a href="https://www.aec.gov.au/voting/counting/senate_count.htm">https://www.aec.gov.au/voting/counting/senate_count.htm</a>);
this blog post will run through a very simple example to demonstrate how a
senator can be elected with a tiny number of first preference votes.
</p>
</div>

<div id="outline-container-orgc8c1760" class="outline-4">
<h4 id="orgc8c1760"><span class="section-number-4">2.11.1</span> An aside on micro parties and voting</h4>
<div class="outline-text-4" id="text-2-11-1">
<p>
One problem in Australia is the proliferation of micro parties, many of which
hold racist, anti-immigration, or hard-line religious views, or who in some
other ways represent only a tiny minority of the electorate.  The problem is
just as bad at State level; in my own state of Victoria we have the Shooters,
Fishers and Farmers Party, the Aussie Battlers Party, and the Transport Matters
Party (who represent taxi drivers) to name but three.  This has the affect that
the number of candidates standing for senate election has become huge, and the
senate ballot papers absurdly unwieldy:
</p>


<div class="figure">
<p><img src="file:///777191-ballot-paper.jpg" alt="777191-ballot-paper.jpg" />
</p>
</div>

<p>
Initially the law required voters to number every box starting from 1: on a
large paper this would mean numbering carefully from 1 up to at least 96 in one recent
election.  To save this trouble (and most Australian voters are nothing if not
lazy), "above the line voting" was introduced.  This gave voters the option to put
just a single "1" in the box representing the party of choice: you will see from
the image above that the ballot paper is divided: the columns represent all the
parties; the boxes below the line represent all the candidates from that party,
and the single box above just the party name.  Here is a close up of a NSW
senate ballot:
</p>


<div class="figure">
<p><img src="file:///nsw_senate2.png" alt="nsw_senate2.png" />
</p>
</div>

<p>
Almost all voters willingly took advantage of that and voted above the line.
The trouble is then that voters have no control over where their preferences go:
that is handled by the parties themselves.  By law, all parties must make their
preferences available before the election, and they are published on the site of
the relevant Electoral Commission.  But the only people who carefully check this
site and the party's preferences are the sort of people who would carefully
number each box below the line anyway.  Most people don't care enough to be
bothered.
</p>

<p>
This enables all the micro-parties to make "preference deals"; in effect they act
as one large bloc, ensuring that at least some of them get a senate seat.  This
has been handled by a so-called ["preference whisperer"](<a href="https://en.wikipedia.org/wiki/Glenn_Druery">https://en.wikipedia.org/wiki/Glenn_Druery</a>).
</p>

<p>
The current system in the state of Victoria has been to encourage voting below
the line by allowing, instead of all boxes to be numbered, at least six.  And
there are strong calls for voting above the line to be abolished. 
</p>
</div>
</div>

<div id="outline-container-orga5c3355" class="outline-4">
<h4 id="orga5c3355"><span class="section-number-4">2.11.2</span> A simple example</h4>
<div class="outline-text-4" id="text-2-11-2">
<p>
To show how senate counting works, we suppose an electorate of 100 people, and
three senators to be elected from five candidates.  We also suppose that every
ballot paper has been numbered from 1 to 5 indicating each voter's preferences.  
</p>

<p>
Before the counting begins we need to determine the number of votes each
candidate must amass to be elected: this is chosen as the smallest number of
votes for which no more candidates can be elected.  If there are \(n\) formal
votes cast, and \(k\) senators to be elected, that number is clearly
</p>

<p>
\[\left\lfloor\frac{n}{k+1}\right\rfloor + 1.\]
</p>

<p>
This value is known as the <i>Droop quota</i>.  In our example, this quota is
</p>

<p>
\[
\left\lfloor\frac{100}{3+1}\right\rfloor +1 = 26.
\]
</p>

<p>
You can see that it is not possible for four candidates to obtain this value.
</p>

<p>
Suppose that the ballots are distributed as follows, where the numbers under the
candidates indicate the preferences cast:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-center" />

<col  class="org-center" />

<col  class="org-center" />

<col  class="org-center" />

<col  class="org-center" />

<col  class="org-center" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-center">Number of votes</th>
<th scope="col" class="org-center">A</th>
<th scope="col" class="org-center">B</th>
<th scope="col" class="org-center">C</th>
<th scope="col" class="org-center">D</th>
<th scope="col" class="org-center">E</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-center">20</td>
<td class="org-center">1</td>
<td class="org-center">2</td>
<td class="org-center">3</td>
<td class="org-center">4</td>
<td class="org-center">5</td>
</tr>

<tr>
<td class="org-center">20</td>
<td class="org-center">1</td>
<td class="org-center">5</td>
<td class="org-center">4</td>
<td class="org-center">3</td>
<td class="org-center">2</td>
</tr>

<tr>
<td class="org-center">40</td>
<td class="org-center">2</td>
<td class="org-center">1</td>
<td class="org-center">5</td>
<td class="org-center">4</td>
<td class="org-center">3</td>
</tr>

<tr>
<td class="org-center">5</td>
<td class="org-center">2</td>
<td class="org-center">3</td>
<td class="org-center">5</td>
<td class="org-center">1</td>
<td class="org-center">4</td>
</tr>

<tr>
<td class="org-center">4</td>
<td class="org-center">4</td>
<td class="org-center">3</td>
<td class="org-center">1</td>
<td class="org-center">2</td>
<td class="org-center">5</td>
</tr>

<tr>
<td class="org-center">1</td>
<td class="org-center">2</td>
<td class="org-center">3</td>
<td class="org-center">4</td>
<td class="org-center">5</td>
<td class="org-center">1</td>
</tr>
</tbody>
</table>

<p>
Counting first preferences produces:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-center" />

<col  class="org-center" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-center">Candidate</th>
<th scope="col" class="org-center">First Prefs</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-center">A</td>
<td class="org-center">40</td>
</tr>

<tr>
<td class="org-center">B</td>
<td class="org-center">40</td>
</tr>

<tr>
<td class="org-center">C</td>
<td class="org-center">4</td>
</tr>

<tr>
<td class="org-center">D</td>
<td class="org-center">5</td>
</tr>

<tr>
<td class="org-center">E</td>
<td class="org-center">1</td>
</tr>
</tbody>
</table>


<p>
The first step in the counting is to determine if any candidate has amassed
first preference votes equal to or greater than the Droop quota.  In the example
just given, both A and B have 40 first preferences each, so they are both
elected.
</p>

<p>
Since only 26 votes are needed for election, for each of A and B there are 14
votes remaining which can be passed on to other candidates according to the
voting preferences.  Which votes are passed on?  For B it doesn't matter, but
which votes do we deem surplus for A?  The Australian choice is to pass on <i>all</i>
votes, but at a reduced value known as the <i>transfer value</i>.  This value is
simply the fraction of surplus votes over total votes; in our case it is
</p>

<p>
\[\frac{14}{40}=0.35\]
</p>

<p>
for each of A and B. 
</p>

<p>
Looking at the first line of votes: the next highest preference from A to a
non-elected candidate is C, so C gets 0.35 of those 20 votes.  From the second
line, E gets 0.35 of those 20 votes.  From the third line, E gets 0.35 of all 40
votes. 
</p>

<p>
The votes now allocated to the remaining candidates are as follows:
</p>

<p>
C: \(4 + 0.35\times 20 = 11\)
</p>

<p>
D: 5
</p>

<p>
E: \(1 + 0.35\times 20 + 0.35\times 40 = 22\)
</p>

<p>
At this stage no candidate has amassed a quota, so the lowest ranked candidate
in the counting is eliminated - in this case D - and all of those votes are
passed on to the highest candidate (of those that are left, which is now only C
and E) in those preferences, which is E.  This produces:
</p>

<p>
C: 11
</p>

<p>
E: \(22 + 5 = 27\)
</p>

<p>
which means E has achieved the quota and thus is elected.
</p>

<p>
This is of course a very artificial example, but it shows two things:
</p>

<ol class="org-ol">
<li>How a candidate with a very small number of first preference votes can still
be elected: in this case E had the lowest number of first preference votes.</li>
<li>The importance of preferences.</li>
</ol>

<p>
So let's have no more complaining about the low number of first preference votes
in a senate count.  In a lower house count, sure, the candidate with the least
number of first preference votes is eliminated, but in a senate count such a
candidate might amass votes (or reduced values of votes) in such a way as to
achieve the quota.  
</p>
</div>
</div>
</div>

<div id="outline-container-orgac6b283" class="outline-3">
<h3 id="orgac6b283"><span class="section-number-3">2.12</span> Concert review: Lixsania and the Labyrinth</h3>
<div class="outline-text-3" id="text-2-12">
<p>
This evening I saw the [Australia Brandenburg
Orchestra](<a href="https://en.wikipedia.org/wiki/Australian_Brandenburg_Orchestra">https://en.wikipedia.org/wiki/Australian_Brandenburg_Orchestra</a>) with
guest soloist [Lixsania Fernandez](<a href="https://lixsania.wordpress.com">https://lixsania.wordpress.com</a>), a virtuoso
player of the [viola da gamba](<a href="https://en.wikipedia.org/wiki/Viol">https://en.wikipedia.org/wiki/Viol</a>), from Cuba.
(Although she studied, and now lives, in Spain.)  Lixsania is quite amazing:
tall, statuesque, quite absurdly beautiful, and plays with a technique that
encompasses the wildest of baroque extravagances as well as the most delicate
and refined tenderness.
</p>

<p>
The trouble with the viol, being a fairly soft instrument, is that it's not well
suited to a large concert hall.  This means that it's almost impossible to get
any sort of balance between it and the other instruments.  Violins, for example,
even if played softly, can overpower it.
</p>

<p>
[Thomas Mace](<a href="https://en.wikipedia.org/wiki/Thomas_Mace">https://en.wikipedia.org/wiki/Thomas_Mace</a>), in his "Musick's
Monument", published in 1676, complained vigorously about violins:
</p>


<div class="figure">
<p><img src="file:///mace_violins.png" alt="mace_violins.png" width="600" />
</p>
</div>

<p>
Mace has been described as a "conservative old git" which he certainly was, but
I do love the idea of this last hold-out against the "High-Priz'd Noise" of the
violin.  And I can see his point!
</p>

<p>
But back to Lixsania.  The concert started with a "pastiche" of La Folia, taking
in parts of Corelli's well known set for solo violin, Vivaldi's for two, Scarlatti
for harpsichord, and of course Marin Marais "32 couplets de Folies" from his
second book of viol pieces.  The Australian Brandenburgs have a nice line in
stagecraft, and this started with a dark stage with only Lixsania lit, playing
some wonderful arpeggiated figurations over all the strings, with a bowing of
utter perfection.  I was sitting side on to her position here, and I could
see with what ease she moved over the fingerboard - the mark of a true master of
their instrument - being totally at one with it.  Little by little other
instrumentalists crept in: a violinist here and there, Paul Dyer (leader of the
orchestra) to the harpsichord, cellists and a bassist, until there was a sizable
group on stage all playing madly.  I thought it was just wonderful.
</p>

<p>
For this first piece Lixsania was wearing a black outfit with long and full
skirts and sort of halter top which left her arms, sides and back bare.  This
meant I had an excellent view of her rib-cage, which was a first for me in a
concert.
</p>

<p>
The second piece was the 12th concerto, the so called "Harmonic Labyrinth" from
Locatelli's opus 3.  These concertos contain, in their first and last movements,
a wild "capriccio" for solo violin.  This twelfth concerto contains capricci of
such superhuman difficulty that even now, nearly 300 years after they were
composed, they still stand at the peak of virtuosity.  The Orchestra's
concertmaster, Shaun Lee-Chen, was however well up to the challenge, and powered
his way through both capricci with the audience hardly daring to breathe.  Even
though conventional concert behaviour does not include applause after individual
movements, so excited was the audience that there was an outburst of clapping
after the first movement.  And quite right too.
</p>

<p>
The final piece of the first half was a Vivaldi concerto for two violins and
cello, the cello part being taken by Lixsania on viol.  I felt this didn't come
across so well; the viol really couldn't be heard much, and you really do need
the strength of the cello to make much sense of the music.  However, it did give
Lixsania some more stage-time.  
</p>

<p>
After interval we were treated to a concerto for viol by [Johann Gottlieb
Graun](<a href="https://en.wikipedia.org/wiki/Johann_Gottlieb_Graun">https://en.wikipedia.org/wiki/Johann_Gottlieb_Graun</a>), a court composer to
Frederick the Great of Prussia.  Graun wrote five concertos for the instrument -
all monumentally difficult to play - which have been recorded several times.
However, a sixth one has recently been unearthed in manuscript - and apparently
we were hearing it for the first time in this concert series.  The softness of
the viol in the largeness of the hall meant that it was not always easy to hear:
I solved that by closing my eyes, so I could focus on the sound alone.  Lixsania
played, as you would imagine, as though she owned it, and its formidable
technical difficulties simply melted away under the total assurance of her
fingers.  She'd changed into a yellow outfit for this second half, and all the
male players were wearing yellow ties.
</p>

<p>
Then came a short Vivaldi sinfonia - a quite remarkable piece; very stately and
with shifting harmonies that gave it a surprisingly modern feel.  Just when you
think Vivaldi is mainly about pot-boilers, he gives you something like this.
Short, but superb.
</p>

<p>
Finally, the fourth movement of a concerto written in 2001 for two viols by
"Renato Duchiffre" (the pen name of René Schiffer, cellist and violist with
Apollo's Fire): a Tango.  Now my exposure to tangos has mainly been through that
arch-bore Astor Piazolla.  But <i>this</i> tango was magnificent.  The other violist
was Anthea Cottee, of whom I'd never heard, but she's no mean player.  She and
Lixsania made a fine pair, playing like demons, complementing each other and
happily grinning at some of the finer passages.  One of the many likeable
characteristics of Lixsania is that she seems to really enjoy playing, and smiles
a lot - I hate that convention of players who adopt a poker-face.  And she has a
great smile.
</p>

<p>
In fact the whole orchestra has a wonderful enjoyment about them, led by Paul
Dyer who displays a lovely dynamism at the harpsichord.  Not for him the
expressionless sitting still; he will leap up if given half an opportunity and
conduct a passage with whichever hand is free; sometimes he would play standing
and sort of conduct with his body; between him and Lixsania there was a
chemistry of heart and mind, both leaning towards each other, as if inspiring
each other to reach higher musical heights.  This was one of the most delightful
displays of communicative musicianship I've ever seen.  
</p>

<p>
Naturally there had to be an encore: and it was Lixsania singing a Cuban
lullaby, accompanying herself by plucking the viol - which was stood on a chair
for easier access - with Anthea Cottee providing a bowed accompaniment.
Lixsania told us (of course she speaks English fluently, with a charming Cuban
accent) that it was a lullaby of special significance, as it was the first song
she'd ever sang to her son.  There's no reason why instrumentalists should be
able to sing well, but in fact Lixsania has a lovely, rich, warm, <i>enveloping</i> sort
of voice, and the effect was breathtakingly lovely.  Lucky son!
</p>

<p>
This was a great concert.
</p>
</div>
</div>

<div id="outline-container-org7a89996" class="outline-3">
<h3 id="org7a89996"><span class="section-number-3">2.13</span> Linear programming in Python (2)</h3>
<div class="outline-text-3" id="text-2-13">
<p>
Here's an example of a transportation problem, with information given as a
table:
</p>

<style>.transport
table
{ width: 80%;
  table-layout: fixed;}
th, td
{ text-align: center;}
th
{ background: #DCDCDC;}
</style>

<div class="transport">
<table>
<tr>
<td colspan='2'></td>
<td colspan='5'><b>Demands</b></td>
</tr>
<tr>
<td colspan='2'></td>
<th>300</th>
<th>360</th>
<th>280</th>
<th>340</th>
<th>220</th>
</tr>
<tr>
<td></td> 
<th>750</th> 
<td>100</td>
<td>150</td>
<td>200</td>
<td>140</td>
<td>35</td>
</tr> 
<tr>
<td><b>Supplies&nbsp;</b></td> 
<th>400</th> 
<td>50</td>
<td>70</td>
<td>80</td>
<td>65</td>
<td>80</td>
</tr> 
<tr>
<td></t> 
<th>350</th> 
<td>40</td>
<td>90</td>
<td>100</td>
<td>150</td>
<td>130</td>
</tr> 
</table>
</div>

<p>
This is an example of a <i>balanced, non-degenerate</i> transportation problem.  It
is <i>balanced</i> since the sum of supplies equals the sum of demands, and it is
<i>non-degenerate</i> as there is no proper subset of supplies whose sum is equal to
that of a proper subset of demands.  That is, there are no balanced
"sub-problems".
</p>

<p>
In such a problem, the array values may be considered to be the costs of
transporting one object from a supplier to a demand.  (In the version of the
problem I pose to my students it's cars between distributors and car-yards; in
another version it's tubs of ice-cream between dairies and supermarkets.)  The
idea of course is to move all objects from supplies to demands while minimizing
the total cost.
</p>

<p>
This is a standard linear optimization problem, and it can be solved by any
method used to solve such problems, although generally specialized methods are
used.
</p>

<p>
But the intention here is to show how easily this problem can be managed using
myMathProg (and with numpy, for the simple use of printing an array):
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">import</span> pymprog <span style="color: #0000FF;">as</span> py
<span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np
py.begin(<span style="color: #008000;">'transport'</span>)
<span style="color: #BA36A5;">M</span> = <span style="color: #006FE0;">range</span>(3)  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">number of rows and columns</span>
<span style="color: #BA36A5;">N</span> = <span style="color: #006FE0;">range</span>(5)
<span style="color: #BA36A5;">A</span> = py.iprod(M,N) <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Cartesian product </span>
<span style="color: #BA36A5;">x</span> = py.var(<span style="color: #008000;">'x'</span>, A, kind=<span style="color: #006FE0;">int</span>) <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">all the decision variables are integers</span>
<span style="color: #BA36A5;">costs</span> = [[100,150,200,140,35],[50,70,80,65,80],[40,90,100,150,130]]
<span style="color: #BA36A5;">supplies</span> = [750,400,350]
<span style="color: #BA36A5;">demands</span> = [300,360,280,340,220]
py.minimize(<span style="color: #006FE0;">sum</span>(costs[i][j]*x[i,j] <span style="color: #0000FF;">for</span> i,j <span style="color: #0000FF;">in</span> A))
<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">the total sum in each row must equal the supplies</span>
<span style="color: #0000FF;">for</span> k <span style="color: #0000FF;">in</span> M: 
    <span style="color: #006FE0;">sum</span>(x[k,j] <span style="color: #0000FF;">for</span> j <span style="color: #0000FF;">in</span> N)==supplies[k] 
<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">the total sum in each column must equal the demands</span>
<span style="color: #0000FF;">for</span> k <span style="color: #0000FF;">in</span> N: 
    <span style="color: #006FE0;">sum</span>(x[i,k] <span style="color: #0000FF;">for</span> i <span style="color: #0000FF;">in</span> M)==demands[k]
py.solve()
<span style="color: #0000FF;">print</span>(<span style="color: #008000;">'\nMinimum cost: '</span>,py.vobj())
<span style="color: #BA36A5;">A</span> = np.array([[x[i,j].primal <span style="color: #0000FF;">for</span> j <span style="color: #0000FF;">in</span> N] <span style="color: #0000FF;">for</span> i <span style="color: #0000FF;">in</span> M])
<span style="color: #0000FF;">print</span>(<span style="color: #008000;">'\n'</span>)
<span style="color: #0000FF;">print</span>(A)
<span style="color: #0000FF;">print</span>(<span style="color: #008000;">'\n'</span>)
<span style="color: #8D8D84;">#</span><span style="color: #8D8D84; font-style: italic;">py.sensitivity()</span>
py.end()
</pre>
</div>

<p>
with solution:
</p>

<pre class="example">
GLPK Simplex Optimizer, v4.65
n8 rows, 15 columns, 30 non-zeros
      0: obj =   0.000000000e+00 inf =   3.000e+03 (8)
      7: obj =   1.789500000e+05 inf =   0.000e+00 (0)
*    12: obj =   1.311000000e+05 inf =   0.000e+00 (0)
OPTIMAL LP SOLUTION FOUND
GLPK Integer Optimizer, v4.65
8 rows, 15 columns, 30 non-zeros
15 integer variables, none of which are binary
Integer optimization begins...
Long-step dual simplex will be used
+    12: mip =     not found yet &gt;=              -inf        (1; 0)
+    12: &gt;&gt;&gt;&gt;&gt;   1.311000000e+05 &gt;=   1.311000000e+05   0.0% (1; 0)
+    12: mip =   1.311000000e+05 &gt;=     tree is empty   0.0% (0; 1)
INTEGER OPTIMAL SOLUTION FOUND

Minimum cost:  131100.0

[[  0. 190.   0. 340. 220.]
 [  0. 120. 280.   0.   0.]
 [300.  50.   0.   0.   0.]]
</pre>

<p>
As you see, the definition of the problem in Python is very straightforward. 
</p>
</div>
</div>

<div id="outline-container-orga2c52e6" class="outline-3">
<h3 id="orga2c52e6"><span class="section-number-3">2.14</span> Linear programming in Python</h3>
<div class="outline-text-3" id="text-2-14">
<p>
For my elementary linear programming subject, the students (who are all
pre-service teachers) use Excel and its Solver as the computational tool of
choice.  We do this for several reasons: Excel is software with which they're
likely to have had some experience, also it's used in schools; it also means we
don't have to spend time and mental energy getting to grips with new and
unfamiliar software.  And indeed the [mandated
curriculum](<a href="https://www.vcaa.vic.edu.au/Documents/vce/adviceforteachers/furthermaths/sample_learning_activity_graphs_relations.docx">https://www.vcaa.vic.edu.au/Documents/vce/adviceforteachers/furthermaths/sample_learning_activity_graphs_relations.docx</a>) 
includes computer exploration, using either [Excel
Solver](<a href="https://www.excel-easy.com/data-analysis/solver.html">https://www.excel-easy.com/data-analysis/solver.html</a>), 
or the Wolfram Alpha [Linear Programming
widget](<a href="http://www.wolframalpha.com/widgets/gallery/view.jsp?id=1e692c6f72587b2cbd3e7be018fd8960">http://www.wolframalpha.com/widgets/gallery/view.jsp?id=1e692c6f72587b2cbd3e7be018fd8960</a>).
</p>

<p>
This is all very well, but I balk at the reliance on commercial software, no
matter how widely used it may be.  And for my own exploration I've been looking
for an open-source equivalent.
</p>

<p>
In fact there are plenty of linear programming tools and libraries; two of the
most popular open-source ones are:
</p>

<ul class="org-ul">
<li>The GNU Linear Programming Kit, [GLPK](<a href="https://www.gnu.org/software/glpk/">https://www.gnu.org/software/glpk/</a>)</li>
<li>Coin-or Linear Programming, [Clp](<a href="https://projects.coin-or.org/Clp">https://projects.coin-or.org/Clp</a>)</li>
</ul>

<p>
There's a [huge list on
wikipedia](<a href="https://en.wikipedia.org/wiki/List_of_optimization_software">https://en.wikipedia.org/wiki/List_of_optimization_software</a>) which
includes open-source and proprietary software.
</p>

<p>
For pretty much any language you care to name, somebody has taken either GLPK or
Clp (or both) and produced a language API for it.  For Python there's
[PuLP](<a href="https://pythonhosted.org/PuLP/">https://pythonhosted.org/PuLP/</a>); for [Julia](<a href="https://julialang.org">https://julialang.org</a>) there's
[JuMP](<a href="http://www.juliaopt.org">http://www.juliaopt.org</a>); for Octave there's the `glpk` command, and so
on.  Most of the API's include methods of calling other solvers, if you have
them available.
</p>

<p>
However not all of these are well documented, and in particular some of them
don't allow sensitivity analysis: computing shadow prices, or ranges of the
objective coefficients.  I discovered that JuMP doesn't yet support this -
although to be fair sensitivity analysis does depend on the problem being
solved, and the solver being used.
</p>

<p>
Being a Python aficionado, I thought I'd check out some Python packages, of which
a list is given at an [operations research
page](<a href="https://wiki.python.org/moin/PythonForOperationsResearch">https://wiki.python.org/moin/PythonForOperationsResearch</a>).
</p>

<p>
However, I then discovered the Python package
[PyMathProg](<a href="http://pymprog.sourceforge.net">http://pymprog.sourceforge.net</a>) which for my purposes is perfect -
it just calls GLPK, but in a nicely "pythonic" manner, and the design of the
package suits me very well.
</p>
</div>

<div id="outline-container-orgb80b0c1" class="outline-4">
<h4 id="orgb80b0c1"><span class="section-number-4">2.14.1</span> A simple example</h4>
<div class="outline-text-4" id="text-2-14-1">
<p>
Here's a tiny two-dimensional problem I gave to my students:
</p>

<blockquote>
<p>
A furniture workshop produces chairs and tables.  Each day 30m<sup>2</sup> of wood board
is delivered to the workshop, of which chairs require 0.5m<sup>2</sup> and tables 1.5m<sup>2</sup>.
(We assume, of course, that all wood is used with no wastage.)  All furniture
needs to be laminated; there is only one machine available for 10 hours per day,
and chairs take 15 minutes each, tables 20 minutes.  If chairs are sold for $30 and
tables for $60, then maximize the daily profit (assuming that all are sold).
</p>
</blockquote>

<p>
Letting \(x\) be the number of chairs, and \(y\) be the number of tables, the problem
is to maximize
\[
30x+60y
\]
given
</p>

\begin{align*}
0.5x+1.5y&\le 30\\
15x+20y&\le 600\\
x,y&\ge 0
\end{align*}

<p>
Problems don't get much simpler than this.  In pyMathProg:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">import</span> pymathprog <span style="color: #0000FF;">as</span> pm
pm.begin(<span style="color: #008000;">'furniture'</span>)
<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">pm.verbose(True)</span>
<span style="color: #BA36A5;">x</span>, <span style="color: #BA36A5;">y</span> = pm.var(<span style="color: #008000;">'x, y'</span>) <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">variables</span>
pm.maximize(30 * x + 60 * y, <span style="color: #008000;">'profit'</span>)
0.5*x + 1.5*y &lt;= 30 <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">wood</span>
15*x + 20*y &lt;= 600 <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">laminate</span>
pm.solve()
<span style="color: #0000FF;">print</span>(<span style="color: #008000;">'\nMax profit:'</span>,pm.vobj())
pm.sensitivity()
pm.end()
</pre>
</div>

<p>
with output:
</p>

<pre class="example">
GLPK Simplex Optimizer, v4.65
2 rows, 2 columns, 4 non-zeros
*     0: obj =  -0.000000000e+00 inf =   0.000e+00 (2)
*     2: obj =   1.440000000e+03 inf =   0.000e+00 (0)
OPTIMAL LP SOLUTION FOUND

Max profit: 1440.0

PyMathProg 1.0 Sensitivity Report Created: 2018/10/28 Sun 21:42PM
================================================================================
Variable            Activity   Dual.Value     Obj.Coef   Range.From   Range.Till
--------------------------------------------------------------------------------
*x                        24            0           30           20           45
*y                        12            0           60           40           90
================================================================================
================================================================================
Constraint       Activity Dual.Value  Lower.Bnd  Upper.Bnd RangeLower RangeUpper
--------------------------------------------------------------------------------
 R1                    30         24       -inf         30         20         45
 R2                   600        1.2       -inf        600        400        900
================================================================================
</pre>

<p>
From that output, we see that the required maximum is $1440, obtained by making
24 chairs and 12 tables.  We also see that the shadow prices for the constraints
are 24 and 1.2.  Furthermore, the ranges of objective coefficients which will
not affect the results are \([20,45]\) for prices for chairs, and \([40,90]\) for
table prices.
</p>

<p>
This is the simplest API I've found so far which provides that sensitivity
analysis.
</p>

<p>
Note that if we just want a solution, we can use the <code>linprog</code> command from
<code>scipy</code>:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">from</span> scipy.optimize <span style="color: #0000FF;">import</span> linprog
linprog([-30,-60],A_ub=[[0.5,1.5],[15,20]],b_ub=[30,600])
</pre>
</div>

<p>
<code>linprog</code> automatically minimizes a function, so to maximize we use a negative
function.  The output is
</p>

<pre class="example">
    fun: -1440.0
message: 'Optimization terminated successfully.'
    nit: 2
  slack: array([0., 0.])
 status: 0
success: True
      x: array([24., 12.])
</pre>

<p>
The negative value given as <code>fun</code> above simply reflects that we are entering a
negative function.  In respect of our problem, we simply negate that value to
obtain the required maximum of 1440.
</p>
</div>
</div>
</div>

<div id="outline-container-org93c26e2" class="outline-3">
<h3 id="org93c26e2"><span class="section-number-3">2.15</span> A test of OpenJSCAD</h3>
<div class="outline-text-3" id="text-2-15">
<p>
Here's an example of a coloured tetrahedron:
</p>

<script>
<head>
  <link rel="stylesheet" href="css/min.css" type="text/css">
</head>

<body>
  <script src="js/openjscad/min.js"></script>
<!-- setup display of the errors as required by OpenJSCAD.js -->
  <div class="jscad-container">
    <div id="header">
      <div id="errordiv">hello</div>
    </div>

<!-- setup display of the viewer, i.e. canvas -->
    <div oncontextmenu="return false;" 
         id="viewerContext" 
         style = "width:640px;height:470px;"
         design-url="/tetrahedron.jscad"></div>

<!-- setup display of the status, as required by OpenJSCAD.js -->
<!-- set display: block to display this -->
    <div id="tail" style="display: none;">
      <div id="statusdiv"></div>
    </div>
  </div>
</body>
</script>
</div>
</div>

<div id="outline-container-org9ea8bab" class="outline-3">
<h3 id="org9ea8bab"><span class="section-number-3">2.16</span> The power of two irrational numbers being rational</h3>
<div class="outline-text-3" id="text-2-16">
<p>
There's a celebrated elementary result which claims that:
</p>
<blockquote>
<p>
There are irrational numbers \(x\) and \(y\) for which \(x^y\) is rational.
</p>
</blockquote>
<p>
The standard proof goes like this.  Now, we know that \(\sqrt{2}\) is irrational,
so let's consider \(r=\sqrt{2}^\sqrt{2}\).  Either \(r\) is rational, or it is not.
If it is rational, then we set \(x=\sqrt{2}\), \(y=\sqrt{2}\) and we are done.  If
\(r\) is <i>irrational</i>, then set \(x=r\) and \(y=\sqrt{2}\).  This means that 
\[
x^y=\left(\sqrt{2}^\sqrt{2}\right)^{\sqrt{2}}=\sqrt{2}^2=2 
\] 
which is rational.
</p>

<p>
This is a perfectly acceptable proof, but highly non-constructive,  And for some
people, the fact that the proof gives no information about the irrationality of
\(\sqrt{2}^\sqrt{2}\) is a fault.
</p>

<p>
So here's a lovely <i>constructive</i> proof I found on [reddit](<a href="https://www.reddit.com/r/math/comments/9i8lvl/classic/e6hnape">https://www.reddit.com/r/math/comments/9i8lvl/classic/e6hnape</a>) .  Set \(x=\sqrt{2}\) and
\(y=2\log_2{3}\).  The fact that \(y\) is irrational follows from the fact that if
\(y=p/q\) with \(p\) and \(q\) integers, then \(2\log_2{3}=p/q\) so that \(2^{p/2q}=3\), or
\(2^p=3^{2q}\) which contradicts the fundamental theorem of arithmetic.  Then:
</p>

\begin{eqnarray*}
x^y&=&\sqrt{2}^{2\log_2{3}}\\
&=&2^{\log_2{3}}\\
&=&3.
\end{eqnarray*}
</div>
</div>

<div id="outline-container-orgbe6a74d" class="outline-3">
<h3 id="orgbe6a74d"><span class="section-number-3">2.17</span> Wrestling with Docker</h3>
<div class="outline-text-3" id="text-2-17">
<p>
For years I have been running a blog and other web apps on a VPS running Ubuntu
14.04 and Apache - a standard
[LAMP](<a href="https://en.wikipedia.org/wiki/LAMP_(software_bundle)">https://en.wikipedia.org/wiki/LAMP_(software_bundle)</a>) system.  However,
after experimenting with some apps - temporarily installing them and testing
them, only to discard them, the system was becoming a total mess.  Worst of all,
various MySQL files were ballooning out in size: the <code>ibdata1</code> file in
<code>/var/lib/mysql</code> was coming in at a whopping 37Gb (39568015360 bytes to be more accurate).
</p>

<p>
Now, there are ways of dealing with this, but I don't want to have to become an
expert in MySQL; all I wanted to do was to recover my system and make it more
manageable.
</p>

<p>
I decided to use [Docker](www.docker.com).  This is a "container system" where
each app runs in its own container - a sort of mini system which contains all
the files required to serve it up to the web.  This clearly requires a certain
amount of repetition between containers, but that's the price to be paid for
independence.  The idea is that you can start or stop any container without
affecting any of the others.  For web apps many containers are based on [Alpine
Linux](<a href="https://alpinelinux.org">https://alpinelinux.org</a>) which is a system designed to be as tiny as
possible, along with the [nginx](<a href="https://www.nginx.com">https://www.nginx.com</a>) web server.
</p>

<p>
There seems to be a sizable ecosystem of tools to help manage and deploy
docker containers.  Given my starting position of knowing nothing, I wanted to
keep my extra tools to a minimum; I went with just two over and above docker
itself: [docker-compose](<a href="https://docs.docker.com/compose/">https://docs.docker.com/compose/</a>), which helps design, configure, and run docker
containers, and [traefik](<a href="https://traefik.io">https://traefik.io</a>), a reverse proxy, which handles all requests from the
outside world to docker containers - thus managing things like ports - as well
as interfacing with the certificate authority [Lets
Encrypt](<a href="https://letsencrypt.org">https://letsencrypt.org</a>).
</p>

<p>
My hope was that I should be able to get these all set up so they would work as
happily together as they were supposed to do.  And so indeed it has turned out,
although it took many days of fiddling, and innumerable questions to forums and
web sites (such as reddit) to make it work.
</p>

<p>
So here's my traefik configuration:
</p>

<div class="org-src-container">
<pre class="src src-toml">defaultEntryPoints = ["http", "https"]

[web]
address = ":8080"
  [web.auth.basic]
  users = ["admin:$apr1$v7kJtvT7$h0F7kxt.lAzFH4sZ8Z9ik."]

[entryPoints]
  [entryPoints.http]
  address = ":80"
    [entryPoints.http.redirect]
      entryPoint = "https"
  [entryPoints.https]
  address = ":443"
    [entryPoints.https.tls]

[traefikLog]
  filePath="./traefik.log"
  format = "json"


# Below here comes from
#   www.smarthomebeginner.com/traefik-reverse-proxy-tutorial-for-docker/
# with values adjusted for local use, of course

# Let's encrypt configuration
[acme]
email="amca01@gmail.com"
storage="./acme.json"
acmeLogging=true 
onHostRule = true
entryPoint = "https"
  # Use a HTTP-01 acme challenge rather than TLS-SNI-01 challenge
  [acme.httpChallenge]
  entryPoint = "http"

[[acme.domains]]
  main = "numbersandshapes.net"
  sans = ["monitor.numbersandshapes.net", "adminer.numbersandshapes.net", "portainer.numbersandshapes.net", "kanboard.numbersandshapes.net", "webwork.numbersandshapes.net",
 "blog.numbersandshapes.net"]

# Connection to docker host system (docker.sock)
[docker]
endpoint = "unix:///var/run/docker.sock"
domain = "numbersandshapes.net"
watch = true
# This will hide all docker containers that don't have explicitly set label to "enable"
exposedbydefault = false
</pre>
</div>

<p>
and (part of) my docker-compose configuration, the file <code>docker-compose.yml</code>:
</p>
<div class="org-src-container">
<pre class="src src-yml">version: "3"

networks:
  proxy:
    external: true
  internal:
    external: false

services:

  traefik:
    image: traefik:1.6.0-alpine
    container_name: traefik
    restart: always
    command: --web --docker --logLevel=DEBUG
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - $PWD/traefik.toml:/traefik.toml
      - $PWD/acme.json:/acme.json
    networks:
      - proxy
    ports:
      - "80:80"
      - "443:443"
    labels:
      - traefik.enable=true
      - traefik.backend=traefik
      - traefik.frontend.rule=Host:monitor.numbersandshapes.net
      - traefik.port=8080
      - traefik.docker.network=proxy

  blog:
    image: blog
    volumes:
      - /home/amca/docker/whats_this/public:/usr/share/nginx/html
    networks:
      - internal
      - proxy
    labels:
      - traefik.enable=true
      - traefik.backend=blog
      - traefik.docker.network=proxy      
      - traefik.port=80
      - traefik.frontend.rule=Host:blog.numbersandshapes.net
</pre>
</div>
<p>
The way this works, at least in respect of this blog, is that files copied into
the directory <code>/home/amca/docker/whats_this/public</code> on my VPS will be
automatically served by nginx.  So all I now need is a command on my local
system (on which I do all my blog writing), which serves up these files.  I've
called it <code>docker-deploy</code>:
</p>

<pre class="example">
hugo -b "https://blog.numbersandshapes.net/" -t "blackburn" &amp;&amp; rsync -avz -e "ssh" --delete public/ amca@numbersandshapes.net:~/docker/whats_this/public
</pre>
<p>
Remarkably enough, it all works!
</p>

<p>
One issue I had at the beginning was that my original blog was served up at the
URL <code>https://numberdsandshapes.net/blog</code> and for some reason these links were
still appearing in my new blog.  It turned out (after a lot of anguished
messages) that it was my mis-handling of <code>rsync</code>.  I just ended up deleting
everything except for the blog source files, and re-created everything from scratch.
</p>
</div>
</div>

<div id="outline-container-orgdd16fab" class="outline-3">
<h3 id="orgdd16fab"><span class="section-number-3">2.18</span> Householder's methods&#xa0;&#xa0;&#xa0;<span class="tag"><span class="mathematics">mathematics</span>&#xa0;<span class="algebra">algebra</span></span></h3>
<div class="outline-text-3" id="text-2-18">
<p>
These are a class of root-finding methods; that is, for the numerical solution
of a single nonlinear equation,
developed by [Alston Scott
Householder](<a href="https://en.wikipedia.org/wiki/Alston_Scott_Householder">https://en.wikipedia.org/wiki/Alston_Scott_Householder</a>)
in 1970. They may be considered a generalisation of the well known [Newton-Raphson
method](<a href="https://en.wikipedia.org/wiki/Newton's_method">https://en.wikipedia.org/wiki/Newton's_method</a>) (also known more simply
as <i>Newton's method</i>) defined by
</p>

<p>
\[
x\leftarrow x-\frac{f(x)}{f'(x)}.
\]
</p>

<p>
where the equation to be solved is \(f(x)=0\).
</p>

<p>
From a starting value \(x_0\) a sequence of iterates can be generated by
</p>

<p>
\[
x_{n+1}=x_n-\frac{f(x_n)}{f'(x_n)}.
\]
</p>

<p>
As is well known, Newton's method exhibits <i>quadratic convergence</i>; that is, if
the sequence of iterates converges to a root value \(r\), then the
limit
</p>

<p>
\[
\lim_{n\to\infty}\frac{x_{n+1}-r}{(x_n-r)^2}
\]
</p>

<p>
is finite.  This means, in effect, that the number of correct decimal places
doubles at each step.  Householder's method for a rate of convergence \(d+1\) is
defined by
</p>

<p>
\[
x\leftarrow x-d\frac{(1/f)^{(d-1)}(x)}{(1/f)^{(d)}(x)}.
\]
</p>

<p>
We show how this definition can be rewritten in terms of ratios of derivatives,
by using Python and its symbolic toolbox [SymPy](<a href="https://www.sympy.org/en/index.html">https://www.sympy.org/en/index.html</a>).
</p>

<p>
We start by defining some variables and functions.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">from</span> sympy <span style="color: #0000FF;">import</span> *
<span style="color: #BA36A5;">x</span> = Symbol(<span style="color: #008000;">'x'</span>)
<span style="color: #BA36A5;">f</span> = Function(<span style="color: #008000;">'f'</span>)(x)
</pre>
</div>

<p>
Now we can define the first Householder formula, with \(d=1\):
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #BA36A5;">d</span> = 1
<span style="color: #BA36A5;">H1</span> = x + d*diff(1/f,x,d-1)/diff(1/f,x,d)
H1
</pre>
</div>

<p>
\[
x-\frac{f(x)}{\frac{d}{dx}f(x)}
\]
</p>

<p>
which is Newton's formula.  Now for \(d=2\):
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #BA36A5;">d</span> = 2
<span style="color: #BA36A5;">H2</span> = x + d*diff(1/f,x,d-1)/diff(1/f,x,d)
H2
</pre>
</div>

<p>
\[
x - \frac{2 \frac{d}{d x} f{\left (x \right )}}{- \frac{d^{2}}{d x^{2}}  f{\left (x \right )} + \frac{2 \left(\frac{d}{d x} f{\left (x \right )}\right)^{2}}{f{\left (x \right )}}}
\]
</p>

<p>
This is a mighty messy formula, but it can be greatly simplified by using ratios
of derivatives defined by
</p>

<p>
\[
r_k=\frac{f^{(d-1}(x)}{f^{(d)}(x)}
\]
This means that
\[
r_1=\frac{f}{f'},\quad r_2=\frac{f'}{f^{\prime\prime}}
\]
To make the substitution into the current expression above, we can use the
substitutions
\[
f^{\prime\prime}=f'/r_2,\quad f'=f/r_1
\]
to be done sequentially (first defining the new symbols)
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #BA36A5;">r_1</span>,<span style="color: #BA36A5;">r_2</span>,<span style="color: #BA36A5;">r_3</span> = symbols(<span style="color: #008000;">'r_1,r_2,r_3'</span>)
<span style="color: #BA36A5;">H2r</span> = H2s.subs([(Derivative(f,x,2), Derivative(f,x)/r_2), (Derivative(f,x), f/r_1)]).simplify()
H2r
</pre>
</div>
<p>
\[
-\frac{2r_1r_1}{r_1-2r_2}
\]
Dividing the top and bottom by \(2r_2\) produces the formulation
\[
\frac{r_1}{1-\displaystyle{\frac{r_1}{2r_2}}}
\]
and so Householder's method for \(d=2\) is defined by the recurrence
\[
x\leftarrow x-\frac{r_1}{1-\displaystyle{\frac{r_1}{2r_2}}}.
\]
This is known as [Halley's
method](<a href="https://en.wikipedia.org/wiki/Halley's_method">https://en.wikipedia.org/wiki/Halley's_method</a>), after [Edmond
Halley](<a href="https://en.wikipedia.org/wiki/Edmond_Halley">https://en.wikipedia.org/wiki/Edmond_Halley</a>), also known for his comet.
This method has been called the most often rediscovered iteration formula in the
literature.
</p>

<p>
It would exhibit <i>cubic convergence</i>, which means that the number of correct
figures roughly triples at each step.
</p>

<p>
Apply the same sequence of steps for \(d=3\), and including the substitution
\[
f^{\prime\prime\prime} = f^{\prime\prime}/r_3
\]
produces the fourth order formula
\[
x\leftarrow x-\frac{3 r_{1} r_{3} \left(2r_{2} - r_{1}\right)}{r_{1}^{2} - 6 r_{1} r_{3} + 6 r_{2} r_{3}}
\]
</p>
</div>

<div id="outline-container-orgcd789b3" class="outline-4">
<h4 id="orgcd789b3"><span class="section-number-4">2.18.1</span> A test</h4>
<div class="outline-text-4" id="text-2-18-1">
<p>
We'll use the equation
\[
x^5+x-1=0
\]
which has a root close to \(0.7\).  First Newton's method, which is the
Householder method of order \(d=1\), and we start by defining the symbol \(x\) and
the function \(f\):
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #BA36A5;">x</span> = Symbol(<span style="color: #008000;">'x'</span>)
<span style="color: #BA36A5;">f</span> = x**5+x-1
</pre>
</div>

<p>
Next define the iteration of Newton's method, which can be turned into a function with the handy tool
<code>lambdify</code>:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #BA36A5;">nr</span> = lambdify(x, x - f/diff(f,x))
</pre>
</div>

<p>
Now, a few iterations, and print them as strings:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #BA36A5;">y</span> = 0.7
<span style="color: #BA36A5;">ys</span> = [y]
<span style="color: #0000FF;">for</span> i <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">range</span>(10):
    <span style="color: #BA36A5;">y</span> = N(nr(y),100)
    <span style="color: #BA36A5;">ys</span> += [y]

<span style="color: #0000FF;">for</span> i <span style="color: #0000FF;">in</span> ys:
    <span style="color: #0000FF;">print</span>(<span style="color: #006FE0;">str</span>(i))

0.7
0.7599545557827765973613054484303575009107589721679687500000000000000000000000000000000000000000000000
0.7549197891599746887794253559985793967456078439525201893202319456623650882121929457935763902468565963
0.7548776691557956141971506438033504033307707534709697222674827264390889507161368160254597915269779252
0.7548776662466927739251146002523856449587324643131536407777773148939177229546284200355119465808326870
0.7548776662466927600495088963585290075677963335246916447723036615900830138144428153523526591809355834
0.7548776662466927600495088963585286918946066177727931439892839706462440390043279509776806970677946058
0.7548776662466927600495088963585286918946066177727931439892839706460806551280810907382270928422503037
0.7548776662466927600495088963585286918946066177727931439892839706460806551280810907382270928422503037
0.7548776662466927600495088963585286918946066177727931439892839706460806551280810907382270928422503037
0.7548776662466927600495088963585286918946066177727931439892839706460806551280810907382270928422503037
</pre>
</div>
<p>
We can easily compute the number of correct decimal places each time by simply
finding the first place in each string where it differs from the previous one:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">for</span> i <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">range</span>(1,7):
    <span style="color: #BA36A5;">d</span> = [ys[i][j] == ys[i+1][j] <span style="color: #0000FF;">for</span> j <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">range</span>(102)]
    <span style="color: #0000FF;">print</span>(d.index(<span style="color: #D0372D;">False</span>)-2)
</pre>
</div>

\begin{array}{r}
2\cr 
3\cr 
8\cr 
16\cr 
32\cr 
66
\end{array}

<p>
and we see a remarkable closeness with doubling of the number of correct values
each iteration.
</p>

<p>
Now, the fourth order method, with \(d=3\):
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #BA36A5;">r1</span> = lambdify(x,g(x)/diff(g(x),x))
<span style="color: #BA36A5;">r2</span> = lambdify(x,diff(g(x),x)/diff(g(x),x,2))
<span style="color: #BA36A5;">r3</span> = lambdify(x,diff(g(x),x,2)/diff(g(x),x,3))
<span style="color: #BA36A5;">h3</span> = lambdify(x,x-3*r1(x)*r3(x)*(2*r2(x)-r1(x))/(r1(x)**2-6*r1(x)*r3(x)+6*r2(x)*r3(x)))
</pre>
</div>

<p>
Now we basically copy down the above commands, except that we'll use 1500 decimal
places instead of 100:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #BA36A5;">y</span> = 0.7
<span style="color: #BA36A5;">ys</span> = [<span style="color: #006FE0;">str</span>(x)]
<span style="color: #0000FF;">for</span> i <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">range</span>(10):
    <span style="color: #BA36A5;">y</span> = N(h3(x),1500)
    <span style="color: #BA36A5;">ys</span> += [<span style="color: #006FE0;">str</span>(y)]

<span style="color: #0000FF;">for</span> i <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">range</span>(1,6):
    <span style="color: #BA36A5;">d</span> = [xs[i][j] == xs[i+1][j] <span style="color: #0000FF;">for</span> j <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">range</span>(1502)]
    <span style="color: #0000FF;">print</span>(d.index(<span style="color: #D0372D;">False</span>)-2)
</pre>
</div>

\begin{array}{r}
4\\
19\\
76\\
308\\
1233
\end{array}

<p>
and we that the number of correct decimal places at each step is indeed
increased by a factor very close to 4.
</p>
</div>
</div>
</div>

<div id="outline-container-orgf76c232" class="outline-3">
<h3 id="orgf76c232"><span class="section-number-3">2.19</span> The Joukowsky Transform&#xa0;&#xa0;&#xa0;<span class="tag"><span class="mathematics">mathematics</span>&#xa0;<span class="geometry">geometry</span>&#xa0;<span class="jsxgraph">jsxgraph</span></span></h3>
<div class="outline-text-3" id="text-2-19">
<p>
The [Joukowksy Transform](<a href="https://en.wikipedia.org/wiki/Joukowsky_transform">https://en.wikipedia.org/wiki/Joukowsky_transform</a>) is
an elegant and simple way to create an airfoil shape.  
</p>

<p>
Let \(C\) be a circle in the complex plane that passes through the point \(z=1\) and
encompasses the point \(z=-1\).  The transform is defined as
</p>

<p>
\[
\zeta=z+\frac{1}{z}.
\]
</p>

<p>
We can explore the transform by looking at the circles centred at \((-r,0)\) with
\(r<0\) and with radius \(1+r\):
</p>

<p>
\[
\|z-r\|=1+r
\]
</p>

<p>
or in cartesian coordinates with parameter \(t\):
</p>

\begin{align*}
x &= -r+(1+r)\cos(t)\\
y &= (1+r)\sin(t)
\end{align*}
<p>
so that
\[
(x,y)\rightarrow \left(x+\frac{x}{x^2+y^2},y-\frac{y}{x^2+y^2}\right).
\]
</p>

<p>
To see this in action, move the point \(P\) in this diagram about, ensuring that
the point \((-1,0)\) always remains within the circle:
</p>

<div id="box" class="jxgbox" style="width:750px; height:600px;">
<script type="text/javascript">
 var board = JXG.JSXGraph.initBoard('box', {boundingbox: [-3, 2.4, 1.6, -2], 
                                            axis:true,
                                            keepAspectRatio:true});
 var p1 = board.create('point', [-1, 0], {size: 4,name: 'P'});
 var midpt = board.create('point', [function(){ return (p1.X()+1)/2.0; }, 
                                    function(){ return p1.Y()/2.0; }], {name:'',size: 0});
 var c = board.create('circle',[midpt, p1]);
 function fx(s) {
  return midpt.X()+c.Radius()*Math.cos(s);
 }
 function fy(s) {
  return midpt.Y()+c.Radius()*Math.sin(s);
 }
 function gx(t) {
  return fx(t)+fx(t)/(fx(t)*fx(t)+fy(t)*fy(t));
 }
 function gy(t) {
       return fy(t)-fy(t)/(fx(t)*fx(t)+fy(t)*fy(t));
      }
 var foil = board.create('curve',[function(phi){return gx(phi);},
                                  function(phi){return gy(phi);}, 
                                  0, 2*Math.PI], 
                                  {strokeColor: 'green',strokeWidth: 4,name:''});
</script>
</div>
</div>
</div>

<div id="outline-container-org427650f" class="outline-3">
<h3 id="org427650f"><span class="section-number-3">2.20</span> Double Damask</h3>
<div class="outline-text-3" id="text-2-20">
<p>
This was a comedy sketch initially performed in the revue ["Clowns in
Clover"](<a href="http://www.guidetomusicaltheatre.com/shows_c/clownsclover.htm">http://www.guidetomusicaltheatre.com/shows_c/clownsclover.htm</a>) which
had its first performance at the Adelphi Theatre in London on December 1, 1927.
This particular sketch was written by [Dion
Titheradge](<a href="http://en.wikipedia.org/wiki/Dion_Titheradge">http://en.wikipedia.org/wiki/Dion_Titheradge</a>) and starred the
inimitable [Cicely
Courtneidge](<a href="https://en.wikipedia.org/wiki/Cicely_Courtneidge">https://en.wikipedia.org/wiki/Cicely_Courtneidge</a>) as the annoyed
customer Mrs Spooner.  It has been recorded and is available on many different
collections; you can also hear it on
[youtube](<a href="https://www.youtube.com/watch?v=0P8XSUGSR-c">https://www.youtube.com/watch?v=0P8XSUGSR-c</a>).
</p>

<p>
I have loved this sketch since I first heard it as a teenager on a three record
collection called something like "Masters of Comedy", being a collection of
classic sketches.  Double Damask has also been performed by Beatrice Lillie, and
you can search for this also on youtube.  For example,
[here](<a href="https://www.youtube.com/watch?v=GiRyqDfNxqU">https://www.youtube.com/watch?v=GiRyqDfNxqU</a>).  I hope admirers of the
excellent Ms Lillie will not be upset by my saying I far prefer Cicely
Courtneidge, whose superb diction and impeccable comic timing are beyond
reproach.
</p>

<p>
No doubt the original script is available somewhere, but in the annoying way of
the internet, I couldn't find it.  So here is my transcription of the
Courtneidge version of "Double Damask".
</p>

<p>
&#x2014;
</p>

<p>
<b>Double Damask</b>
</p>

<p>
written by
</p>

<p>
Dion Titheradge
</p>

<p>
<i>Characters:</i>\
A customer, Mrs Spooner\
A shop assistant (unnamed)\
A manager, Mr Peters
</p>

<p>
<i>Scene:</i> The linen department of a large store.
</p>

<p>
MRS SPOONER: I wonder if you could tell me if my order has gone off yet?
</p>

<p>
ASSISTANT: Not knowing your order, madam, I really couldn't say.
</p>

<p>
MRS SPOONER: But I was in here an hour ago and gave it to you.
</p>

<p>
ASSISTANT: What name, madam?
</p>

<p>
MRS SPOONER: Spooner, Mrs Spooner,
</p>

<p>
ASSISTANT: Have you an address?
</p>

<p>
MRS SPOONER: Do I look as if I live in the open air? I gave a large order for
sheets and tablecloths, to be sent to Bacon Villa, Egham.  (pronounced "Eg'm")
</p>

<p>
ASSISTANT: Eg'm?
</p>

<p>
MRS SPOONER: I hope I speak plainly: Egg Ham!
</p>

<p>
ASSISTANT: Oh yes, yes I remember perfectly now, Madam.  Let me see now&#x2026; no,
your order won't go through until tomorrow morning.  Is there anything further?
</p>

<p>
MRS SPOONER: Yes, (very quickly) I want two dozen double damask dinner napkins.
</p>

<p>
ASSISTANT: I beg your pardon?
</p>

<p>
MRS SPOONER (as quicky as before): I said two dozen double damask dinner napkins.
</p>

<p>
ASSISTANT: I'm sorry madam, I don't quite catch -
</p>

<p>
MRS SPOONER: Dinner napkins, man! Dinner napkins!
</p>

<p>
ASSISTANT: Of course madam.  Plain?
</p>

<p>
MRS SPOONER: Not plain, double damask.
</p>

<p>
ASSISTANT: Yes&#x2026; would you mind repeating your order Madam? I'm not quite sure.
</p>

<p>
MRS SPOONER: I want two dozen dammle dubbuck; I want two dammle dubb&#x2026; oh dear,
stupid of me!  I want two dozen dammle dizzick danner nipkins.
</p>

<p>
ASSISTANT: Danner nipkins Madam?
</p>

<p>
MRS SPOONER: Yes.
</p>

<p>
ASSISTANT: You mean dinner napkins.
</p>

<p>
MRS SPOONER: That's what I said.
</p>

<p>
ASSISTANT: No, pardon me, Madam, you said danner nipkins!
</p>

<p>
MRS SPOONER: Don't be ridiculous!  I said dinner napkins, and I meant danner
nipkins.  Nipper dank&#x2026;you know you're getting me muddled now.
</p>

<p>
ASSISTANT: I'm sorry Madam.  You want danner nipkins, exactly.  How many?
</p>

<p>
MRS SPOONER: Two duzzle.
</p>

<p>
ASSISTANT: Madam?
</p>

<p>
MRS SPOONER: Oh, gracious, young man - can't you get it right?  I want two dubbin duzzle
damask dinner napkins.
</p>

<p>
ASSISTANT: Oh no, Madam, not two dubbin - you mean two dozen!
</p>

<p>
MRS SPOONER: I said two dozen!  Only they must be dammle duzzick!
</p>

<p>
ASSISTANT: No, we haven't any of that in stock, Madam.
</p>

<p>
MRS SPOONER (in a tone of complete exasperation): Oh dear, of all the fools!
Can't I find anybody, just anybody with a modicum of intelligence in this store?
</p>

<p>
ASSISTANT: Well, here is our Mr Peters, Madam. Now perhaps if you ask him he might-
</p>

<p>
MR PETERS (In an authoritative "we can fix anything" kind of voice): Can I be of
any assistance to you, Madam?
</p>

<p>
MRS SPOONER: I'm sorry to say that your assistant doesn't appear to speak
English.  I'm giving an order, but it might just as well be in Esperanto for all
he understands.
</p>

<p>
MR PETERS: Allow me to help you Madam.  You require?
</p>

<p>
MRS SPOONER: I require (as quickly as before) two dozen double damask dinner napkins.
</p>

<p>
MR PETERS: I beg pardon, Madam?
</p>

<p>
MRS SPOONER: Oh heavens - can't you understand?
</p>

<p>
MR PETERS: Would you mind repeating your order, Madam.
</p>

<p>
MRS SPOONER: I want two dazzen -
</p>

<p>
MR PETERS: Two dozen!
</p>

<p>
MRS SPOONER: I said two dozen!
</p>

<p>
MR PETERS: Oh no no Madam - no, you said two dazzen.  But I understand perfectly
what you mean.  You mean two dozen; in other words - a double dozen.
</p>

<p>
MRS SPOONER: That's it! A duzzle dubbin double damask dinner napkins.
</p>

<p>
MR PETERS: Oh no, pardon me, Madam, pardon me: you mean a double dozen double dummick
dinner napkins.
</p>

<p>
ASSISTANT: Double damask, sir.
</p>

<p>
MR PETERS: I said double damask!  It's&#x2026; dapper ninkins you require, sir.
</p>

<p>
MRS SPOONER: Please get it right, I want dinner napkins, dinner napkins.
</p>

<p>
MR PETERS: I beg pardon, Madam. So stupid of me&#x2026;one gets so confused&#x2026;  (Laughs)
</p>

<p>
MRS SPOONER: It is not a laughing matter.
</p>

<p>
MR PETERS: Of course.  Dipper nankins, madam.
</p>

<p>
ASSISTANT: Dapper ninkins, sir.
</p>

<p>
MRS SPOONER: Danner nipkins.
</p>

<p>
MR PETERS: I understand exactly what Madam wants.  It is two d-d-d-d-..two d- Would you
mind repeating your order please, Madam?
</p>

<p>
MRS SPOONER: Ohhh, dear.. I want two duzzle dizzen damask dinner dumplings!
</p>

<p>
MR PETERS: Allow me, Madam, allow me.  The lady requires (quickly) two dubbin
double damask dunner napkins.
</p>

<p>
ASSISTANT: Dunner napkins sir?
</p>

<p>
MR PETERS: Certainly!  Two dizzen.
</p>

<p>
MRS SPOONER: Not two dizzen - I want two dowzen!
</p>

<p>
MR PETERS: Quite so, Madam, quite so.  If I may say so we're getting a little
bit confused, splitting it up, as it were.  Now, the full order, the full order,
is two dazzen dibble dummisk n'dipper dumkins.
</p>

<p>
ASSISTANT: Excuse me, sir, you mean two dummen dammle dimmick dizzy napkins.
</p>

<p>
(The next four four lines are spoken almost on top of each other)
</p>

<p>
MRS SPOONER: I do not want dizzy napkins, I want two dizzle dammen damask -
</p>

<p>
MR PETERS: No - two dizzle dammle dizzick!
</p>

<p>
ASSISTANT: Two duzzle dummuck dummy!
</p>

<p>
MRS SPOONER: Two damn dizzy diddle dimmer dipkins!
</p>

<p>
MR PETERS (Shocked): Madam, Madam!  Please, please - your language!
</p>

<p>
MRS SPOONER: Oh, blast.  Give me twenty four serviettes.
</p>
</div>
</div>

<div id="outline-container-org7185465" class="outline-3">
<h3 id="org7185465"><span class="section-number-3">2.21</span> Graphs of Eggs&#xa0;&#xa0;&#xa0;<span class="tag"><span class="geometry">geometry</span>&#xa0;<span class="jsxgraph">jsxgraph</span></span></h3>
<div class="outline-text-3" id="text-2-21">
<p>
I recently came across some nice material on [John Cook's
blog](<a href="https://www.johndcook.com/blog/">https://www.johndcook.com/blog/</a>) about equations that described eggs.
</p>

<p>
It turns out there are vast number of equations whose graphs are egg-shaped:
that is, basically ellipse shape, but with one end "rounder" than the other.
</p>

<p>
You can see lots at Jürgen Köller's [Mathematische
Basteleien](<a href="http://www.mathematische-basteleien.de/eggcurves.htm">http://www.mathematische-basteleien.de/eggcurves.htm</a>) page.
(Although this blog is mostly in German, there are enough English language pages
for monoglots such as me).  And plenty of egg equations can be found in the
[2dcurves](<a href="http://www.2dcurves.com/">http://www.2dcurves.com/</a>) pages.  
</p>

<p>
Another excellent source of eggy equations is [TDCC
Laboratory](<a href="http://www.geocities.jp/nyjp07/index_egg_E.html">http://www.geocities.jp/nyjp07/index_egg_E.html</a>) from Japan (the
link here is to their English language page).  For the purposes of experimenting
we will use equations from this TDCC, adjusted as necessary.  Many of their
equations are given in parametric form, which means they can be easily graphed
and explored using [JSXGraph](<a href="https://jsxgraph.org/wp/index.html">https://jsxgraph.org/wp/index.html</a>).
</p>

<p>
The first set of parametric equations, whose author is given to be Nobuo
Yamamoto, is:
</p>

\begin{align*}
x&=(a+b+b\cos\theta)\cos\theta\\
y&=(a+b\cos\theta)\sin\theta
\end{align*}

<p>
If we divide these equations by \(a\), and use the parameter \(c\) for \(b/a\) we
obtain slightly simpler equations:
</p>

\begin{align*}
x&=(1+c+c\cos\theta)\cos\theta\\
y&=(1+c\cos\theta)\sin\theta
\end{align*}

<p>
Here you can explore values of \(c\) between 0 and 1:
</p>

<div id="box" class="jxgbox" style="width:750px; height:375px;">
<script type="text/javascript">
 var board = JXG.JSXGraph.initBoard('box', {boundingbox: [-2, 2, 4, -1.5], axis:true,keepAspectRatio:true});
 var c = board.create('slider',[[1,1.5],[3,1.5],[0,0,1]],{name:'c'});
 var egg = board.create('curve',
                       [function(t){ return (1+c.Value()+c.Value()*Math.cos(t))*Math.cos(t);},
                        function(t){ return (1+c.Value()*Math.cos(t))*Math.sin(t);},
                        0, 2*Math.PI],{strokeWidth:4}
                        );

</script>
</div>

<p>
Another [set of equations](<a href="http://www.geocities.jp/nyjp07/index_egg_by_Itou_E.html">http://www.geocities.jp/nyjp07/index_egg_by_Itou_E.html</a>) is said to be due to [Tadao
Ito](<a href="http://web1.kcn.jp/hp28ah77/us_author.htm">http://web1.kcn.jp/hp28ah77/us_author.htm</a>) (whose surname is sometimes
transliterated as Itou):
</p>

\begin{align*}
x&=\cos\theta\\
y&=c\cos\frac{\theta}{4}\sin\theta
\end{align*}

<div id="box2" class="jxgbox" style="width:500px; height:375px;">
<script type="text/javascript">
 // var board2 = JXG.JSXGraph.freeBoard(board2); 
 var board2 = JXG.JSXGraph.initBoard('box2', {boundingbox: [-1.5, 1.5, 2, -1.5], axis:true,keepAspectRatio:true});
 var c2 = board2.create('slider',[[0.25,1.25],[1.75,1.25],[0,0,1.5]],{name:'c'});
 var egg2 = board2.create('curve',
                       [function(t){ return Math.cos(t);},
                        function(t){ return c2.Value()*Math.cos(t/4)*Math.sin(t);},
                        -Math.PI, Math.PI],{strokeWidth:4}
                        );

</script>
</div>

<p>
Many more equations: parametric, implicit, can be found at the sites linked above.
</p>
</div>
</div>

<div id="outline-container-orgd584a28" class="outline-3">
<h3 id="orgd584a28"><span class="section-number-3">2.22</span> Exploring JSXGraph&#xa0;&#xa0;&#xa0;<span class="tag"><span class="jsxgraph">jsxgraph</span></span></h3>
<div class="outline-text-3" id="text-2-22">
<p>
[JSXGraph](<a href="https://jsxgraph.org/wp/index.html">https://jsxgraph.org/wp/index.html</a>) is a graphics package deveoped in
Javascript, and which seems to be tailor-made for a static blog such as this.
It consists of only two files: the javascript file itself, and an accompanying
css file, which you can download.   Alternaively you can simply link to the
online files at the Javascript content delivery site
[cdnjs](<a href="https://cdnjs.com/about">https://cdnjs.com/about</a>) managed by
[cloudflare](<a href="https://www.cloudflare.com/">https://www.cloudflare.com/</a>).  There are cloudflare servers all
over the world - even in my home town of Melbourne, Australia. 
</p>

<p>
So I modified the <code>head.html</code> file of my theme to include a link to the
necessary files:
</p>

<p>
So I downloaded the javascript and css files as described
[here](<a href="https://jsxgraph.uni-bayreuth.de/wp/download/index.html">https://jsxgraph.uni-bayreuth.de/wp/download/index.html</a>)
and also, for good measure, added the script line (from that page) to the
<code>layouts/partials/head.html</code> file of the theme.  Then copied the following 
snippet from the JSXGraph site:
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #006699;">div</span> <span style="color: #BA36A5;">id</span>=<span style="color: #008000;">"box"</span> <span style="color: #BA36A5;">class</span>=<span style="color: #008000;">"jxgbox"</span> <span style="color: #BA36A5;">style</span>=<span style="color: #008000;">"width:500px; height:500px;"</span>&gt;&lt;/<span style="color: #006699;">div</span>&gt;
&lt;<span style="color: #006699;">script</span> <span style="color: #BA36A5;">type</span>=<span style="color: #008000;">"text/javascript"</span>&gt;
 var board = JXG.JSXGraph.initBoard('box', {boundingbox: [-10, 10, 10, -10], axis:true});
&lt;/<span style="color: #006699;">script</span>&gt;
</pre>
</div>

<p>
However, to make this work the entire script needs to be inside a <code>&lt;div&gt;</code>,
<code>&lt;/div&gt;</code> pair, like this:
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #006699;">div</span> <span style="color: #BA36A5;">id</span>=<span style="color: #008000;">"box"</span> <span style="color: #BA36A5;">class</span>=<span style="color: #008000;">"jxgbox"</span> <span style="color: #BA36A5;">style</span>=<span style="color: #008000;">"width:500px; height:500px;"</span>&gt;
&lt;<span style="color: #006699;">script</span> <span style="color: #BA36A5;">type</span>=<span style="color: #008000;">"text/javascript"</span>&gt;
 var board = JXG.JSXGraph.initBoard('box', {boundingbox: [-10, 10, 10, -10], axis:true});
&lt;/<span style="color: #006699;">script</span>&gt;
&lt;/<span style="color: #006699;">div</span>&gt;
</pre>
</div>

<p>
Just to see how well this works, here's Archimedes' <i>neusis</i> construction of an
angle trisection: given an angle \(\theta\) in a unit semicircle, its trisection is
obtained by laying against the circle a straight line with points spaced 1
apart (drag point A about the circle to see this in action):
</p>
<div id="box" class="jxgbox" style="width:750px; height:500px;">
<script type="text/javascript">
 JXG.Options.axis.ticks.insertTicks = false;
 JXG.Options.axis.ticks.drawLabels = false;
 var board = JXG.JSXGraph.initBoard('box', {boundingbox: [-1.5, 1.5, 3, -1.5],axis:true,keepAspectRatio:true});
 var p = board.create('point',[0,0],{visible:false,fixed:true});
 var neg = board.create('point',[-0.67,0],{visible:false,fixed:true});
 var c = board.create('circle',[[0,0],1.0]);
 var a = board.create('glider',[-Math.sqrt(0.5),Math.sqrt(0.5),c],{name:'A'});
 var l1 = board.create('segment',[a,p]);
 var ang = board.create('angle',[a,p,neg],{radius:0.67,name:'θ',type:'sector'});
 var theta = JXG.Math.Geometry.rad(a,p,neg);
 var bb = board.create('point',[
          () => Math.cos(Math.atan2(a.Y(),-a.X())/3),
          () => Math.sin(Math.atan2(a.Y(),-a.X())/3)
          ],{name:'B'});
 var w = board.create('point',[() =>  2*Math.cos(Math.atan2(a.Y(),-a.X())/3),0]);
 var l2 = board.create('line',[a,w]);
 var l3 = board.create('segment',[p,bb]);
 var l4 = board.create('segment',[bb,w],{strokeWidth:6,strokeColor:'#FF0000'});
 var ang2 = board.create('angle',[bb,w,neg],{radius:0.67,name:'θ/3'});
</script> 
</div>

<p>
For what it's worth, here is the splendid javascript code to produce the above
figure:
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #006699;">div</span> <span style="color: #BA36A5;">id</span>=<span style="color: #008000;">"box"</span> <span style="color: #BA36A5;">class</span>=<span style="color: #008000;">"jxgbox"</span> <span style="color: #BA36A5;">style</span>=<span style="color: #008000;">"width:500px; height:333.33px;"</span>&gt;
&lt;<span style="color: #006699;">script</span> <span style="color: #BA36A5;">type</span>=<span style="color: #008000;">"text/javascript"</span>&gt;
 JXG.Options.axis.ticks.insertTicks = false;
 JXG.Options.axis.ticks.drawLabels = false;
 var board = JXG.JSXGraph.initBoard('box', {boundingbox: [-1.5, 1.5, 3, -1.5],axis:true});
 var p = board.create('point',[0,0],{visible:false,fixed:true});
 var neg = board.create('point',[-0.67,0],{visible:false,fixed:true});
 var c = board.create('circle',[[0,0],1.0]);
 var a = board.create('glider',[-Math.sqrt(0.5),Math.sqrt(0.5),c],{name:'A'});
 var l1 = board.create('segment',[a,p]);
 var ang = board.create('angle',[a,p,neg],{radius:0.67,name:'&#952;'});
 var theta = JXG.Math.Geometry.rad(a,p,neg);
 var bb = board.create('point',[function(){return Math.cos(Math.atan2(a.Y(),-a.X())/3);},function(){return Math.sin(Math.atan2(a.Y(),-a.X())/3);}],{name:'B'});
 var w = board.create('point',[function(){return Math.cos(Math.atan2(a.Y(),-a.X())/3)/0.5;},0]);
 var l2 = board.create('line',[a,w]);
 var l3 = board.create('segment',[p,bb]);
 var l4 = board.create('segment',[bb,w],{strokeWidth:6,strokeColor:'#FF0000'});
 var ang2 = board.create('angle',[bb,w,neg],{radius:0.67,name:'&#952;/3'});
&lt;/<span style="color: #006699;">script</span>&gt; 
&lt;/<span style="color: #006699;">div</span>&gt;
</pre>
</div>

<p>
Quite wonderful, it is.
</p>
</div>
</div>

<div id="outline-container-org8f735cc" class="outline-3">
<h3 id="org8f735cc"><span class="section-number-3">2.23</span> The trinomial theorem&#xa0;&#xa0;&#xa0;<span class="tag"><span class="mathematics">mathematics</span>&#xa0;<span class="algebra">algebra</span></span></h3>
<div class="outline-text-3" id="text-2-23">
<p>
When I was teaching the binomial theorem (or, to be more accurate, the binomial
<i>expansion</i>) to my long-suffering students, one of them asked me if there was a
<i>trinomial</i> theorem.  Well, of course there is, although in fact expanding sums
of greater than two terms is generally not classed as a theorem described by the
number of terms. The general result is
</p>

<p>
\[
(x_1+x_2+\cdots+x_k)^n=\sum_{a_1+a_2+\cdots+a_k=n}
{n\choose a_1,a_2,\ldots,a_k}x_1^{a_1}x_2^{a_2}\cdots x_k^{a_k}
\]
</p>

<p>
so in particular a "trinomial theorem" would be
</p>

<p>
\[
(x+y+z)^n=\sum_{a+b+c=n}{n\choose a,b,c}x^ay^bz^c.
\]
</p>

<p>
Here we define
</p>

<p>
\[
{n\choose a,b,c}=\frac{n!}{a!b!c!}
\]
</p>

<p>
and this is known as a <i>trinomial coefficient</i>; more generally, for an arbitrary
number of variables, it is a <i>multinomial coefficient</i>.  It is guaranteed to be
an integer if the lower values sum to the upper value.
</p>

<p>
So to compute \((x+y+z)^5\) we could list all integers \(a,b,c\) with \(0\le a,b,c\le 5\)
for which \(a+b+c=5\), and put them all into the above sum.  
</p>

<p>
But of course there's a better way, and it comes from expanding \((x+y+z)^5\) as a
binomial \((x+(y+z))^5\) so that
</p>

\begin{array}{rcl}
(x+(y+x))^5&=&x^5\\
&&+5x^4(y+z)\\
&&+10x^3(y+z)^2\\
&&+10x^2(y+z)^3\\
&&+5x(y+z)^4\\
&&+(y+z)^5
\end{array}

<p>
Now we can expand each of those binomial powers:
</p>

\begin{array}{rcl}
(x+(y+x))^5&=&x^5\\
&&+5x^4(y+z)\\
&&+10x^3(y^2+2yz+z^2)\\
&&+10x^2(y^3+3y^2z+3yz^2+z^3)\\
&&+5x(y^4+4y^3z+6y^2z^2+4yz^3+z^4)\\
&&+(y^5+5y^4z+10y^3z^2+10y^2z^3+5yz^4+z^5)
\end{array}

<p>
Expanding this produces
</p>

\begin{split}
x^5&+5x^4y+5x^4z+10x^3y^2+20x^3yz+10x^3z^2+10x^2y^3+30x^2y^2z+30x^2yz^3\\
&+10x^2z^3+5zy^4+20xy^3z+30xy^2z^2+20xyz^3+5xz^4+y^5+5y^4z+10y^3z^2\\
&+10y^2z^3+5yz^4+z^5
\end{split}

<p>
which is an equation of rare beauty.
</p>

<p>
But there's a nice way of setting this up, which involves writing down Pascal's
triangle to the fifth row, and putting a fifth row, as a column, on the side.
Then multiply across:
</p>

\begin{array}{lcccccccccc}
1&&&&&&1&&&&&\\
5&&&&&1&&1&&&&\\
10\quad\times&&&&1&&2&&1&&&\\
10&&&1&&3&&3&&1&&\\
5&&1&&4&&6&&4&&1&\\
1&1&&5&&10&&10&&5&&1
\end{array}

<p>
to produce the final array of coefficients (with index numbers at the left):
</p>

\begin{array}{l*{10}{c}}
0\qquad{}&&&&&&1&&&&&\\
1&&&&&5&&5&&&&\\
2&&&&10&&20&&10&&&\\
3&&&10&&30&&30&&10&&\\
4&&5&&20&&30&&20&&5&\\
5&1&&5&&10&&10&&5&&1
\end{array}

<p>
Row \(i\) of this array corresponds to \(x^{5-i}\) and all combinations of powers
\(y^bz^c\) for \(0\le b,c\le i\).  Thus for example the fourth row down,
corresponding to \( i=3 \), may be considered as the coefficients of the terms
</p>

<p>
\[
x^2y^3,\quad x^2y^2z,\quad x^2yz^2,\quad xz^3.
\]
</p>

<p>
Note that the triangle of coefficients is symmetrical along all three centre
lines, as well as rotationally symmetric by 120°.  
</p>
</div>
</div>

<div id="outline-container-org4ad5c45" class="outline-3">
<h3 id="org4ad5c45"><span class="section-number-3">2.24</span> Playing with Hugo&#xa0;&#xa0;&#xa0;<span class="tag"><span class="hugo">hugo</span>&#xa0;<span class="org">org</span></span></h3>
<div class="outline-text-3" id="text-2-24">
<p>
I've been using wordpress as my blogging platform since I first started, about
10 years ago.  (In fact the first post I can find is dated March 30, 2008.)  I
chose [wordpress.com](<a href="http://wordpress.com">http://wordpress.com</a>) back then because it was (a) free,
and (b) supported mathematics through a version (or subset) of
[LaTeX](<a href="https://www.latex-project.org">https://www.latex-project.org</a>).  As I have used LaTeX extensively for
all my writing since the early 1990's, it's a standard requirement for me.
</p>

<p>
Some time later I decided to start hosting my own server (well, a VPS), on which
I could use [wordpress.org](<a href="https://wordpress.org">https://wordpress.org</a>), which is the self-hosted
version of wordpress.  The advantages of a self hosted blog are many, but I
particularly like the greater freedom, the ability to include a far greater
variety of plugins, and the larger choice of themes.  And one of the plugins I
liked particularly was [WP
QuickLaTeX](<a href="https://wordpress.org/plugins/wp-quicklatex/">https://wordpress.org/plugins/wp-quicklatex/</a>) which provided a LaTeX
engine far superior to the in-built one of wordpress.com.  Math bloggin heaven!
</p>

<p>
However, hosting my own wordpress site was not without difficulty.  First I had
to install it and get it up and running (even this was non-trivial), and then I
had to manage all the users and passwords: myself as a standard user, wp-admin
for accessing the Wordpress site itself, a few others.  I have quite a long list
containing all the commands I used, and all the users and passwords I created.
</p>

<p>
This served me well, but it was also slow to use.  My VPS is perfectly
satisfactory, but it is not fast (I'm too cheap to pay for much more than a
low-powered one), and the edit-save-preview cycle of online blogging with my
wordpress installation was getting tiresome.  
</p>

<p>
Plus the issue of security.  I've been hacked once, and I've since managed to
secure my site with a free certificate from [Let's
Encrypt](<a href="https://letsencrypt.org">https://letsencrypt.org</a>).  In fact, in many ways Let's Encrypt is one
of the best things to have happened for security.  An open Certificate Authority
is manna from heaven, as far as I'm concerned.
</p>

<p>
Wordpress is of course more than just blogging software.  It now grandly styles
itself as Site Building software and Content Management System, and the site
claims that "30% of the web uses Wordpress".  It is in fact hugely powerful and
deservedly popular, and can be used for pretty much whatever sort of site you
want to build.   Add to that a seemingly infinite set of plugins, and you have
an entire ecosystem of web-building.
</p>

<p>
However, all of that popularity and power comes at a cost: it is big, confusing,
takes work to maintain, keep secure, and keep up-to-date, and is a target for
hackers.  Also for me, it has become colossal overkill.  I don't need all those
bells and whistles; all I want to do is host my blog and share my posts with the
world (the \(1.5\times 10^{-7}\%\) of the world who reads it).
</p>

<p>
The kicker for me was checking out a [mathematics education
blog](<a href="http://rtalbert.org">http://rtalbert.org</a>) by an author I admire greatly, to discover it was
built with the static blog engine [jekyll](<a href="https://jekyllrb.com">https://jekyllrb.com</a>).  So being the
inventive bloke I am, I thought I'd do the same.
</p>

<p>
But a bit of hunting led me to [Hugo](<a href="https://gohugo.io">https://gohugo.io</a>), which apparently is
very similar to jekyll, but much faster, and written in [Go](<a href="https://golang.org">https://golang.org</a>)
instead of [Ruby](<a href="https://www.ruby-lang.org/en/">https://www.ruby-lang.org/en/</a>).  Since I know nothing about
either Go or Ruby I don't know if it's the language which makes the difference,
or something else.  But it sure looks nice, and supports
[mathjax](<a href="https://www.mathjax.org">https://www.mathjax.org</a>) for LaTeX.
</p>

<p>
So my current plan is to migrate from wordpress to Hugo, and see how it goes!
</p>
</div>
</div>
<div id="outline-container-org95f8563" class="outline-3">
<h3 id="org95f8563"><span class="section-number-3">2.25</span> Python GIS, and election results&#xa0;&#xa0;&#xa0;<span class="tag"><span class="python">python</span>&#xa0;<span class="voting">voting</span></span></h3>
<div class="outline-text-3" id="text-2-25">
</div>
<div id="outline-container-org3430839" class="outline-4">
<h4 id="org3430839"><span class="section-number-4">2.25.1</span> Election mapping</h4>
<div class="outline-text-4" id="text-2-25-1">
<p>
A few weeks ago there was a by-election in my local electorate (known as an
electoral <i>division</i>) of Batman here in Australia.  I was interested in
comparing the results of this election with the previous election two years ago.
In this division it's become a two-horse race: the Greens against the Australian
Labor Party.  Although Batman had been a solid Labor seat for almost its entire
existence - it used to be considered one of the safest Labor seats in the
country - over the past decade or so the Greens have been making inroads into
this Labor heartland, to the extent that is no longer considered a safe seat.
And in fact for this particular election the Greens were the popular choice to
win.  In the end Labor won, but my interest is not so much tracing the votes,
but trying to map them.
</p>

<p>
Python has a vast suite of mapping tools, so much so that it may be that Python
has become the GIS tool of choice.  And there are lots of web pages devoted to
discussing these tools and their uses, such as [this
one](<a href="http://matthewrocklin.com/blog/work/2017/09/21/accelerating-geopandas-1">http://matthewrocklin.com/blog/work/2017/09/21/accelerating-geopandas-1</a>).
</p>

<p>
My interest was producing maps such as are produced by
[pollbludger](<a href="https://www.pollbludger.net/by-elections/fed-2018-03-batman.htm">https://www.pollbludger.net/by-elections/fed-2018-03-batman.htm</a>)
This is the image from that page:
</p>

<p>
![pollbludger](/pollbludger<sub>batman.png</sub>)
</p>

<p>
As you can see there are basically three elements:
</p>

<ul class="org-ul">
<li>the underlying streetmap</li>
<li>the border of the division</li>
<li>the numbers showing the percentage wins of each party at the various polling
booths.</li>
</ul>

<p>
I wanted to do something similar, but replace the numbers with circles whose
sizes showed the strength of the percentage win at each place.
</p>
</div>
</div>

<div id="outline-container-org9fcd42a" class="outline-4">
<h4 id="org9fcd42a"><span class="section-number-4">2.25.2</span> Getting the information</h4>
<div class="outline-text-4" id="text-2-25-2">
<p>
Because this election was in a federal division, the management of the polls and
of the results (including counting the votes) was managed by the Australian
Electoral Commission, whose [pages about this by-election](
<a href="http://www.aec.gov.au/Elections/supplementary_by_elections/2018-batman/">http://www.aec.gov.au/Elections/supplementary_by_elections/2018-batman/</a>) contain
pretty much all publicly available information.  You can copy and paste the
results from their pages, or download them as CSV files.
</p>

<p>
Then I needed to find the coordinates (Longitude and Latitude) of all the
polling places, of which there were 42 at fixed locations.  There didn't seem to
be a downloadable file for this, so for each booth address (given on the AEC
site), I entered it into Google Maps and copied down the coordinates as given.
</p>

<p>
The boundaries of all the divisions can again be downloaded from the [AEC GIS
page](<a href="http://www.aec.gov.au/Electorates/gis/index.htm">http://www.aec.gov.au/Electorates/gis/index.htm</a>).  These are given in
various standard GIS files.
</p>
</div>
</div>

<div id="outline-container-org253f77d" class="outline-4">
<h4 id="org253f77d"><span class="section-number-4">2.25.3</span> Putting it all together</h4>
<div class="outline-text-4" id="text-2-25-3">
<p>
The tools I felt brave enough to use were:
</p>

<ul class="org-ul">
<li>[Pandas:](<a href="https://pandas.pydata.org">https://pandas.pydata.org</a>) Python's data analysis library.  I
really only needed to read information from CSV files that I could then use
later.</li>
<li>[Geopandas:](<a href="http://geopandas.org">http://geopandas.org</a>) This is a GIS library with Pandas-like
syntax, and is designed in part to be a GIS extension to Pandas.  I would
use it to extract and manage the boundary data of the electoral division.</li>
<li>[Cartopy:](<a href="http://scitools.org.uk/cartopy/">http://scitools.org.uk/cartopy/</a>) which is a library of
"cartographic tools".</li>
</ul>

<p>
And of course the standard [matplotlib](<a href="http://matplotlib.org">http://matplotlib.org</a>) for plotting,
[numpy](<a href="http://www.numpy.org">http://www.numpy.org</a>) for array handling.
</p>

<p>
My guides were the [London tube stations
example](<a href="http://scitools.org.uk/cartopy/docs/latest/gallery/tube_stations.html">http://scitools.org.uk/cartopy/docs/latest/gallery/tube_stations.html</a>)
from Cartopy and a local (Australian) data analysis blog which discussed the
[use of Cartopy](<a href="http://www.net-analysis.com/blog/cartopytiles.html">http://www.net-analysis.com/blog/cartopytiles.html</a>) including
adding graphics to an map image.
</p>

<p>
There are lots of other GIS tools for Python, some of which seem to be very good
indeed, and all of which I downloaded:
</p>

<ul class="org-ul">
<li>[Fiona](<a href="https://github.com/Toblerity/Fiona">https://github.com/Toblerity/Fiona</a>): which is a "nimble" API for
handling maps</li>
<li>[Descartes](<a href="https://bitbucket.org/sgillies/descartes/">https://bitbucket.org/sgillies/descartes/</a>): which provides a
means by which matplotlib can be used to manage geographic objects</li>
<li>[geoplotlib](<a href="https://github.com/andrea-cuttone/geoplotlib">https://github.com/andrea-cuttone/geoplotlib</a>): for "visualizing
geographical data and making maps"</li>
<li>[Folium](<a href="http://python-visualization.github.io/folium/">http://python-visualization.github.io/folium/</a>): for visualizing maps
using the [leaflet.js](<a href="http://leafletjs.com">http://leafletjs.com</a>) library.  It may be that the
mapping I wanted to do with Python could have been done just as well in
Javascript alone.  And probably other languages.  I stuck with Python simply
because I knew it best.</li>
<li>[QGIS](<a href="https://qgis.org/en/site/">https://qgis.org/en/site/</a>): which is designed to be a complete free
and open source GIS, and with APIs both for Python and C++</li>
<li>[GDAL](<a href="http://www.gdal.org">http://www.gdal.org</a>): the "Geospatial Data Abstraction Library" which
has a [Python package](<a href="https://pypi.python.org/pypi/GDAL">https://pypi.python.org/pypi/GDAL</a>) also called GDAL,
for manipulating geospatial raster and vector data.</li>
</ul>

<p>
I suspect that if I was professionally working in the GIS area some or all of
these packages would be at least as - and maybe even more - suitable than the
ones I ended up using.  But then, I was starting from a position of absolute
zero with regards to GIS, and also I wanted to be able to make use of the tools
I already knew, such as Pandas, matplotlib, and numpy.
</p>

<p>
Here's the start, importing the libraries, or the bits of them I needed:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">import</span> matplotlib.pyplot <span style="color: #0000FF;">as</span> plt
<span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np
<span style="color: #0000FF;">import</span> cartopy.crs <span style="color: #0000FF;">as</span> ccrs
<span style="color: #0000FF;">from</span> cartopy.io.img_tiles <span style="color: #0000FF;">import</span> GoogleTiles
<span style="color: #0000FF;">import</span> geopandas <span style="color: #0000FF;">as</span> gpd
<span style="color: #0000FF;">import</span> pandas <span style="color: #0000FF;">as</span> pd
</pre>
</div>

<p>
I then had to read in the election data, which was a CSV files from the AEC
containing the Booth, and the final distributed percentage weighting to the ALP
and Greens candidates, and heir percentage scores.  As well, I read in the
boundary data:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #BA36A5;">bb</span> = pd.read_csv(<span style="color: #008000;">'Elections/batman_booths_coords.csv'</span>)  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">contains all election info plus lat, long of booths</span>
<span style="color: #BA36A5;">longs</span> = np.array(bb[<span style="color: #008000;">'Long'</span>])
<span style="color: #BA36A5;">lats</span> = np.array(bb[<span style="color: #008000;">'Lat'</span>])
<span style="color: #BA36A5;">v</span> = gpd.read_file(<span style="color: #008000;">'VicMaps/VIC_ELB.MIF'</span>)  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">all electoral divisions in MapInfo form</span>
<span style="color: #BA36A5;">bg</span> = v.loc[2].geometry                    <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">This is the Polygon representing Batman</span>
<span style="color: #BA36A5;">b_longs</span> = bg.exterior.xy[0]               <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">These next two lines are the longitudes and latitudes</span>
<span style="color: #BA36A5;">b_lats</span> = bg.exterior.xy[1]                <span style="color: #8D8D84;">#</span>
</pre>
</div>

<p>
Notice that <code>bb</code> uses Pandas to read in the CSV files which contains all the AEC
information, as well as the latitude and longitude of each Booth, which I'd
added myself.  Here <code>longs</code> and <code>lats</code> are the coordinates of the polling
booths, and <code>b_longs</code> and <code>b-lats</code> are all the vertices which form the boundary
of the division.
</p>

<p>
Now it's all pretty straigtforward, especially with the examples mentioned above:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #BA36A5;">fig</span> = plt.figure(figsize=(16,16))

<span style="color: #BA36A5;">tiler</span> = GoogleTiles()
<span style="color: #BA36A5;">ax</span> = plt.axes(projection=tiler.crs)

<span style="color: #BA36A5;">margin</span>=0.01
ax.set_extent((bg.bounds[0]-margin, bg.bounds[2]+margin,bg.bounds[1]-margin, bg.bounds[3]+margin))

ax.add_image(tiler,12)
<span style="color: #0000FF;">for</span> i <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">range</span>(44):
    plt.plot(longs[i],lats[i],ga2[i],markersize=<span style="color: #006FE0;">abs</span>(ga[i]),alpha=0.7,transform=ccrs.Geodetic())

plt.plot(b_longs,b_lats,<span style="color: #008000;">'k-'</span>,linewidth=5,transform=ccrs.Geodetic())
plt.title(<span style="color: #008000;">'Booth results in the 2018 Batman by-election'</span>)
plt.show()
</pre>
</div>

<p>
Here <code>GoogleTiles</code> provide the street map to be used as the "base" of our map.
Open Streep Map (as OSM) is available too, but I thin in this instance, Google
Maps is better.  Because the map is rendered as an image (with some unavoidable
blurring), I find that Google gave a better result than OSM.
</p>

<p>
Also, <code>ga2</code> is a little array which simply produces plotting of the style <code>ro</code>
(red circle) or <code>go</code> (green circle).  Again, I make the program do most of the
work.
</p>

<p>
And here is the result, saved as an image:
</p>

<p>
![Batman 2018](/batman2018trim.png)
</p>

<p>
I'm quite pleased with this output.
</p>
</div>
</div>
</div>

<div id="outline-container-org1260827" class="outline-3">
<h3 id="org1260827"><span class="section-number-3">2.26</span> Presentations and the delight of js-reveal</h3>
<div class="outline-text-3" id="text-2-26">
<p>
Presentations are a modern bugbear. Anybody in academia or business, or
any professional field really, will have sat through untold hours of
presentations. And almost all of them are <i>terrible</i>. Wordy,
uninteresting, too many "transition effects", low information content,
you know as well as I do.
</p>

<p>
Pretty much every speaker reads the words on their slides, as though the
audience were illiterate. I went to a talk once which consisted of 60 &#x2013;
yes, sixty &#x2013; slides of very dense text, and the presenter read through
each one. I think people were gnawing their own limbs off out of sheer
boredom by the end.
<a href="https://en.wikipedia.org/wiki/Empire_(1964_film)">Andy Warhol's
"Empire"</a> would have been a welcome relief.
</p>

<p>
Since most of my talks are technical and full of mathematics, I have
naturally gravitated to the LaTeX presentation tool
<a href="https://en.wikipedia.org/wiki/Beamer_(LaTeX)">Beamer</a>. Now Beamer is
a lovely thing for LaTeX: as part of the LaTeX ecosystem you get all of
LaTeX loveliness along with elegant slide layouts, transitions, etc. My
only issue with Beamer (and this is not a new observation by any means),
is that all Beamer presentations have a certain sameness to them. I
suspect that this is because most Beamer users are mathematicians, who
are rightly more interested in co[[<a href="https://orgmode.org">https://orgmode.org</a>][]]ntent than
appearance. It is quite possible of course to make Beamer look like
something new and different, but hardly anybody does.
</p>

<p>
However, I am not a mathematician, I am a mathematics educator, and I do
like my presentations to look good, and if possible to stand out a
little. I also have a minor issue in that I use Linux on my laptop,
which sometimes means my computer won't talk to an external projector
system. Or my USB thumb drive won't be recognized by the computer I'll
be using, and so on. One way round all this is to use an online system;
maybe one which can be displayed in a browser, and which can be placed
on a web server somewhere. There are of course plenty of such tools, and
I have had a brief dalliance with <a href="https://prezi.com">prezi</a>, but for
me prezi was not the answer: yes it was fun and provided a new paradigm
for organizing slides, but really, when you took the whizz-bang aspect
out, what was left? The few prezis I've seen in the wild showed that you
can be as dull with prezi as with any other software. Also, at the time
it didn't support mathematics.
</p>

<p>
In fact I have an abiding distrust of the whole concept of
"presentations". Most are a colossal waste of time &#x2013; people can read so
there's no need for wordiness, and most of the graphs and charts that
make up the rest of most slides are dreary and lacklustre. Hardly
anybody knows how to present information graphically in a way that
really grabs people's attention. It's lazy and insulting to your
audience to simply copy a chart from your spreadsheet and assume they'll
be delighted by it. Then you have the large class of people who fill
their blank spaces with cute cartoons and clip art. This sort of thing
annoys me probably more than it should &#x2013; when I'm in an audience I
don't want to be entertained with cute irrelevant additions, I want to
<i>learn</i>. This comes to the heart of presenting. A presenter is acting as
a teacher; the audience the learners. So presenting should be about
engaging the audience. What's in your slides comes a distant second. I
don't want new technology with clever animations and transitions,
bookmarks, non-linear slide shows; I want presenters to be themselves
interesting. (As an aside, some of the very worst presentations have
been at education conferences.)
</p>

<p>
For a superb example of attention-grabbing graphics, check out the
<a href="https://www.ted.com/talks/hans_rosling_shows_the_best_stats_you_ve_ever_seen">TED
talk</a> by the late <a href="https://en.wikipedia.org/wiki/Hans_Rosling">Hans
Rosling</a>. Or you can admire the work of
<a href="https://informationisbeautiful.net">David McCandless</a>.
</p>

<p>
I seem to have digressed, from talking about presentation software to
banging on about the awfulness of presentations generally. So, back to
the topic.
</p>

<p>
For a recent conference I determined to do just that: use an online
presentation tool, and I chose <a href="https://revealjs.com/#/">reveal.js</a>. I
reckon reveal.js is presentations done right: elegant, customizable,
making the best use of html for content and css for design; and with
nicely chosen defaults so that even if you just put a few words on your
slides the result will still look good. Even better, you can take your
final slides and put them up on <a href="https://pages.github.com">github
pages</a> so that you can access them from anywhere in the world with a
web browser. And if you're going somewhere which is not networked, you
can always take your slides on some sort of portable media. And it has
access to almost all of LaTeX via <a href="https://www.mathjax.org">MathJax</a>.
</p>

<p>
One minor problem with reveal.js is that the slides are built up with
raw html code, and so can be somewhat verbose and hard to read (at least
for me). However, there is a companion software for emacs org mode
called <a href="https://github.com/yjwen/org-reveal">org-reveal</a>, which
enables you to structure your reveal.js presentation as an org file.
This is presentation heaven. The org file gives you structure, and
reveal.js gives you a lovely presentation.
</p>

<p>
To make it available, you upload all your presentations to github.pages,
and you can present from anywhere in the world with an internet
connection! You can see an example of one of my short presentations at
</p>

<p>
<a href="https://amca01.github.io/ATCM_talks/lindenmayer.html">https://amca01.github.io/ATCM_talks/lindenmayer.html</a>
</p>

<p>
Of course the presentation (the software and what you do with it), is in
fact the least part of your talk. By far the most important part is the
presenter. The best software in the world won't overcome a boring
speaker who can't engage an audience.
</p>

<p>
I like my presentations to be simple and effect-free; I don't want the
audience to be distracted from my leaping and capering about.
Just to see how it works
</p>
</div>
</div>

<div id="outline-container-org0180b89" class="outline-3">
<h3 id="org0180b89"><span class="section-number-3">2.27</span> The Vigenere cipher in haskell</h3>
<div class="outline-text-3" id="text-2-27">
<p>
Programming the Vigenère cipher is my go-to problem when learning a new
language. It's only ever a few lines of code, but it's a pleasant way of
getting to grips with some of the basics of syntax. For the past few
weeks I've been wrestling with <a href="https://www.haskell.org">Haskell</a>, and
I've now got to the stage where a Vigenère program is in fact pretty
easy.
</p>

<p>
As you know, the Vigenère cipher works using a plaintext and a keyword,
which is repeated as often as need be:
</p>

<pre class="example">
T H I S I S T H E P L A I N T E X T
K E Y K E Y K E Y K E Y K E Y K E Y
</pre>

<p>
The corresponding letters are added modulo 26 (using the values A=0,
B=1, C=2, and on up to Z=25), then converted back to letters again. So
for the example above, we have these corresponding values:
</p>

<pre class="example">
19   7   8  18   8  18  19   7   4  15  11   0   8  13  19   4  23  19
10   4  24  10   4  24  10   4  24  10   4  24  10   4  24  10   4  24
</pre>

<p>
Adding modulo 26 and converting back to letters:
</p>

<pre class="example">
3  11   6   2  12  16   3  11   2  25  15  24  18  17  17
D   L   G   C   M   Q   D   L   C   Z   P   Y   S   R   R
</pre>

<p>
gives us the ciphertext.
</p>

<p>
The Vigenère cipher is historically important as it is one of the first
cryptosystems where a single letter may be encrypted to different
characters in the ciphertext. For example, the two "S"s are encrypted to
"C" and "Q"; the first and last "T"s are encrypted to "D" and "R". For
this reason the cipher was considered unbreakable - as indeed it was for
a long time - and was known to the French as <i>le chiffre
indéchiffrable</i> - the unbreakable cipher. It was broken in 1863. See the
<a href="https://en.wikipedia.org/wiki/Vigen%C3%A8re_cipher">Wikipedia page</a> for
more history.
</p>

<p>
Suppose the length of the keyword is . Then the -th character of the
plaintext will correspond to the character of the keyword (assuming a
zero-based indexing). Thus the encryption can be defined as
</p>

<p>
\[
c_i = p_i+k_{i\pmod{n}}\pmod{26}
\]
</p>

<p>
However, encryption can also be done without knowing the length of the
keyword, but by shifting the keyword each time - first letter to the
end - and simply taking the left-most letter. Like this:
</p>

<pre class="example">
T H I S I S T H E P L A I N T E X T
K E Y
</pre>

<p>
so "T"+"K" (modulo 26) is the first encryption. Then we shift the
keyword:
</p>

<pre class="example">
T H I S I S T H E P L A I N T E X T
  E Y K
</pre>

<p>
and "H"+"E" (modulo 26) is the second encrypted letter. Shift again:
</p>

<pre class="example">
T H I S I S T H E P L A I N T E X T
    Y K E
</pre>

<p>
for "I"+"Y"; shift again:
</p>

<pre class="example">
T H I S I S T H E P L A I N T E X T
      K E Y
</pre>

<p>
for "S"+"K". And so on.
</p>

<p>
This is almost trivial in Haskell. We need two extra functions from the
module <code>Data.Char</code>: <code>chr</code> which gives the character corresponding to the
ascii value, and <code>ord</code> which gives the ascii value of a character:
</p>

<div class="org-src-container">
<pre class="src src-haskell">&#955;<span style="color: #006699;">&gt;</span> ord <span style="color: #008000;">'G'</span>
71
&#955;<span style="color: #006699;">&gt;</span> chr 88
<span style="color: #008000;">'X'</span>
</pre>
</div>

<p>
So here's what might go into a little file called <code>vigenere.hs</code>:
</p>

<div class="org-src-container">
<pre class="src src-haskell"><span style="color: #0000FF;">import</span> <span style="color: #6434A3;">Data.Char</span> (ord,chr)

<span style="color: #006699;">vige</span> <span style="color: #BA36A5;">::</span> [<span style="color: #6434A3;">Char</span>] <span style="color: #BA36A5;">-&gt;</span> [<span style="color: #6434A3;">Char</span>] <span style="color: #BA36A5;">-&gt;</span> [<span style="color: #6434A3;">Char</span>]
<span style="color: #006699;">vige</span> <span style="color: #6434A3;">[]</span> k <span style="color: #BA36A5;">=</span> <span style="color: #6434A3;">[]</span>
<span style="color: #006699;">vige</span> p <span style="color: #6434A3;">[]</span> <span style="color: #BA36A5;">=</span> <span style="color: #6434A3;">[]</span>
<span style="color: #006699;">vige</span> (p<span style="color: #6434A3;">:</span>ps) (k<span style="color: #6434A3;">:</span>ks) <span style="color: #BA36A5;">=</span> (encode p k)<span style="color: #6434A3;">:</span>(vige ps (ks<span style="color: #BA36A5;">++</span>[k]))
  <span style="color: #0000FF;">where</span>
    encode a b <span style="color: #BA36A5;">=</span> chr <span style="color: #BA36A5;">$</span> 65 <span style="color: #BA36A5;">+</span> mod (ord a <span style="color: #BA36A5;">+</span> ord b) 26

<span style="color: #006699;">vigd</span> <span style="color: #BA36A5;">::</span> [<span style="color: #6434A3;">Char</span>] <span style="color: #BA36A5;">-&gt;</span> [<span style="color: #6434A3;">Char</span>] <span style="color: #BA36A5;">-&gt;</span> [<span style="color: #6434A3;">Char</span>]
<span style="color: #006699;">vigd</span> <span style="color: #6434A3;">[]</span> k <span style="color: #BA36A5;">=</span> <span style="color: #6434A3;">[]</span>
<span style="color: #006699;">vigd</span> p <span style="color: #6434A3;">[]</span> <span style="color: #BA36A5;">=</span> <span style="color: #6434A3;">[]</span>
<span style="color: #006699;">vigd</span> (p<span style="color: #6434A3;">:</span>ps) (k<span style="color: #6434A3;">:</span>ks) <span style="color: #BA36A5;">=</span> (decode p k)<span style="color: #6434A3;">:</span>(vigd ps (ks<span style="color: #BA36A5;">++</span>[k]))
  <span style="color: #0000FF;">where</span>
    decode a b <span style="color: #BA36A5;">=</span> chr <span style="color: #BA36A5;">$</span> 65 <span style="color: #BA36A5;">+</span> mod (ord a <span style="color: #BA36A5;">-</span> ord b) 26
</pre>
</div>

<p>
And a couple of tests: the example from above, and the one on the
Wikipedia page:
</p>

<div class="org-src-container">
<pre class="src src-haskell">&#955;<span style="color: #006699;">&gt;</span> vige <span style="color: #008000;">"THISISTHEPLAINTEXT"</span> <span style="color: #008000;">"KEY"</span>
<span style="color: #008000;">"DLGCMQDLCZPYSRROBR"</span>
&#955;<span style="color: #006699;">&gt;</span> vige <span style="color: #008000;">"ATTACKATDAWN"</span> <span style="color: #008000;">"LEMON"</span>
<span style="color: #008000;">"LXFOPVEFRNHR"</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org747ea34" class="outline-3">
<h3 id="org747ea34"><span class="section-number-3">2.28</span> Analysis of a recent election</h3>
<div class="outline-text-3" id="text-2-28">
<p>
On November 18, 2017, a by-election was held in my suburb of
<a href="https://en.wikipedia.org/wiki/Northcote,_Victoria">Northcote</a>, on
account of the death by cancer of the sitting member. It turned into a
two-way contest between Labor (who had held the seat since its inception
in 1927), and the Greens, who are making big inroads into the inner
city. The Greens candidate won, much to Labor's surprise. As I played a
small part in this election, I had some interest in its result. And so I
thought I'd experiment with the results and see how close the result
was, and what other voting systems might have produced.
</p>

<p>
In Australia, the voting method used for almost all lower house
elections (state and federal), is
<a href="https://en.wikipedia.org/wiki/Instant-runoff_voting">Instant Runoff
Voting</a>, also known as the Alternative Vote, and known locally as the
"preferential method". Each voter must number the candidates
sequentially starting from 1. All boxes must be filled in (except the
last); no numbers can be repeated or missed. In Northcote there were 12
candidates, and so each voter had to number the boxes from 1 to 12 (or 1
to 11); any vote without those numbers is invalid and can't be counted.
Such votes are known as "informal". Ballots are distributed according to
first preferences. If no candidate has obtained an absolute majority,
then the candidate with the lowest count is eliminated, and all those
ballots distributed according to their second preferences. This
continues through as many redistributions as necessary until one
candidate ends up with an absolute majority of ballots. So at any stage
the candidate with the lowest number of ballots is eliminated, and those
ballots redistributed to the remaining candidates on the basis of the
highest preferences. As voting systems go it's not the worst, although
it has many faults. However, it is too entrenched in Australian
political life for change to be likely.
</p>

<p>
Each candidate had prepared a
<a href="https://en.wikipedia.org/wiki/How-to-vote_card">How to Vote card</a>,
listing the order of candidates they saw as being most likely to ensure
a good result for themselves. In fact there is no requirement for any
voter to follow a How to Vote card, but most voters do. For this reason
the ordering of candidates on these cards is taken very seriously, and
one of the less savoury aspects of Australian politics is backroom
"preference deals", where parties will wheel and deal to ensure best
possible preference positions on other How to Vote cards.
</p>

<p>
Here are the 12 candidates and their political parties, in the order as
listed on the ballots:
</p>

<p>
Attention: The internal data of table "4" is corrupted!
</p>

<p>
For this election the How to Vote cards can be seen at the
<a href="http://www.abc.net.au/news/elections/northcote-by-election-2017/">ABC
news site</a>. The only candidate not to provide a full ordered list was
Joseph Toscano, who simple advised people to number his square 1, and
the other squares in any order they liked, along with a recommendation
for people to number Lidia Thorpe 2.
</p>

<p>
As I don't have a complete list of all possible ballots with their
orderings and numbers, I'm going to make the following assumptions:
</p>

<ol class="org-ol">
<li>Every voter followed the How to Vote card of their preferred
candidate exactly.</li>
<li>Joseph Toscano's preference ordering is: 3,4,2,5,6,7,8,9,1,10,11,12
(This gives Toscano 1; Thorpe 2; and puts the numbers 3 &#x2013; 12 in
order in the remaining spaces).</li>
</ol>

<p>
These assumptions are necessarily crude, and don't reflect the nuances
of the election. But as we'll see they end up providing a remarkably
close fit with the final results.
</p>

<p>
For the exploration of the voting data I'll use Python, and so here is
all the How to Vote information as a dictionary:
</p>

<div class="org-src-container">
<pre class="src src-python">In [ ]: <span style="color: #BA36A5;">htv</span> = <span style="color: #006FE0;">dict</span>()
        <span style="color: #BA36A5;">htv</span>[<span style="color: #008000;">'Hayward'</span>]=[1,10,7,6,8,5,12,11,3,2,4,9]
        <span style="color: #BA36A5;">htv</span>[<span style="color: #008000;">'Sanaghan'</span>]=[3,1,2,5,6,7,8,9,10,11,12,4]
        <span style="color: #BA36A5;">htv</span>[<span style="color: #008000;">'Thorpe'</span>]=[6,9,1,3,10,8,12,2,7,4,5,11]
        <span style="color: #BA36A5;">htv</span>[<span style="color: #008000;">'Lenk'</span>]=[7,8,3,1,5,11,12,2,9,4,6,10]
        <span style="color: #BA36A5;">htv</span>[<span style="color: #008000;">'Chipp'</span>]=[10,12,4,5,1,6,7,3,11,9,2,8]
        <span style="color: #BA36A5;">htv</span>[<span style="color: #008000;">'Cooper'</span>]=[5,12,8,6,2,1,7,3,11,9,10,4]
        <span style="color: #BA36A5;">htv</span>[<span style="color: #008000;">'Rossiter'</span>]=[6,12,9,11,2,7,1,5,8,10,3,4]
        <span style="color: #BA36A5;">htv</span>[<span style="color: #008000;">'Burns'</span>]=[10,12,5,3,2,4,6,1,11,9,8,7]
        <span style="color: #BA36A5;">htv</span>[<span style="color: #008000;">'Toscano'</span>]=[3,4,2,5,6,7,8,9,1,10,11,12]
        <span style="color: #BA36A5;">htv</span>[<span style="color: #008000;">'Edwards'</span>]=[2,10,4,3,8,9,12,6,5,1,7,11]
        <span style="color: #BA36A5;">htv</span>[<span style="color: #008000;">'Spirovska'</span>]=[2,12,3,7,4,5,6,8,10,9,1,11]
        <span style="color: #BA36A5;">htv</span>[<span style="color: #008000;">'Fontana'</span>]=[2,3,4,5,6,7,8,9,10,11,12,1]

        In [ ]: <span style="color: #BA36A5;">cands</span> = <span style="color: #006FE0;">list</span>(htv.keys())
</pre>
</div>

<p>
voting took place at different voting centres (also known as "booths"),
and the first preferences for each candidate at each booth can be found
at the
<a href="https://www.vec.vic.gov.au/Results/State2017/FPVbyVotingCentreNorthcoteDistrict.html">Victorian
Electoral Commission</a>. I copied this information into a spreadsheet and
saved it as a CSV file. I then used the data analysis library
<a href="https://pandas.pydata.org">pandas</a> to read it in as a
<a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html">DataFrame</a>:
</p>

<div class="org-src-container">
<pre class="src src-python">In [ ]: <span style="color: #0000FF;">import</span> pandas <span style="color: #0000FF;">as</span> pd
        <span style="color: #BA36A5;">firstprefs</span> = pd.read_csv(<span style="color: #008000;">'northcote_results.csv'</span>)
        <span style="color: #BA36A5;">firsts</span> = firstprefs.loc[:,<span style="color: #008000;">'Hayward'</span>:<span style="color: #008000;">'Fontana'</span>].<span style="color: #006FE0;">sum</span>(axis=0)
        firsts

Out[ ]: 
Hayward        354
Sanaghan       208
Thorpe       16254
Lenk           770
Chipp         1149
Cooper         433
Rossiter      1493
Burns        12721
Toscano        329
Edwards        154
Spirovska      214
Fontana       1857
dtype: int64
</pre>
</div>

<p>
As Thorpe has more votes than any other candidate, then by the voting
system of simple plurality (or
<a href="https://en.wikipedia.org/wiki/First-past-the-post_voting">First Past
The Post</a>) she would win. This system is used in the USA, and is
possibly the worst of all systems for more than two candidates.
</p>
</div>


<div id="outline-container-org0b481a6" class="outline-4">
<h4 id="checking-irv"><a id="org0b481a6"></a><span class="section-number-4">2.28.1</span> Checking IRV</h4>
<div class="outline-text-4" id="text-checking-irv">
<p>
So let's first check how IRV works, with a little program that starts
with a dictionary and first preferences of each candidate. Recall our
simplifying assumption that all voters vote according to the How to Vote
cards, which means that when a candidate is eliminated, all those votes
will go to just one other remaining candidate. In practice, of course,
those ballots would be redistributed across a number of candidates.
</p>

<p>
Here's a simple program to manage this version of IRV:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">def</span> <span style="color: #006699;">IRV</span>(votes):
    <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">performs an IRV simulation on a list of first preferences: at each stage</span>
    <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">deleting the candidate with the lowest current score, and distributing</span>
    <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">that candidates votes to the highest remaining candidate</span>
    <span style="color: #BA36A5;">vote_counts</span> = votes.copy()
    <span style="color: #0000FF;">for</span> i <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">range</span>(10):
        <span style="color: #BA36A5;">m</span> = <span style="color: #006FE0;">min</span>(vote_counts.items(), key = <span style="color: #0000FF;">lambda</span> x: x[1])
        <span style="color: #BA36A5;">ind</span> = <span style="color: #006FE0;">next</span>(j <span style="color: #0000FF;">for</span> j <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">range</span>(2,11) <span style="color: #0000FF;">if</span> cands[htv[m[0]].index(j)] <span style="color: #0000FF;">in</span> vote_counts)
        <span style="color: #BA36A5;">c</span> = cands[htv[m[0]].index(ind)]
        <span style="color: #BA36A5;">vote_counts</span> += m[1]
        <span style="color: #0000FF;">del</span>(vote_counts[m[0]])
    <span style="color: #0000FF;">return</span>(vote_counts)
</pre>
</div>

<p>
We could make this code a little more efficient by stopping when any
candidate has amassed over 50% pf the votes. But for simplicity we'll
eliminate 10 of the 12 candidates, so it will be perfectly clear who has
won. Let's try it out:
</p>

<div class="org-src-container">
<pre class="src src-python">In [ ]: IRV(firsts)
  Out[ ]: 
  Thorpe    18648
  Burns     17288
  dtype: int64
</pre>
</div>

<p>
Note that this is very close to the results listed on the VEC site:
</p>

<div class="org-src-container">
<pre class="src src-python">Thorpe:    18380
Burns:     14410
Fontana:   3298
</pre>
</div>

<p>
At this stage it doesn't matter where Fontana's votes go (in fact they
would go to Burns), as Thorpe already has a majority. But the result we
obtained above with our simplifying assumptions gives very similar
values.
</p>

<p>
Now lets see what happens if we work through each booth independently:
</p>

<div class="org-src-container">
<pre class="src src-python">In [ ]: <span style="color: #BA36A5;">finals</span> = {<span style="color: #008000;">'Thorpe'</span>:0,<span style="color: #008000;">'Burns'</span>:0}

In [ ]: <span style="color: #0000FF;">for</span> i <span style="color: #0000FF;">in</span> firstprefs.index:
   ...:     <span style="color: #BA36A5;">booth</span> = <span style="color: #006FE0;">dict</span>(firstprefs.loc[i,<span style="color: #008000;">'Hayward'</span>:<span style="color: #008000;">'Fontana'</span>])
   ...:     <span style="color: #BA36A5;">f</span> = IRV(booth)
   ...:     <span style="color: #BA36A5;">finals</span>[<span style="color: #008000;">'Thorpe'</span>] += f[<span style="color: #008000;">'Thorpe'</span>]
   ...:     <span style="color: #BA36A5;">finals</span>[<span style="color: #008000;">'Burns'</span>] += f[<span style="color: #008000;">'Burns'</span>]
   ...:     <span style="color: #0000FF;">print</span>(firstprefs.loc[i,<span style="color: #008000;">'Booth'</span>],<span style="color: #008000;">': '</span>,f)
   ...:     
Alphington :  {<span style="color: #008000;">'Thorpe'</span>: 524, <span style="color: #008000;">'Burns'</span>: 545}
Alphington North :  {<span style="color: #008000;">'Thorpe'</span>: 408, <span style="color: #008000;">'Burns'</span>: 485}
Bell :  {<span style="color: #008000;">'Thorpe'</span>: 1263, <span style="color: #008000;">'Burns'</span>: 893}
Croxton :  {<span style="color: #008000;">'Thorpe'</span>: 950, <span style="color: #008000;">'Burns'</span>: 668}
Darebin Parklands :  {<span style="color: #008000;">'Thorpe'</span>: 180, <span style="color: #008000;">'Burns'</span>: 204}
Fairfield :  {<span style="color: #008000;">'Thorpe'</span>: 925, <span style="color: #008000;">'Burns'</span>: 742}
Northcote :  {<span style="color: #008000;">'Thorpe'</span>: 1043, <span style="color: #008000;">'Burns'</span>: 875}
Northcote North :  {<span style="color: #008000;">'Thorpe'</span>: 1044, <span style="color: #008000;">'Burns'</span>: 1012}
Northcote South :  {<span style="color: #008000;">'Thorpe'</span>: 1392, <span style="color: #008000;">'Burns'</span>: 1137}
Preston South :  {<span style="color: #008000;">'Thorpe'</span>: 677, <span style="color: #008000;">'Burns'</span>: 639}
Thornbury :  {<span style="color: #008000;">'Thorpe'</span>: 1158, <span style="color: #008000;">'Burns'</span>: 864}
Thornbury East :  {<span style="color: #008000;">'Thorpe'</span>: 1052, <span style="color: #008000;">'Burns'</span>: 804}
Thornbury South :  {<span style="color: #008000;">'Thorpe'</span>: 1310, <span style="color: #008000;">'Burns'</span>: 1052}
Westgarth :  {<span style="color: #008000;">'Thorpe'</span>: 969, <span style="color: #008000;">'Burns'</span>: 536}
Postal Votes :  {<span style="color: #008000;">'Thorpe'</span>: 1509, <span style="color: #008000;">'Burns'</span>: 2262}
Early Votes :  {<span style="color: #008000;">'Thorpe'</span>: 5282, <span style="color: #008000;">'Burns'</span>: 3532}

In [ ]: finals
Out[ ]: {<span style="color: #008000;">'Burns'</span>: 16250, <span style="color: #008000;">'Thorpe'</span>: 19686}
</pre>
</div>

<p>
Note again that the results are surprisingly close to the
"<a href="https://www.vec.vic.gov.au/Results/State2017/TCPbyVotingCentreNorthcoteDistrict.html">two-party
preferred</a>" results as reported again on the VEC site. This adds weight
to the notion that our assumptions, although crude, do in fact provide a
reasonable way of experimenting with the election results.
</p>
</div>
</div>

<div id="outline-container-org8938a9a" class="outline-4">
<h4 id="borda-counts"><a id="org8938a9a"></a><span class="section-number-4">2.28.2</span> Borda counts</h4>
<div class="outline-text-4" id="text-borda-counts">
<p>
These are named for
<a href="https://en.wikipedia.org/wiki/Jean-Charles_de_Borda">Jean Charles de
Borda</a> (1733 &#x2013; 1799) an early voting theorist. The idea is to weight
all the preferences, so that a preference of 1 has a higher weighting
that a preference of 2, and so on. All the weights are added, and the
candidate with the greatest total is deemed to be the winner. With
candidates, there are different methods of determining weighting;
probably the most popular is a simple linear weighting, so that a
preference of is weighted as . This gives weightings from down to zero.
Alternatively a weighting of can be used, which gives weights of down to
</p>
<ol class="org-ol">
<li>Both are equivalent in determining a winner. Another possible</li>
</ol>
<p>
weighting is .
</p>

<p>
Here's a program to compute Borda counts, again with our simplification:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">def</span> <span style="color: #006699;">borda</span>(x): <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">x is 0 or 1</span>
    <span style="color: #BA36A5;">borda_count</span> = <span style="color: #006FE0;">dict</span>()
    <span style="color: #0000FF;">for</span> c <span style="color: #0000FF;">in</span> cands:
        <span style="color: #BA36A5;">borda_count</span>=0.0
    <span style="color: #0000FF;">for</span> c <span style="color: #0000FF;">in</span> cands:
        <span style="color: #BA36A5;">v</span> = firsts  <span style="color: #8D8D84;">#  </span><span style="color: #8D8D84; font-style: italic;">number of 1st pref votes for candidate c</span>
        <span style="color: #0000FF;">for</span> i <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">range</span>(1,13):
            <span style="color: #BA36A5;">appr</span> = cands[htv.index(i)]  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">the candidate against position i on c htv card</span>
            <span style="color: #0000FF;">if</span> x==0:
                <span style="color: #BA36A5;">borda_count</span>[appr] += v/i
            <span style="color: #0000FF;">else</span>:
                <span style="color: #BA36A5;">borda_count</span>[appr] += v*(11-i)
    <span style="color: #0000FF;">if</span> x==0:
        <span style="color: #0000FF;">for</span> k, val <span style="color: #0000FF;">in</span> borda_count.items():
            <span style="color: #BA36A5;">borda_count</span>[k] = <span style="color: #006FE0;">float</span>(<span style="color: #008000;">"{:.2f}"</span>.<span style="color: #006FE0;">format</span>(val))
    <span style="color: #0000FF;">else</span>:
        <span style="color: #0000FF;">for</span> k, val <span style="color: #0000FF;">in</span> borda_count.items():
            <span style="color: #BA36A5;">borda_count</span>[k] = <span style="color: #006FE0;">int</span>(val)
    <span style="color: #0000FF;">return</span>(borda_count)
</pre>
</div>

<p>
Now we can run this, and to make our lives easier we'll sort the
results:
</p>

<div class="org-src-container">
<pre class="src src-python">In [ ]: <span style="color: #006FE0;">sorted</span>(borda(1).items(), key = <span style="color: #0000FF;">lambda</span> x: x[1], reverse = <span style="color: #D0372D;">True</span>)
Out[ ]: 
[(<span style="color: #008000;">'Burns'</span>, 308240),
 (<span style="color: #008000;">'Thorpe'</span>, 279392),
 (<span style="color: #008000;">'Lenk'</span>, 266781),
 (<span style="color: #008000;">'Chipp'</span>, 179179),
 (<span style="color: #008000;">'Cooper'</span>, 167148),
 (<span style="color: #008000;">'Spirovska'</span>, 165424),
 (<span style="color: #008000;">'Edwards'</span>, 154750),
 (<span style="color: #008000;">'Hayward'</span>, 136144),
 (<span style="color: #008000;">'Fontana'</span>, 88988),
 (<span style="color: #008000;">'Toscano'</span>, 80360),
 (<span style="color: #008000;">'Rossiter'</span>, 75583),
 (<span style="color: #008000;">'Sanaghan'</span>, 38555)]

In [ ]: <span style="color: #006FE0;">sorted</span>(borda(0).items(), key = <span style="color: #0000FF;">lambda</span> x: x[1], reverse = <span style="color: #D0372D;">True</span>)
Out[ ]: 
[(<span style="color: #008000;">'Burns'</span>, 22409.53),
 (<span style="color: #008000;">'Thorpe'</span>, 20455.29),
 (<span style="color: #008000;">'Lenk'</span>, 11485.73),
 (<span style="color: #008000;">'Chipp'</span>, 10767.9),
 (<span style="color: #008000;">'Spirovska'</span>, 6611.22),
 (<span style="color: #008000;">'Cooper'</span>, 6592.5),
 (<span style="color: #008000;">'Edwards'</span>, 6569.93),
 (<span style="color: #008000;">'Hayward'</span>, 6186.93),
 (<span style="color: #008000;">'Fontana'</span>, 6006.25),
 (<span style="color: #008000;">'Rossiter'</span>, 5635.08),
 (<span style="color: #008000;">'Toscano'</span>, 4600.15),
 (<span style="color: #008000;">'Sanaghan'</span>, 4196.47)]
</pre>
</div>

<p>
Note that in both cases Burns has the highest output. This is in general
to be expected of Borda counts: that the highest value does not
necessarily correspond to the candidate which is seen as better overall.
For this reason Borda counts are rarely used in modern systems, although
they can be used to give a general picture of an electorate.
</p>
</div>
</div>

<div id="outline-container-org638d7a5" class="outline-4">
<h4 id="condorcet-criteria"><a id="org638d7a5"></a><span class="section-number-4">2.28.3</span> Condorcet criteria</h4>
<div class="outline-text-4" id="text-condorcet-criteria">
<p>
There are a vast number of voting systems which treat the vote as
simultaneous pairwise contests. For example in a three way contest,
between Alice, Bob, and Charlie the system considers the contest between
Alice and Bob, between Alice and Charlie, and between Bob and Charlie.
Each of these contests will produce a winner, and the outcome of all the
pairwise contests is used to determine the overall winner. If there is a
single person who is preferred, by a majority of voters, in each of
their pairwise contests, then that person is called a <i>Condorcet
winner</i>. This is named for the
<a href="https://en.wikipedia.org/wiki/Marquis_de_Condorcet">Marquis de
Condorcet</a> (1743 &#x2013; 1794) another early voting theorist. The <i>Condorcet
criterion</i> is one of many criteria considered appropriate for a voting
system; it says that if the ballots return a Condorcet winner, then that
winner should be chosen by the system. This is one of the faults of IRV:
that it does not necessarily return a Condorcet winner.
</p>

<p>
Let's look again at the How to Vote preferences, and the numbers of
voters of each:
</p>

<pre class="example">
In [ ]: htvd = pd.DataFrame(list(htv.values()),index=htv.keys(),columns=htv.keys()).transpose()
In [ ]: htvd.loc['Firsts']=list(firsts.values)
In [ ]: htvd

Out[ ]: 
	   Hayward  Sanaghan  Thorpe  Lenk  Chipp  Cooper  Rossiter  Burns  Toscano  Edwards  Spirovska  Fontana
Hayward          1         3       6     7     10       5         6     10        3        2          2        2
Sanaghan        10         1       9     8     12      12        12     12        4       10         12        3
Thorpe           7         2       1     3      4       8         9      5        2        4          3        4
Lenk             6         5       3     1      5       6        11      3        5        3          7        5
Chipp            8         6      10     5      1       2         2      2        6        8          4        6
Cooper           5         7       8    11      6       1         7      4        7        9          5        7
Rossiter        12         8      12    12      7       7         1      6        8       12          6        8
Burns           11         9       2     2      3       3         5      1        9        6          8        9
Toscano          3        10       7     9     11      11         8     11        1        5         10       10
Edwards          2        11       4     4      9       9        10      9       10        1          9       11
Spirovska        4        12       5     6      2      10         3      8       11        7          1       12
Fontana          9         4      11    10      8       4         4      7       12       11         11        1
Firsts         354       208   16254   770   1149     433      1493  12721      329      154        214     1857
</pre>

<p>
Here the how to vote information is in the columns. If we look at just
the first two candidates, we see that Hayward is preferred to Sanaghan
by all voters except for those who voted for Sanaghan. Thus a majority
(in fact, nearly all) voters preferred Hayward to Sanaghan.
</p>

<p>
For each pair of candidates, the number of voters preferring one to the
other can be computed by this program:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">def</span> <span style="color: #006699;">condorcet</span>():
    <span style="color: #BA36A5;">condorcet_table</span> = pd.DataFrame(columns=cands,index=cands).fillna(0)
    <span style="color: #0000FF;">for</span> c <span style="color: #0000FF;">in</span> cands:
        <span style="color: #BA36A5;">hc</span> = htv
        <span style="color: #0000FF;">for</span> i <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">range</span>(12):
            <span style="color: #0000FF;">for</span> j <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">range</span>(12):
                <span style="color: #0000FF;">if</span> hc[i] &amp;lt; hc[j]:
                    condorcet_table.loc[cands[i],cands[j]] += firsts
    <span style="color: #0000FF;">return</span>(condorcet_table)
</pre>
</div>

<p>
We can see the results of this program:
</p>

<div class="org-src-container">
<pre class="src src-python">In [ ]: <span style="color: #BA36A5;">ct</span> = condorcet(); ct
Out[ ]: 
           Hayward  Sanaghan  Thorpe   Lenk  Chipp  Cooper  Rossiter  Burns  Toscano  Edwards  Spirovska  Fontana
Hayward          0     35728    4505   5042  19370   21633     20573   3116    35607     4888       3335    18283
Sanaghan       208         0    2065   2394  18648    3164     19926   2748     2835     2394       2394    17715
Thorpe       31431     33871       0  21504  20140   20935     34010  19370    33760    35428      32726    32153
Lenk         30894     33542   14432      0  19926   33442     34229   3886    33760    33935      32726    31945
Chipp        16566     17288   15796  16010      0   18895     34443   6037    18845    18404      18960    33871
Cooper       14303     32772   15001   2494  17041       0     34443   3395    18075    18404      15548    31608
Rossiter     15363     16010    1926   1707   1493    1493         0   4101    18075    18404      17041    15906
Burns        32820     33188   16566  32050  29899   32541     31835      0    35099    35428      32726    32024
Toscano        329     33101    2176   2176  17091   17861     17861    837        0     3887       2902    18075
Edwards      31048     33542     508   2001  17532   17532     17532    508    32049        0      20359    18075
Spirovska    32601     33542    3210   3210  16976   20388     18895   3210    33034    15577          0    20717
Fontana      17653     18221    3783   3991   2065    4328     20030   3912    17861    17861      15219        0
</pre>
</div>

<p>
What we want to see, of course, if anybody has obtained a majority of
preferences against everybody else. To do this we can find all the
values greater than the majority, and add up their number. A value of 11
indicates a Condorcet winner:
</p>

<div class="org-src-container">
<pre class="src src-python">In [ ]: <span style="color: #BA36A5;">maj</span> = firsts.<span style="color: #006FE0;">sum</span>()//2 + 1; maj
Out[ ]: 17969

In [ ]: ((ct &amp;gt;= maj)*1).<span style="color: #006FE0;">sum</span>(axis = 1)
Out[ ]: 
Hayward       6.0
Sanaghan      2.0
Thorpe       11.0
Lenk          9.0
Chipp         6.0
Cooper        5.0
Rossiter      2.0
Burns        10.0
Toscano       2.0
Edwards       5.0
Spirovska     6.0
Fontana       2.0
dtype: float64
</pre>
</div>

<p>
So in this case we do indeed have a Condorcet winner in Thorpe, and this
election (at least with our simplifying assumptions) is also one in
which IRV returned the Condorcet winner.
</p>
</div>
</div>

<div id="outline-container-orgd3169f6" class="outline-4">
<h4 id="range-and-approval-voting"><a id="orgd3169f6"></a><span class="section-number-4">2.28.4</span> Range and approval voting</h4>
<div class="outline-text-4" id="text-range-and-approval-voting">
<p>
If you go to <a href="http://rangevoting.org">rangevoting.org</a> you'll find a
nspirited defense of a system called <i>range voting</i>. To vote in such a
system, each voter gives an "approval weight" for each candidate. For
example, the voter may mark off a value between 0 and 10 against each
candidate, indicating their level of approval. There is no requirement
for a voter to mark candidates differently: a voter might give all
candidates a value of 10, or of zero, or give one candidate 10 and all
the others zero. One simplified version of range voting is approval
voting, where the voter simply indicates as many or as few candidates as
she or he approves of. A voter may approve of just one candidate, or all
of them. As with range voting, the winner is the one with the maximum
number of approvals. A system where each voter approves of just one
candidate is the First Past the Post system, and as we have seen
previously, this is equivalent to simply counting only the first
preferences of our ballots.
</p>

<p>
We can't possibly know how voters may have approved of the candidates,
but we can run a simple simulation: given a number between 1 and 12,
suppose that each voter approves of their first preferences. Given the
preferences and numbers, we can easily tally the approvals for each
voter:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #0000FF;">def</span> <span style="color: #006699;">approvals</span>(n):
      <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">Determines the approvals result if voters took their</span>
      <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">first n preferences as approvals</span>
      <span style="color: #BA36A5;">approvals_result</span> = <span style="color: #006FE0;">dict</span>()
      <span style="color: #0000FF;">for</span> c <span style="color: #0000FF;">in</span> cands:
          <span style="color: #BA36A5;">approvals_result</span> = 0
      <span style="color: #BA36A5;">firsts</span> = firstprefs.loc[:,<span style="color: #008000;">'Hayward'</span>:<span style="color: #008000;">'Fontana'</span>].<span style="color: #006FE0;">sum</span>(axis=0)
      <span style="color: #0000FF;">for</span> c <span style="color: #0000FF;">in</span> cands:
          <span style="color: #BA36A5;">v</span> = firsts  <span style="color: #8D8D84;">#  </span><span style="color: #8D8D84; font-style: italic;">number of 1st pref votes for candidate c</span>
          <span style="color: #0000FF;">for</span> i <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">range</span>(1,n+1):
              <span style="color: #BA36A5;">appr</span> = cands[htv.index(i)]  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">the candidate against position i on c htv card</span>
              <span style="color: #BA36A5;">approvals_result</span>[appr] += v
      <span style="color: #0000FF;">return</span>(approvals_result)
</pre>
</div>

<p>
Now we can see what happens with approvals for :
</p>

<div class="org-src-container">
<pre class="src src-python">In [1 ]: <span style="color: #0000FF;">for</span> i <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">range</span>(1,7):
    ...:     <span style="color: #BA36A5;">si</span> = <span style="color: #006FE0;">sorted</span>(approvals(i).items(),key = <span style="color: #0000FF;">lambda</span> x: x[1],reverse=<span style="color: #D0372D;">True</span>)
    ...:     <span style="color: #0000FF;">print</span>([i]+[s[0] <span style="color: #0000FF;">for</span> s <span style="color: #0000FF;">in</span> si])
    ...:     
[1, <span style="color: #008000;">'Thorpe'</span>, <span style="color: #008000;">'Burns'</span>, <span style="color: #008000;">'Fontana'</span>, <span style="color: #008000;">'Rossiter'</span>, <span style="color: #008000;">'Chipp'</span>, <span style="color: #008000;">'Lenk'</span>, <span style="color: #008000;">'Cooper'</span>, <span style="color: #008000;">'Hayward'</span>, <span style="color: #008000;">'Toscano'</span>, <span style="color: #008000;">'Spirovska'</span>, <span style="color: #008000;">'Sanaghan'</span>, <span style="color: #008000;">'Edwards'</span>]
[2, <span style="color: #008000;">'Burns'</span>, <span style="color: #008000;">'Thorpe'</span>, <span style="color: #008000;">'Chipp'</span>, <span style="color: #008000;">'Hayward'</span>, <span style="color: #008000;">'Fontana'</span>, <span style="color: #008000;">'Rossiter'</span>, <span style="color: #008000;">'Spirovska'</span>, <span style="color: #008000;">'Lenk'</span>, <span style="color: #008000;">'Edwards'</span>, <span style="color: #008000;">'Cooper'</span>, <span style="color: #008000;">'Toscano'</span>, <span style="color: #008000;">'Sanaghan'</span>]
[3, <span style="color: #008000;">'Burns'</span>, <span style="color: #008000;">'Lenk'</span>, <span style="color: #008000;">'Thorpe'</span>, <span style="color: #008000;">'Chipp'</span>, <span style="color: #008000;">'Hayward'</span>, <span style="color: #008000;">'Spirovska'</span>, <span style="color: #008000;">'Sanaghan'</span>, <span style="color: #008000;">'Fontana'</span>, <span style="color: #008000;">'Rossiter'</span>, <span style="color: #008000;">'Toscano'</span>, <span style="color: #008000;">'Edwards'</span>, <span style="color: #008000;">'Cooper'</span>]
[4, <span style="color: #008000;">'Burns'</span>, <span style="color: #008000;">'Lenk'</span>, <span style="color: #008000;">'Thorpe'</span>, <span style="color: #008000;">'Edwards'</span>, <span style="color: #008000;">'Chipp'</span>, <span style="color: #008000;">'Cooper'</span>, <span style="color: #008000;">'Fontana'</span>, <span style="color: #008000;">'Spirovska'</span>, <span style="color: #008000;">'Hayward'</span>, <span style="color: #008000;">'Sanaghan'</span>, <span style="color: #008000;">'Rossiter'</span>, <span style="color: #008000;">'Toscano'</span>]
[5, <span style="color: #008000;">'Thorpe'</span>, <span style="color: #008000;">'Lenk'</span>, <span style="color: #008000;">'Burns'</span>, <span style="color: #008000;">'Spirovska'</span>, <span style="color: #008000;">'Edwards'</span>, <span style="color: #008000;">'Chipp'</span>, <span style="color: #008000;">'Cooper'</span>, <span style="color: #008000;">'Fontana'</span>, <span style="color: #008000;">'Hayward'</span>, <span style="color: #008000;">'Sanaghan'</span>, <span style="color: #008000;">'Rossiter'</span>, <span style="color: #008000;">'Toscano'</span>]
[6, <span style="color: #008000;">'Lenk'</span>, <span style="color: #008000;">'Thorpe'</span>, <span style="color: #008000;">'Burns'</span>, <span style="color: #008000;">'Hayward'</span>, <span style="color: #008000;">'Spirovska'</span>, <span style="color: #008000;">'Chipp'</span>, <span style="color: #008000;">'Edwards'</span>, <span style="color: #008000;">'Cooper'</span>, <span style="color: #008000;">'Rossiter'</span>, <span style="color: #008000;">'Fontana'</span>, <span style="color: #008000;">'Sanaghan'</span>, <span style="color: #008000;">'Toscano'</span>]
</pre>
</div>

<p>
It's remarkable, that after , the first number of approvals required for
Thorpe again to win is .
</p>
</div>
</div>

<div id="outline-container-org540ecda" class="outline-4">
<h4 id="other-election-methods"><a id="org540ecda"></a><span class="section-number-4">2.28.5</span> Other election methods</h4>
<div class="outline-text-4" id="text-other-election-methods">
<p>
There are of course many many other methods of selecting a winning
candidate from ordered ballots. And each of them has advantages and
disadvantages. Some of the disadvantages are subtle (although
important); others have glaring inadequacies, such as first past the
post for more than two candidates. One such
<a href="https://en.wikipedia.org/wiki/Comparison_of_electoral_systems">comparison
table</a> lists voting methods against standard criteria. Note that IRV &#x2013;
the Australian preferential system &#x2013; is one of the very few methods to
fail monotonicity. This is seen as one of the system's worst failings.
You can see an example of this in an
<a href="https://numbersandshapes.net/2010/07/mathematics-of-voting-3-electing-a-candidate-instant-runoff-voting/">old
blog post</a>.
</p>

<p>
Rather than write our own programs, we shall simply dump our information
into the
<a href="http://www1.cse.wustl.edu/~legrand/rbvote/calc.html">Ranked-ballot
voting calculator</a> page and see what happens. First the data needs to
be massaged into an appropriate form:
</p>

<div class="org-src-container">
<pre class="src src-python">In [ ]: <span style="color: #0000FF;">for</span> c <span style="color: #0000FF;">in</span> cands:
   ...:     <span style="color: #BA36A5;">st</span> = <span style="color: #006FE0;">str</span>(firsts)+<span style="color: #008000;">":"</span>+c
   ...:     <span style="color: #0000FF;">for</span> i <span style="color: #0000FF;">in</span> <span style="color: #006FE0;">range</span>(2,13):
   ...:         <span style="color: #BA36A5;">st</span> += <span style="color: #008000;">"&amp;gt;"</span>+cands[htv.index(i)]
   ...:     <span style="color: #0000FF;">print</span>(st)
   ...:     
354:Hayward&amp;gt;Edwards&amp;gt;Toscano&amp;gt;Spirovska&amp;gt;Cooper&amp;gt;Lenk&amp;gt;Thorpe&amp;gt;Chipp&amp;gt;Fontana&amp;gt;Sanaghan&amp;gt;Burns&amp;gt;Rossiter
208:Sanaghan&amp;gt;Thorpe&amp;gt;Hayward&amp;gt;Fontana&amp;gt;Lenk&amp;gt;Chipp&amp;gt;Cooper&amp;gt;Rossiter&amp;gt;Burns&amp;gt;Toscano&amp;gt;Edwards&amp;gt;Spirovska
16254:Thorpe&amp;gt;Burns&amp;gt;Lenk&amp;gt;Edwards&amp;gt;Spirovska&amp;gt;Hayward&amp;gt;Toscano&amp;gt;Cooper&amp;gt;Sanaghan&amp;gt;Chipp&amp;gt;Fontana&amp;gt;Rossiter
770:Lenk&amp;gt;Burns&amp;gt;Thorpe&amp;gt;Edwards&amp;gt;Chipp&amp;gt;Spirovska&amp;gt;Hayward&amp;gt;Sanaghan&amp;gt;Toscano&amp;gt;Fontana&amp;gt;Cooper&amp;gt;Rossiter
1149:Chipp&amp;gt;Spirovska&amp;gt;Burns&amp;gt;Thorpe&amp;gt;Lenk&amp;gt;Cooper&amp;gt;Rossiter&amp;gt;Fontana&amp;gt;Edwards&amp;gt;Hayward&amp;gt;Toscano&amp;gt;Sanaghan
433:Cooper&amp;gt;Chipp&amp;gt;Burns&amp;gt;Fontana&amp;gt;Hayward&amp;gt;Lenk&amp;gt;Rossiter&amp;gt;Thorpe&amp;gt;Edwards&amp;gt;Spirovska&amp;gt;Toscano&amp;gt;Sanaghan
1493:Rossiter&amp;gt;Chipp&amp;gt;Spirovska&amp;gt;Fontana&amp;gt;Burns&amp;gt;Hayward&amp;gt;Cooper&amp;gt;Toscano&amp;gt;Thorpe&amp;gt;Edwards&amp;gt;Lenk&amp;gt;Sanaghan
12721:Burns&amp;gt;Chipp&amp;gt;Lenk&amp;gt;Cooper&amp;gt;Thorpe&amp;gt;Rossiter&amp;gt;Fontana&amp;gt;Spirovska&amp;gt;Edwards&amp;gt;Hayward&amp;gt;Toscano&amp;gt;Sanaghan
329:Toscano&amp;gt;Thorpe&amp;gt;Hayward&amp;gt;Sanaghan&amp;gt;Lenk&amp;gt;Chipp&amp;gt;Cooper&amp;gt;Rossiter&amp;gt;Burns&amp;gt;Edwards&amp;gt;Spirovska&amp;gt;Fontana
154:Edwards&amp;gt;Hayward&amp;gt;Lenk&amp;gt;Thorpe&amp;gt;Toscano&amp;gt;Burns&amp;gt;Spirovska&amp;gt;Chipp&amp;gt;Cooper&amp;gt;Sanaghan&amp;gt;Fontana&amp;gt;Rossiter
214:Spirovska&amp;gt;Hayward&amp;gt;Thorpe&amp;gt;Chipp&amp;gt;Cooper&amp;gt;Rossiter&amp;gt;Lenk&amp;gt;Burns&amp;gt;Edwards&amp;gt;Toscano&amp;gt;Fontana&amp;gt;Sanaghan
1857:Fontana&amp;gt;Hayward&amp;gt;Sanaghan&amp;gt;Thorpe&amp;gt;Lenk&amp;gt;Chipp&amp;gt;Cooper&amp;gt;Rossiter&amp;gt;Burns&amp;gt;Toscano&amp;gt;Edwards&amp;gt;Spirovska
&lt;/pre&gt;
</pre>
</div>

<p>
The above can be copied and pasted into the given text box. Then the
page returns:
</p>

<style>
.basic-styling td,
.basic-styling th {
  border: 0px solid #999;
  padding: 0.25rem;
}
</style>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides" class="basic-styling">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">winner</th>
<th scope="col" class="org-left">method(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Thorpe</td>
<td class="org-left">Baldwin</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Black</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Carey</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Coombs</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Copeland</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Dodgson</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Hare</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Nanson</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Raynaud</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Schulze</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Simpson</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Small</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Tideman</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">Burns</td>
<td class="org-left">Borda</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Bucklin</td>
</tr>
</tbody>
</table>

<p>
You can see that Thorpe would be the winner under almost every other
voting system. This indicates that Thorpe being returned by IRV seems
not just an artifact of the system, but represents the genuine wishes of
the electorate.
</p>
</div>
</div>
</div>

<div id="outline-container-org73fcbe6" class="outline-3">
<h3 id="org73fcbe6"><span class="section-number-3">2.29</span> Programmable CAD</h3>
<div class="outline-text-3" id="text-2-29">
<p>
Every few years I decide to have a go at using a CAD package for the
creation of 3D diagrams and shapes, and every time I give it up. There's
simply too much to learn in terms of creating shapes, moving them about,
and so on, and every system seems to have its own ways of doing things.
My son (who is an expert in <a href="https://www.blender.org">Blender</a>)
recommended that I experiment with
<a href="https://www.tinkercad.com">Tinkercad</a>, and indeed this is probably a
pretty easy way of getting started with 3D CAD. But it didn't suit me: I
wanted to place things precisely in relation to each other, and fiddling
with dragging and dropping with the mouse was harder and more
inconvenient than it should have been. No doubt there are ways of
getting exact line ups, but it isn't obvious to the raw beginner.
</p>

<p>
I then discovered that there are lots of different CAD "programming
languages"; or more properly scripting languages, where the user
describes how the figure is to be built in the system's language. Then
the system builds it from the script. In this sense these systems are
descendants of the venerable
<a href="https://en.wikipedia.org/wiki/VRML">VRML</a>, of which you can see some
<a href="http://cs.lmu.edu/~ray/notes/vrmlexamples/">examples here</a>, and its
modern version <a href="https://en.wikipedia.org/wiki/X3D">X3D</a>.
</p>

<p>
Some of the systems that I looked at were:
</p>

<ul class="org-ul">
<li><a href="http://www.openscad.org">OpenSCAD</a>, which uses its own scripting
language</li>
<li><a href="https://openjscad.org">OpenJSCAD</a>, based on JavaScript</li>
<li><a href="https://github.com/colah/ImplicitCAD">implicitCAD</a>, based on
Haskell,</li>
</ul>

<p>
No doubt there are others. All of these systems have primitive shapes
(spheres, cubes, cylinders etc), operations on shapes (shifting,
stretching, rotating, extruding etc) so a vast array of different forms
can be generated. Some systems allow for a great deal of flexibility, so
that a cylinder with a radius of zero at one end will be a cone, or of
different radii at each end a frustum.
</p>

<p>
I ended up choosing OpenJSCAD, which is being actively developed, is
based on a well known and robust language, and is also great fun to use.
Here is a simple example, to construct a tetrahedron whose vertices are
chosen from the vertices of a cube with vertices . The vertices whose
product is 1 will be the vertices of a tetrahedron. We can make a nice
tetrahedral shape by putting a small sphere at each vertex, and joining
each sphere by a cylinder of the same radius:
</p>

<div class="CSG" style="width:750px; height:500px;">
<script type="text/javascript">
  var rad = 0.1; // radius of sphere at vertex and cylinders

  var v0 = [1,1,1];
  var v1 = [1,-1,-1];
  var v2 = [-1,1,-1];
  var v3 = [-1,-1,1];
  var vertices = [v0,v1,v2,v3];

  // adjacency lists:
  var adj = [[1,2,3],[0,2,3],[0,1,3],[0,1,2]];

  function main() {
    var t = [];   
    for(var i = 0; i &lt; 4; i++) {    // loop through the list of vertices
      var here = vertices[i];
      t.push(translate(here,sphere({r:rad})));
      for(var j = 0; j &lt; 3; j++) {  // for each vertex join it to the others in its adjacency list
        var there = vertices[adj[i][j]];
        t.push(cylinder({start:here,end:there,r:rad}));
      }
    }
    return union(t);
  }
  </script>
</div>

<p>
The code should be fairly self-explanatory. And here is the tetrahedron:
</p>

<p>
I won't put these models in this post, as one of them is slow to render:
but look at a
<a href="https://numbersandshapes.net/openjscad/tetrahedron.html">coloured
tetrahedron</a>, and an
<a href="https://numbersandshapes.net/openjscad/icosahedron.html">icosahedron</a>.
</p>

<p>
Note that CAD design of this sort is not so much for animated media so
much as precise designs for 3D printing. But I like it for exploring 3D
geometry.
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Alasdair McAndrew</p>
<p class="date">Created: 2019-12-20 Fri 11:22</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
