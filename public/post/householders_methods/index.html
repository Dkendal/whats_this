<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.46" />

  <title>Householder&#39;s methods &middot; What&#39;s all this, then?</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway|Open+Sans+Condensed:bold" rel="stylesheet" type="text/css">

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  
  <script type="text/javascript" charset="UTF-8"
  src="https://cdnjs.cloudflare.com/ajax/libs/jsxgraph/1.3.5/jsxgraphcore.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/jsxgraph/1.3.5/jsxgraph.css"> 

 
  

  

  <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="/">All the good stuff</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/tags/"><i class='fa fa-list fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://www.github.com/amca01"><i class='fa fa-github fa-fw'></i>Github</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/nshapes/"><i class='fa fa-wordpress fa-fw'></i>Numbers and Shapes</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/pages/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/amca01" target="_blank"><i class="fa fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://facebook.com/alasdair.mcandrew" target="_blank"><i class="fa fa-facebook-square fa-fw"></i>Facebook</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://reddit.com/user/amca01" target="_blank"><i class="fa fa-reddit-square fa-fw"></i>Reddit</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small></small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Householder&#39;s methods</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>09 Sep 2018, 00:00</time>
  </div>

  

  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="tags/mathematics">mathematics</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="tags/algebra">algebra</a>
    
  </div>
  
  

</div>

  

<p>These are a class of root-finding methods; that is, for the numerical solution
of a single nonlinear equation,
developed by <a href="https://en.wikipedia.org/wiki/Alston_Scott_Householder">Alston Scott
Householder</a>
in 1970. They may be considered a generalisation of the well known <a href="https://en.wikipedia.org/wiki/Newton's_method">Newton-Raphson
method</a> (also known more simply
as <em>Newton&rsquo;s method</em>) defined by</p>

<p>\[
x\leftarrow x-\frac{f(x)}{f&rsquo;(x)}.
\]</p>

<p>where the equation to be solved is \(f(x)=0\).</p>

<p>From a starting value \(x_0\) a sequence of iterates can be generated by</p>

<p>\[
x_{n+1}=x_n-\frac{f(x_n)}{f&rsquo;(x_n)}.
\]</p>

<p>As is well known, Newton&rsquo;s method exhibits <em>quadratic convergence</em>; that is, if
the sequence of iterates converges to a root value \(r\), then the
limit</p>

<p>\[
\lim_{n\to\infty}\frac{x_{n+1}-r}{(x_n-r)^2}
\]</p>

<p>is finite.  This means, in effect, that the number of correct decimal places
doubles at each step.  Householder&rsquo;s method for a rate of convergence \(d+1\) is
defined by</p>

<p>\[
x\leftarrow x-d\frac{(1/f)^{(d-1)}(x)}{(1/f)^{(d)}(x)}.
\]</p>

<p>We show how this definition can be rewritten in terms of ratios of derivatives,
by using Python and its symbolic toolbox <a href="https://www.sympy.org/en/index.html">SymPy</a>.</p>

<p>We start by defining some variables and functions.</p>
<div class="highlight"><pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#8b008b;font-weight:bold">from</span> <span style="color:#008b45">sympy</span> <span style="color:#8b008b;font-weight:bold">import</span> *
x = Symbol(<span style="color:#cd5555">&#39;x&#39;</span>)
f = Function(<span style="color:#cd5555">&#39;f&#39;</span>)(x)</code></pre></div>
<p>Now we can define the first Householder formula, with \(d=1\):</p>
<div class="highlight"><pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">d = <span style="color:#b452cd">1</span>
H1 = x + d*diff(<span style="color:#b452cd">1</span>/f,x,d-<span style="color:#b452cd">1</span>)/diff(<span style="color:#b452cd">1</span>/f,x,d)
H1</code></pre></div>
<p>\[
x-\frac{f(x)}{\frac{d}{dx}f(x)}
\]</p>

<p>which is Newton&rsquo;s formula.  Now for \(d=2\):</p>
<div class="highlight"><pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">d = <span style="color:#b452cd">2</span>
H2 = x + d*diff(<span style="color:#b452cd">1</span>/f,x,d-<span style="color:#b452cd">1</span>)/diff(<span style="color:#b452cd">1</span>/f,x,d)
H2</code></pre></div>
<p>\[
x - \frac{2 \frac{d}{d x} f{\left (x \right )}}{- \frac{d^{2}}{d x^{2}}  f{\left (x \right )} + \frac{2 \left(\frac{d}{d x} f{\left (x \right )}\right)^{2}}{f{\left (x \right )}}}
\]</p>

<p>This is a mighty messy formula, but it can be greatly simplified by using ratios
of derivatives defined by</p>

<p>\[
r_k=\frac{f^{(d-1}(x)}{f^{(d)}(x)}
\]
This means that
\[
r_1=\frac{f}{f&rsquo;},\quad r_2=\frac{f&rsquo;}{f^{\prime\prime}}
\]
To make the subsitution into the current expression above, we can use the
substitutions
\[
f^{\prime\prime}=f&rsquo;/r_2,\quad f&rsquo;=f/r_1
\]
to be done sequentially (first defining the new symbols)</p>
<div class="highlight"><pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">r_1,r_2,r_3 = symbols(<span style="color:#cd5555">&#39;r_1,r_2,r_3&#39;</span>)
H2r = H2s.subs([(Derivative(f,x,<span style="color:#b452cd">2</span>), Derivative(f,x)/r_2), (Derivative(f,x), f/r_1)]).simplify()
H2r</code></pre></div>
<p>\[
-\frac{2r_1r_1}{r_1-2r_2}
\]
Dividing the top and bottom by \(2r_2\) produces the formulation
\[
\frac{r_1}{1-\displaystyle{\frac{r_1}{2r_2}}}
\]
and so Householder&rsquo;s method for \(d=2\) is defined by the recurrence
\[
x\leftarrow x-\frac{r_1}{1-\displaystyle{\frac{r_1}{2r_2}}}.
\]
This is known as <a href="https://en.wikipedia.org/wiki/Halley's_method">Halley&rsquo;s
method</a>, after <a href="https://en.wikipedia.org/wiki/Edmond_Halley">Edmond
Halley</a>, also known for his comet.
This method has been called the most often rediscovered iteration formula in the
literature.</p>

<p>It would exhibit <em>cubic convergence</em>, which means that the number of correct
figures roughly triples at each step.</p>

<p>Apply the same sequence of steps for \(d=3\), and including the subsitution
\[
f^{\prime\prime\prime} = f^{\prime\prime}/r_3
\]
produces the fourth order formula
\[
x\leftarrow x-\frac{3 r_{1} r_{3} \left(2r_{2} - r_{1}\right)}{r_{1}^{2} - 6 r_{1} r_{3} + 6 r_{2} r_{3}}
\]</p>

<h2 id="a-test">A test</h2>

<p>We&rsquo;ll use the equation
\[
x^5+x-1=0
\]
which has a root close to \(0.7\).  First Newton&rsquo;s method, which is the
Householder method of order \(d=1\), and we start by defining the symbol \(x\) and
the function \(f\):</p>
<div class="highlight"><pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">x = Symbol(<span style="color:#cd5555">&#39;x&#39;</span>)
f = x**<span style="color:#b452cd">5</span>+x-<span style="color:#b452cd">1</span></code></pre></div>
<p>Next define the iteration of Newton&rsquo;s method, which can be turned into a function with the handy tool
<code>lambdify</code>:</p>
<div class="highlight"><pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">nr = lambdify(x, x - f/diff(f,x))</code></pre></div>
<p>Now, a few iterations, and print them as strings:</p>
<div class="highlight"><pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">y = <span style="color:#b452cd">0.7</span>
ys = [y]
<span style="color:#8b008b;font-weight:bold">for</span> i <span style="color:#8b008b">in</span> <span style="color:#658b00">range</span>(<span style="color:#b452cd">10</span>):
    y = N(nr(y),<span style="color:#b452cd">100</span>)
    ys += [y]

<span style="color:#8b008b;font-weight:bold">for</span> i <span style="color:#8b008b">in</span> ys:
    <span style="color:#8b008b;font-weight:bold">print</span>(<span style="color:#658b00">str</span>(i))

<span style="color:#b452cd">0.7</span>
<span style="color:#b452cd">0.7599545557827765973613054484303575009107589721679687500000000000000000000000000000000000000000000000</span>
<span style="color:#b452cd">0.7549197891599746887794253559985793967456078439525201893202319456623650882121929457935763902468565963</span>
<span style="color:#b452cd">0.7548776691557956141971506438033504033307707534709697222674827264390889507161368160254597915269779252</span>
<span style="color:#b452cd">0.7548776662466927739251146002523856449587324643131536407777773148939177229546284200355119465808326870</span>
<span style="color:#b452cd">0.7548776662466927600495088963585290075677963335246916447723036615900830138144428153523526591809355834</span>
<span style="color:#b452cd">0.7548776662466927600495088963585286918946066177727931439892839706462440390043279509776806970677946058</span>
<span style="color:#b452cd">0.7548776662466927600495088963585286918946066177727931439892839706460806551280810907382270928422503037</span>
<span style="color:#b452cd">0.7548776662466927600495088963585286918946066177727931439892839706460806551280810907382270928422503037</span>
<span style="color:#b452cd">0.7548776662466927600495088963585286918946066177727931439892839706460806551280810907382270928422503037</span>
<span style="color:#b452cd">0.7548776662466927600495088963585286918946066177727931439892839706460806551280810907382270928422503037</span></code></pre></div>
<p>We can easily compute the number of correct decimal places each time by simply
finding the first place in each string where it differs from the previous one:</p>
<div class="highlight"><pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#8b008b;font-weight:bold">for</span> i <span style="color:#8b008b">in</span> <span style="color:#658b00">range</span>(<span style="color:#b452cd">1</span>,<span style="color:#b452cd">7</span>):
    d = [ys[i][j] == ys[i+<span style="color:#b452cd">1</span>][j] <span style="color:#8b008b;font-weight:bold">for</span> j <span style="color:#8b008b">in</span> <span style="color:#658b00">range</span>(<span style="color:#b452cd">102</span>)]
    <span style="color:#8b008b;font-weight:bold">print</span>(d.index(False)-<span style="color:#b452cd">2</span>)</code></pre></div>
<p>\begin{array}{l}
2\cr
3\cr
8\cr
16\cr
32\cr
66
\end{array}</p>

<p>and we see a remarkable closeness with doubling of the number of correct values
each iteration.</p>

<p>Now, the fourth order method, with \(d=3\):</p>
<div class="highlight"><pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">r1 = lambdify(x,g(x)/diff(g(x),x))
r2 = lambdify(x,diff(g(x),x)/diff(g(x),x,<span style="color:#b452cd">2</span>))
r3 = lambdify(x,diff(g(x),x,<span style="color:#b452cd">2</span>)/diff(g(x),x,<span style="color:#b452cd">3</span>))
h3 = lambdify(x,x-<span style="color:#b452cd">3</span>*r1(x)*r3(x)*(<span style="color:#b452cd">2</span>*r2(x)-r1(x))/(r1(x)**<span style="color:#b452cd">2</span>-<span style="color:#b452cd">6</span>*r1(x)*r3(x)+<span style="color:#b452cd">6</span>*r2(x)*r3(x)))</code></pre></div>
<p>Now we basically copy down the above commands, except that we&rsquo;ll use 1500 decimal
places instead of 100:</p>
<div class="highlight"><pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">y = <span style="color:#b452cd">0.7</span>
ys = [<span style="color:#658b00">str</span>(x)]
<span style="color:#8b008b;font-weight:bold">for</span> i <span style="color:#8b008b">in</span> <span style="color:#658b00">range</span>(<span style="color:#b452cd">10</span>):
    y = N(h3(x),<span style="color:#b452cd">1500</span>)
    ys += [<span style="color:#658b00">str</span>(y)]

<span style="color:#8b008b;font-weight:bold">for</span> i <span style="color:#8b008b">in</span> <span style="color:#658b00">range</span>(<span style="color:#b452cd">1</span>,<span style="color:#b452cd">6</span>):
    d = [xs[i][j] == xs[i+<span style="color:#b452cd">1</span>][j] <span style="color:#8b008b;font-weight:bold">for</span> j <span style="color:#8b008b">in</span> <span style="color:#658b00">range</span>(<span style="color:#b452cd">1502</span>)]
    <span style="color:#8b008b;font-weight:bold">print</span>(d.index(False)-<span style="color:#b452cd">2</span>)</code></pre></div>
<p>\begin{array}{l}
4\\<br />
19\\<br />
76\\<br />
308\\<br />
1233
\end{array}</p>

<p>and we that the number of correct decimal places at each step is indeed
increased by a factor very close to 4.</p>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="/post/double-damask/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="/post/double-damask/">Double Damask</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
  </div>
</div>



  

</div>

</div>
</div>
<script src="js/ui.js"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'YUA-117935107-1', 'auto');
  ga('send', 'pageview');

</script>





</body>
</html>

